import './in-native-renderer.css';var e=Object.defineProperty,t=(t,o,r)=>((t,o,r)=>o in t?e(t,o,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[o]=r)(t,"symbol"!=typeof o?o+"":o,r);class o extends Error{constructor(){super(...arguments),t(this,"name","InvalidTargetElementException"),t(this,"message","Invalid target element.")}}class r{constructor(e){t(this,"logger"),this.logger=e}invalidBid(){this.logger.warn("Invalid bid.")}unsupportedNativeAsset(){this.logger.warn("This native asset is not supported.")}missingAdTemplate(){this.logger.warn("Ad template is missing.")}invalidNativeVideoContainer(){this.logger.warn("Native video container is invalid.")}invalidTargetElement(){this.logger.warn("Invalid target element.")}}let n=class{warn(){for(var e=arguments.length,t=new Array(e),o=0;o<e;o++)t[o]=arguments[o];console.warn("[InRenderer.js]",t)}};const i={title:"text",data:"value",img:"url",video:"vasttag"};class a{replace(e,t){let o=e;return t.forEach(e=>{o=this.replaceAssetMacros(o,e)}),o}replaceAssetMacros(e,t){const o=new RegExp(`##hb_native_asset_id_${t.id}##`,"g");let r=e;const n=Object.keys(i).find(e=>t[e]);if(n){const e=i[n];r="video"in t?r.replace(o,encodeURIComponent(t.video.vasttag)):r.replace(o,t[n][e])}return r}}var s=(e=>(e[e.IMPRESSION=1]="IMPRESSION",e[e.VIEWABLE_MRC50=2]="VIEWABLE_MRC50",e[e.VIEWABLE_MRC100=3]="VIEWABLE_MRC100",e[e.VIEWABLE_VIDEO50=4]="VIEWABLE_VIDEO50",e))(s||{}),l=(e=>(e[e.IMG=1]="IMG",e[e.JS=2]="JS",e))(l||{});class d{constructor(e){t(this,"viewableTracker"),this.viewableTracker=e}track(e,t){t.forEach(t=>{this.trackEventTracker(e,t)})}trackEventTracker(e,t){if(t.url){const o=t.url;t.event===s.IMPRESSION?e.appendChild(this.generateTrackElement(o,t.method)):t.event===s.VIEWABLE_MRC50?this.viewableTracker.trackViewableMrc50(e,()=>{e.appendChild(this.generateTrackElement(o,t.method))}):t.event===s.VIEWABLE_MRC100?this.viewableTracker.trackViewableMrc100(e,()=>{e.appendChild(this.generateTrackElement(o,t.method))}):t.event===s.VIEWABLE_VIDEO50&&this.viewableTracker.trackViewableVideo50(e,()=>{e.appendChild(this.generateTrackElement(o,t.method))})}}generateTrackElement(e,t){return t===l.JS?this.generateTrackScript(e):this.generateTrackImage(e)}generateTrackScript(e){const t=document.createElement("script");return t.src=e,t.async=!0,t}generateTrackImage(e){const t=new Image(1,1);return t.src=e,t.style.display="none",t}}class c{handle(e,t,o){e.querySelectorAll(".pb-click").forEach(e=>{const r=e.getAttribute("hb_native_asset_id"),n=o.find(e=>e.id.toString()===r);e.addEventListener("click",()=>{null!=n&&n.link?this.emitClickTrackers(n.link):this.emitClickTrackers(t)})})}emitClickTrackers(e){e.clicktrackers.forEach(e=>{navigator.sendBeacon(e)})}}class u{replace(e,t,o){let r=e;return r=this.replaceLinkMacros(r,t),r=this.replacePrivacyMacros(r,o),r}replaceLinkMacros(e,t){return e.replace(/##hb_native_linkurl##/g,t.url)}replacePrivacyMacros(e,t){return e.replace(/##hb_native_privacy##/g,t||"")}}class p extends Error{constructor(){super(...arguments),t(this,"name","InvalidBidException"),t(this,"message","Invalid bid object.")}}class f extends Error{constructor(){super(...arguments),t(this,"name","UnsupportedNativeAssetException"),t(this,"message","This native asset is not supported.'")}}class m{constructor(){t(this,"name","MissingAdTemplateException"),t(this,"message","Ad template is missing.")}}class g extends Error{constructor(){super(...arguments),t(this,"name","InvalidNativeVideoContainer"),t(this,"message","Native video container is invalid.")}}class h{constructor(e){t(this,"viewableTracker"),this.viewableTracker=e}render(e,t,o,r){this.renderContainer(e,t,r),this.viewableTracker.trackViewable(e,()=>{o.play()}),this.viewableTracker.trackViewableLost(e,()=>{o.pause()}),document.addEventListener("visibilitychange",()=>{document.hidden?o.pause():o.play()})}renderContainer(e,t,o){const r=t.playerHeight/t.playerWidth;e.style.display="block",e.style.maxWidth=`${t.playerWidth}px`,e.style.width="100%",o&&e.classList.add("full-click-area");const n=e.offsetWidth*r;e.style.height=n+"px",window.addEventListener("resize",()=>{const t=e.offsetWidth*r;e.style.height=t+"px"})}}const y=e=>"string"==typeof e,v=()=>{let e,t;const o=new Promise((o,r)=>{e=o,t=r});return o.resolve=e,o.reject=t,o},b=e=>null==e?"":""+e,w=/###/g,_=e=>e&&e.indexOf("###")>-1?e.replace(w,"."):e,R=e=>!e||y(e),k=(e,t,o)=>{const r=y(t)?t.split("."):t;let n=0;for(;n<r.length-1;){if(R(e))return{};const t=_(r[n]);!e[t]&&o&&(e[t]=new o),e=Object.prototype.hasOwnProperty.call(e,t)?e[t]:{},++n}return R(e)?{}:{obj:e,k:_(r[n])}},S=(e,t,o)=>{const{obj:r,k:n}=k(e,t,Object);if(void 0!==r||1===t.length)return void(r[n]=o);let i=t[t.length-1],a=t.slice(0,t.length-1),s=k(e,a,Object);for(;void 0===s.obj&&a.length;)i=`${a[a.length-1]}.${i}`,a=a.slice(0,a.length-1),s=k(e,a,Object),null!=s&&s.obj&&typeof s.obj[`${s.k}.${i}`]<"u"&&(s.obj=void 0);s.obj[`${s.k}.${i}`]=o},C=(e,t)=>{const{obj:o,k:r}=k(e,t);if(o&&Object.prototype.hasOwnProperty.call(o,r))return o[r]},L=(e,t,o)=>{for(const r in t)"__proto__"!==r&&"constructor"!==r&&(r in e?y(e[r])||e[r]instanceof String||y(t[r])||t[r]instanceof String?o&&(e[r]=t[r]):L(e[r],t[r],o):e[r]=t[r]);return e},T=e=>e.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&");var E={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;"};const O=e=>y(e)?e.replace(/[&<>"'\/]/g,e=>E[e]):e;const A=[" ",",","?","!",";"],P=new class{constructor(e){this.capacity=e,this.regExpMap=new Map,this.regExpQueue=[]}getRegExp(e){const t=this.regExpMap.get(e);if(void 0!==t)return t;const o=new RegExp(e);return this.regExpQueue.length===this.capacity&&this.regExpMap.delete(this.regExpQueue.shift()),this.regExpMap.set(e,o),this.regExpQueue.push(e),o}}(20),V=function(e,t){let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:".";if(!e)return;if(e[t])return Object.prototype.hasOwnProperty.call(e,t)?e[t]:void 0;const r=t.split(o);let n=e;for(let e=0;e<r.length;){if(!n||"object"!=typeof n)return;let t,i="";for(let a=e;a<r.length;++a)if(a!==e&&(i+=o),i+=r[a],t=n[i],void 0!==t){if(["string","number","boolean"].indexOf(typeof t)>-1&&a<r.length-1)continue;e+=a-e+1;break}n=t}return n},N=e=>null==e?void 0:e.replace("_","-"),x={type:"logger",log(e){this.output("log",e)},warn(e){this.output("warn",e)},error(e){this.output("error",e)},output(e,t){var o,r;null==(r=null==(o=null==console?void 0:console[e])?void 0:o.apply)||r.call(o,console,t)}};class I{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.init(e,t)}init(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.prefix=t.prefix||"i18next:",this.logger=e||x,this.options=t,this.debug=t.debug}log(){for(var e=arguments.length,t=new Array(e),o=0;o<e;o++)t[o]=arguments[o];return this.forward(t,"log","",!0)}warn(){for(var e=arguments.length,t=new Array(e),o=0;o<e;o++)t[o]=arguments[o];return this.forward(t,"warn","",!0)}error(){for(var e=arguments.length,t=new Array(e),o=0;o<e;o++)t[o]=arguments[o];return this.forward(t,"error","")}deprecate(){for(var e=arguments.length,t=new Array(e),o=0;o<e;o++)t[o]=arguments[o];return this.forward(t,"warn","WARNING DEPRECATED: ",!0)}forward(e,t,o,r){return r&&!this.debug?null:(y(e[0])&&(e[0]=`${o}${this.prefix} ${e[0]}`),this.logger[t](e))}create(e){return new I(this.logger,{prefix:`${this.prefix}:${e}:`,...this.options})}clone(e){return(e=e||this.options).prefix=e.prefix||this.prefix,new I(this.logger,e)}}var M=new I;class B{constructor(){this.observers={}}on(e,t){return e.split(" ").forEach(e=>{this.observers[e]||(this.observers[e]=new Map);const o=this.observers[e].get(t)||0;this.observers[e].set(t,o+1)}),this}off(e,t){if(this.observers[e]){if(!t)return void delete this.observers[e];this.observers[e].delete(t)}}emit(e){for(var t=arguments.length,o=new Array(t>1?t-1:0),r=1;r<t;r++)o[r-1]=arguments[r];this.observers[e]&&Array.from(this.observers[e].entries()).forEach(e=>{let[t,r]=e;for(let e=0;e<r;e++)t(...o)}),this.observers["*"]&&Array.from(this.observers["*"].entries()).forEach(t=>{let[r,n]=t;for(let t=0;t<n;t++)r.apply(r,[e,...o])})}}class D extends B{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{ns:["translation"],defaultNS:"translation"};super(),this.data=e||{},this.options=t,void 0===this.options.keySeparator&&(this.options.keySeparator="."),void 0===this.options.ignoreJSONStructure&&(this.options.ignoreJSONStructure=!0)}addNamespaces(e){this.options.ns.indexOf(e)<0&&this.options.ns.push(e)}removeNamespaces(e){const t=this.options.ns.indexOf(e);t>-1&&this.options.ns.splice(t,1)}getResource(e,t,o){var r,n;let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};const a=void 0!==i.keySeparator?i.keySeparator:this.options.keySeparator,s=void 0!==i.ignoreJSONStructure?i.ignoreJSONStructure:this.options.ignoreJSONStructure;let l;e.indexOf(".")>-1?l=e.split("."):(l=[e,t],o&&(Array.isArray(o)?l.push(...o):y(o)&&a?l.push(...o.split(a)):l.push(o)));const d=C(this.data,l);return!d&&!t&&!o&&e.indexOf(".")>-1&&(e=l[0],t=l[1],o=l.slice(2).join(".")),!d&&s&&y(o)?V(null==(n=null==(r=this.data)?void 0:r[e])?void 0:n[t],o,a):d}addResource(e,t,o,r){let n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{silent:!1};const i=void 0!==n.keySeparator?n.keySeparator:this.options.keySeparator;let a=[e,t];o&&(a=a.concat(i?o.split(i):o)),e.indexOf(".")>-1&&(a=e.split("."),r=t,t=a[1]),this.addNamespaces(t),S(this.data,a,r),n.silent||this.emit("added",e,t,o,r)}addResources(e,t,o){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{silent:!1};for(const r in o)(y(o[r])||Array.isArray(o[r]))&&this.addResource(e,t,r,o[r],{silent:!0});r.silent||this.emit("added",e,t,o)}addResourceBundle(e,t,o,r,n){let i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{silent:!1,skipCopy:!1},a=[e,t];e.indexOf(".")>-1&&(a=e.split("."),r=o,o=t,t=a[1]),this.addNamespaces(t);let s=C(this.data,a)||{};i.skipCopy||(o=JSON.parse(JSON.stringify(o))),r?L(s,o,n):s={...s,...o},S(this.data,a,s),i.silent||this.emit("added",e,t,o)}removeResourceBundle(e,t){this.hasResourceBundle(e,t)&&delete this.data[e][t],this.removeNamespaces(t),this.emit("removed",e,t)}hasResourceBundle(e,t){return void 0!==this.getResource(e,t)}getResourceBundle(e,t){return t||(t=this.options.defaultNS),this.getResource(e,t)}getDataByLanguage(e){return this.data[e]}hasLanguageSomeTranslations(e){const t=this.getDataByLanguage(e);return!!(t&&Object.keys(t)||[]).find(e=>t[e]&&Object.keys(t[e]).length>0)}toJSON(){return this.data}}var F={processors:{},addPostProcessor(e){this.processors[e.name]=e},handle(e,t,o,r,n){return e.forEach(e=>{var i;t=(null==(i=this.processors[e])?void 0:i.process(t,o,r,n))??t}),t}};const U={},q=e=>!y(e)&&"boolean"!=typeof e&&"number"!=typeof e;class j extends B{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};super(),((e,t,o)=>{e.forEach(e=>{t[e]&&(o[e]=t[e])})})(["resourceStore","languageUtils","pluralResolver","interpolator","backendConnector","i18nFormat","utils"],e,this),this.options=t,void 0===this.options.keySeparator&&(this.options.keySeparator="."),this.logger=M.create("translator")}changeLanguage(e){e&&(this.language=e)}exists(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{interpolation:{}};if(null==e)return!1;const o=this.resolve(e,t);return void 0!==(null==o?void 0:o.res)}extractFromKey(e,t){let o=void 0!==t.nsSeparator?t.nsSeparator:this.options.nsSeparator;void 0===o&&(o=":");const r=void 0!==t.keySeparator?t.keySeparator:this.options.keySeparator;let n=t.ns||this.options.defaultNS||[];const i=o&&e.indexOf(o)>-1,a=!(this.options.userDefinedKeySeparator||t.keySeparator||this.options.userDefinedNsSeparator||t.nsSeparator||((e,t,o)=>{t=t||"",o=o||"";const r=A.filter(e=>t.indexOf(e)<0&&o.indexOf(e)<0);if(0===r.length)return!0;const n=P.getRegExp(`(${r.map(e=>"?"===e?"\\?":e).join("|")})`);let i=!n.test(e);if(!i){const t=e.indexOf(o);t>0&&!n.test(e.substring(0,t))&&(i=!0)}return i})(e,o,r));if(i&&!a){const t=e.match(this.interpolator.nestingRegexp);if(t&&t.length>0)return{key:e,namespaces:y(n)?[n]:n};const i=e.split(o);(o!==r||o===r&&this.options.ns.indexOf(i[0])>-1)&&(n=i.shift()),e=i.join(r)}return{key:e,namespaces:y(n)?[n]:n}}translate(e,t,o){if("object"!=typeof t&&this.options.overloadTranslationOptionHandler&&(t=this.options.overloadTranslationOptionHandler(arguments)),"object"==typeof t&&(t={...t}),t||(t={}),null==e)return"";Array.isArray(e)||(e=[String(e)]);const r=void 0!==t.returnDetails?t.returnDetails:this.options.returnDetails,n=void 0!==t.keySeparator?t.keySeparator:this.options.keySeparator,{key:i,namespaces:a}=this.extractFromKey(e[e.length-1],t),s=a[a.length-1],l=t.lng||this.language,d=t.appendNamespaceToCIMode||this.options.appendNamespaceToCIMode;if("cimode"===(null==l?void 0:l.toLowerCase())){if(d){const e=t.nsSeparator||this.options.nsSeparator;return r?{res:`${s}${e}${i}`,usedKey:i,exactUsedKey:i,usedLng:l,usedNS:s,usedParams:this.getUsedParamsDetails(t)}:`${s}${e}${i}`}return r?{res:i,usedKey:i,exactUsedKey:i,usedLng:l,usedNS:s,usedParams:this.getUsedParamsDetails(t)}:i}const c=this.resolve(e,t);let u=null==c?void 0:c.res;const p=(null==c?void 0:c.usedKey)||i,f=(null==c?void 0:c.exactUsedKey)||i,m=void 0!==t.joinArrays?t.joinArrays:this.options.joinArrays,g=!this.i18nFormat||this.i18nFormat.handleAsObject,h=void 0!==t.count&&!y(t.count),v=j.hasDefaultValue(t),b=h?this.pluralResolver.getSuffix(l,t.count,t):"",w=t.ordinal&&h?this.pluralResolver.getSuffix(l,t.count,{ordinal:!1}):"",_=h&&!t.ordinal&&0===t.count,R=_&&t[`defaultValue${this.options.pluralSeparator}zero`]||t[`defaultValue${b}`]||t[`defaultValue${w}`]||t.defaultValue;let k=u;g&&!u&&v&&(k=R);const S=q(k),C=Object.prototype.toString.apply(k);if(!(g&&k&&S&&["[object Number]","[object Function]","[object RegExp]"].indexOf(C)<0)||y(m)&&Array.isArray(k))if(g&&y(m)&&Array.isArray(u))u=u.join(m),u&&(u=this.extendTranslation(u,e,t,o));else{let r=!1,a=!1;!this.isValidLookup(u)&&v&&(r=!0,u=R),this.isValidLookup(u)||(a=!0,u=i);const d=(t.missingKeyNoValueFallbackToKey||this.options.missingKeyNoValueFallbackToKey)&&a?void 0:u,p=v&&R!==u&&this.options.updateMissing;if(a||r||p){if(this.logger.log(p?"updateKey":"missingKey",l,s,i,p?R:u),n){const e=this.resolve(i,{...t,keySeparator:!1});e&&e.res&&this.logger.warn("Seems the loaded translations were in flat JSON format instead of nested. Either set keySeparator: false on init or make sure your translations are published in nested format.")}let e=[];const o=this.languageUtils.getFallbackCodes(this.options.fallbackLng,t.lng||this.language);if("fallback"===this.options.saveMissingTo&&o&&o[0])for(let t=0;t<o.length;t++)e.push(o[t]);else"all"===this.options.saveMissingTo?e=this.languageUtils.toResolveHierarchy(t.lng||this.language):e.push(t.lng||this.language);const r=(e,o,r)=>{var n;const i=v&&r!==u?r:d;this.options.missingKeyHandler?this.options.missingKeyHandler(e,s,o,i,p,t):null!=(n=this.backendConnector)&&n.saveMissing&&this.backendConnector.saveMissing(e,s,o,i,p,t),this.emit("missingKey",e,s,o,u)};this.options.saveMissing&&(this.options.saveMissingPlurals&&h?e.forEach(e=>{const o=this.pluralResolver.getSuffixes(e,t);_&&t[`defaultValue${this.options.pluralSeparator}zero`]&&o.indexOf(`${this.options.pluralSeparator}zero`)<0&&o.push(`${this.options.pluralSeparator}zero`),o.forEach(o=>{r([e],i+o,t[`defaultValue${o}`]||R)})}):r(e,i,R))}u=this.extendTranslation(u,e,t,c,o),a&&u===i&&this.options.appendNamespaceToMissingKey&&(u=`${s}:${i}`),(a||r)&&this.options.parseMissingKeyHandler&&(u=this.options.parseMissingKeyHandler(this.options.appendNamespaceToMissingKey?`${s}:${i}`:i,r?u:void 0))}else{if(!t.returnObjects&&!this.options.returnObjects){this.options.returnedObjectHandler||this.logger.warn("accessing an object - but returnObjects options is not enabled!");const e=this.options.returnedObjectHandler?this.options.returnedObjectHandler(p,k,{...t,ns:a}):`key '${i} (${this.language})' returned an object instead of string.`;return r?(c.res=e,c.usedParams=this.getUsedParamsDetails(t),c):e}if(n){const e=Array.isArray(k),o=e?[]:{},r=e?f:p;for(const e in k)if(Object.prototype.hasOwnProperty.call(k,e)){const i=`${r}${n}${e}`;o[e]=v&&!u?this.translate(i,{...t,defaultValue:q(R)?R[e]:void 0,joinArrays:!1,ns:a}):this.translate(i,{...t,joinArrays:!1,ns:a}),o[e]===i&&(o[e]=k[e])}u=o}}return r?(c.res=u,c.usedParams=this.getUsedParamsDetails(t),c):u}extendTranslation(e,t,o,r,n){var i,a,s=this;if(null!=(i=this.i18nFormat)&&i.parse)e=this.i18nFormat.parse(e,{...this.options.interpolation.defaultVariables,...o},o.lng||this.language||r.usedLng,r.usedNS,r.usedKey,{resolved:r});else if(!o.skipInterpolation){o.interpolation&&this.interpolator.init({...o,interpolation:{...this.options.interpolation,...o.interpolation}});const i=y(e)&&(void 0!==(null==(a=null==o?void 0:o.interpolation)?void 0:a.skipOnVariables)?o.interpolation.skipOnVariables:this.options.interpolation.skipOnVariables);let l;if(i){const t=e.match(this.interpolator.nestingRegexp);l=t&&t.length}let d=o.replace&&!y(o.replace)?o.replace:o;if(this.options.interpolation.defaultVariables&&(d={...this.options.interpolation.defaultVariables,...d}),e=this.interpolator.interpolate(e,d,o.lng||this.language||r.usedLng,o),i){const t=e.match(this.interpolator.nestingRegexp);l<(t&&t.length)&&(o.nest=!1)}!o.lng&&r&&r.res&&(o.lng=this.language||r.usedLng),!1!==o.nest&&(e=this.interpolator.nest(e,function(){for(var e=arguments.length,r=new Array(e),i=0;i<e;i++)r[i]=arguments[i];return(null==n?void 0:n[0])!==r[0]||o.context?s.translate(...r,t):(s.logger.warn(`It seems you are nesting recursively key: ${r[0]} in key: ${t[0]}`),null)},o)),o.interpolation&&this.interpolator.reset()}const l=o.postProcess||this.options.postProcess,d=y(l)?[l]:l;return null!=e&&null!=d&&d.length&&!1!==o.applyPostProcessor&&(e=F.handle(d,e,t,this.options&&this.options.postProcessPassResolved?{i18nResolved:{...r,usedParams:this.getUsedParamsDetails(o)},...o}:o,this)),e}resolve(e){let t,o,r,n,i,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return y(e)&&(e=[e]),e.forEach(e=>{if(this.isValidLookup(t))return;const s=this.extractFromKey(e,a),l=s.key;o=l;let d=s.namespaces;this.options.fallbackNS&&(d=d.concat(this.options.fallbackNS));const c=void 0!==a.count&&!y(a.count),u=c&&!a.ordinal&&0===a.count,p=void 0!==a.context&&(y(a.context)||"number"==typeof a.context)&&""!==a.context,f=a.lngs?a.lngs:this.languageUtils.toResolveHierarchy(a.lng||this.language,a.fallbackLng);d.forEach(e=>{var s,d;this.isValidLookup(t)||(i=e,!U[`${f[0]}-${e}`]&&null!=(s=this.utils)&&s.hasLoadedNamespace&&!(null!=(d=this.utils)&&d.hasLoadedNamespace(i))&&(U[`${f[0]}-${e}`]=!0,this.logger.warn(`key "${o}" for languages "${f.join(", ")}" won't get resolved as namespace "${i}" was not yet loaded`,"This means something IS WRONG in your setup. You access the t function before i18next.init / i18next.loadNamespace / i18next.changeLanguage was done. Wait for the callback or Promise to resolve before accessing it!!!")),f.forEach(o=>{var i;if(this.isValidLookup(t))return;n=o;const s=[l];if(null!=(i=this.i18nFormat)&&i.addLookupKeys)this.i18nFormat.addLookupKeys(s,l,o,e,a);else{let e;c&&(e=this.pluralResolver.getSuffix(o,a.count,a));const t=`${this.options.pluralSeparator}zero`,r=`${this.options.pluralSeparator}ordinal${this.options.pluralSeparator}`;if(c&&(s.push(l+e),a.ordinal&&0===e.indexOf(r)&&s.push(l+e.replace(r,this.options.pluralSeparator)),u&&s.push(l+t)),p){const o=`${l}${this.options.contextSeparator}${a.context}`;s.push(o),c&&(s.push(o+e),a.ordinal&&0===e.indexOf(r)&&s.push(o+e.replace(r,this.options.pluralSeparator)),u&&s.push(o+t))}}let d;for(;d=s.pop();)this.isValidLookup(t)||(r=d,t=this.getResource(o,e,d,a))}))})}),{res:t,usedKey:o,exactUsedKey:r,usedLng:n,usedNS:i}}isValidLookup(e){return!(void 0===e||!this.options.returnNull&&null===e||!this.options.returnEmptyString&&""===e)}getResource(e,t,o){var r;let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return null!=(r=this.i18nFormat)&&r.getResource?this.i18nFormat.getResource(e,t,o,n):this.resourceStore.getResource(e,t,o,n)}getUsedParamsDetails(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const t=["defaultValue","ordinal","context","replace","lng","lngs","fallbackLng","ns","keySeparator","nsSeparator","returnObjects","returnDetails","joinArrays","postProcess","interpolation"],o=e.replace&&!y(e.replace);let r=o?e.replace:e;if(o&&typeof e.count<"u"&&(r.count=e.count),this.options.interpolation.defaultVariables&&(r={...this.options.interpolation.defaultVariables,...r}),!o){r={...r};for(const e of t)delete r[e]}return r}static hasDefaultValue(e){const t="defaultValue";for(const o in e)if(Object.prototype.hasOwnProperty.call(e,o)&&t===o.substring(0,12)&&void 0!==e[o])return!0;return!1}}class H{constructor(e){this.options=e,this.supportedLngs=this.options.supportedLngs||!1,this.logger=M.create("languageUtils")}getScriptPartFromCode(e){if(!(e=N(e))||e.indexOf("-")<0)return null;const t=e.split("-");return 2===t.length||(t.pop(),"x"===t[t.length-1].toLowerCase())?null:this.formatLanguageCode(t.join("-"))}getLanguagePartFromCode(e){if(!(e=N(e))||e.indexOf("-")<0)return e;const t=e.split("-");return this.formatLanguageCode(t[0])}formatLanguageCode(e){if(y(e)&&e.indexOf("-")>-1){let t;try{t=Intl.getCanonicalLocales(e)[0]}catch{}return t&&this.options.lowerCaseLng&&(t=t.toLowerCase()),t||(this.options.lowerCaseLng?e.toLowerCase():e)}return this.options.cleanCode||this.options.lowerCaseLng?e.toLowerCase():e}isSupportedCode(e){return("languageOnly"===this.options.load||this.options.nonExplicitSupportedLngs)&&(e=this.getLanguagePartFromCode(e)),!this.supportedLngs||!this.supportedLngs.length||this.supportedLngs.indexOf(e)>-1}getBestMatchFromCodes(e){if(!e)return null;let t;return e.forEach(e=>{if(t)return;const o=this.formatLanguageCode(e);(!this.options.supportedLngs||this.isSupportedCode(o))&&(t=o)}),!t&&this.options.supportedLngs&&e.forEach(e=>{if(t)return;const o=this.getLanguagePartFromCode(e);if(this.isSupportedCode(o))return t=o;t=this.options.supportedLngs.find(e=>e===o?e:e.indexOf("-")<0&&o.indexOf("-")<0||!(e.indexOf("-")>0&&o.indexOf("-")<0&&e.substring(0,e.indexOf("-"))===o||0===e.indexOf(o)&&o.length>1)?void 0:e)}),t||(t=this.getFallbackCodes(this.options.fallbackLng)[0]),t}getFallbackCodes(e,t){if(!e)return[];if("function"==typeof e&&(e=e(t)),y(e)&&(e=[e]),Array.isArray(e))return e;if(!t)return e.default||[];let o=e[t];return o||(o=e[this.getScriptPartFromCode(t)]),o||(o=e[this.formatLanguageCode(t)]),o||(o=e[this.getLanguagePartFromCode(t)]),o||(o=e.default),o||[]}toResolveHierarchy(e,t){const o=this.getFallbackCodes(t||this.options.fallbackLng||[],e),r=[],n=e=>{e&&(this.isSupportedCode(e)?r.push(e):this.logger.warn(`rejecting language code not found in supportedLngs: ${e}`))};return y(e)&&(e.indexOf("-")>-1||e.indexOf("_")>-1)?("languageOnly"!==this.options.load&&n(this.formatLanguageCode(e)),"languageOnly"!==this.options.load&&"currentOnly"!==this.options.load&&n(this.getScriptPartFromCode(e)),"currentOnly"!==this.options.load&&n(this.getLanguagePartFromCode(e))):y(e)&&n(this.formatLanguageCode(e)),o.forEach(e=>{r.indexOf(e)<0&&n(this.formatLanguageCode(e))}),r}}const $={zero:0,one:1,two:2,few:3,many:4,other:5},z={select:e=>1===e?"one":"other",resolvedOptions:()=>({pluralCategories:["one","other"]})};class W{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.languageUtils=e,this.options=t,this.logger=M.create("pluralResolver"),this.pluralRulesCache={}}addRule(e,t){this.rules[e]=t}clearCache(){this.pluralRulesCache={}}getRule(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const o=N("dev"===e?"en":e),r=t.ordinal?"ordinal":"cardinal",n=JSON.stringify({cleanedCode:o,type:r});if(n in this.pluralRulesCache)return this.pluralRulesCache[n];let i;try{i=new Intl.PluralRules(o,{type:r})}catch{if(!Intl)return this.logger.error("No Intl support, please use an Intl polyfill!"),z;if(!e.match(/-|_/))return z;const o=this.languageUtils.getLanguagePartFromCode(e);i=this.getRule(o,t)}return this.pluralRulesCache[n]=i,i}needsPlural(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=this.getRule(e,t);return o||(o=this.getRule("dev",t)),(null==o?void 0:o.resolvedOptions().pluralCategories.length)>1}getPluralFormsOfKey(e,t){let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this.getSuffixes(e,o).map(e=>`${t}${e}`)}getSuffixes(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=this.getRule(e,t);return o||(o=this.getRule("dev",t)),o?o.resolvedOptions().pluralCategories.sort((e,t)=>$[e]-$[t]).map(e=>`${this.options.prepend}${t.ordinal?`ordinal${this.options.prepend}`:""}${e}`):[]}getSuffix(e,t){let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const r=this.getRule(e,o);return r?`${this.options.prepend}${o.ordinal?`ordinal${this.options.prepend}`:""}${r.select(t)}`:(this.logger.warn(`no plural rule found for: ${e}`),this.getSuffix("dev",t,o))}}const K=function(e,t,o){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:".",n=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],i=((e,t,o)=>{const r=C(e,o);return void 0!==r?r:C(t,o)})(e,t,o);return!i&&n&&y(o)&&(i=V(e,o,r),void 0===i&&(i=V(t,o,r))),i},G=e=>e.replace(/\$/g,"$$$$");class J{constructor(){var e;let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.logger=M.create("interpolator"),this.options=t,this.format=(null==(e=null==t?void 0:t.interpolation)?void 0:e.format)||(e=>e),this.init(t)}init(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};e.interpolation||(e.interpolation={escapeValue:!0});const{escape:t,escapeValue:o,useRawValueToEscape:r,prefix:n,prefixEscaped:i,suffix:a,suffixEscaped:s,formatSeparator:l,unescapeSuffix:d,unescapePrefix:c,nestingPrefix:u,nestingPrefixEscaped:p,nestingSuffix:f,nestingSuffixEscaped:m,nestingOptionsSeparator:g,maxReplaces:h,alwaysFormat:y}=e.interpolation;this.escape=void 0!==t?t:O,this.escapeValue=void 0===o||o,this.useRawValueToEscape=void 0!==r&&r,this.prefix=n?T(n):i||"{{",this.suffix=a?T(a):s||"}}",this.formatSeparator=l||",",this.unescapePrefix=d?"":c||"-",this.unescapeSuffix=this.unescapePrefix?"":d||"",this.nestingPrefix=u?T(u):p||T("$t("),this.nestingSuffix=f?T(f):m||T(")"),this.nestingOptionsSeparator=g||",",this.maxReplaces=h||1e3,this.alwaysFormat=void 0!==y&&y,this.resetRegExp()}reset(){this.options&&this.init(this.options)}resetRegExp(){const e=(e,t)=>(null==e?void 0:e.source)===t?(e.lastIndex=0,e):new RegExp(t,"g");this.regexp=e(this.regexp,`${this.prefix}(.+?)${this.suffix}`),this.regexpUnescape=e(this.regexpUnescape,`${this.prefix}${this.unescapePrefix}(.+?)${this.unescapeSuffix}${this.suffix}`),this.nestingRegexp=e(this.nestingRegexp,`${this.nestingPrefix}(.+?)${this.nestingSuffix}`)}interpolate(e,t,o,r){var n;let i,a,s;const l=this.options&&this.options.interpolation&&this.options.interpolation.defaultVariables||{},d=e=>{if(e.indexOf(this.formatSeparator)<0){const n=K(t,l,e,this.options.keySeparator,this.options.ignoreJSONStructure);return this.alwaysFormat?this.format(n,void 0,o,{...r,...t,interpolationkey:e}):n}const n=e.split(this.formatSeparator),i=n.shift().trim(),a=n.join(this.formatSeparator).trim();return this.format(K(t,l,i,this.options.keySeparator,this.options.ignoreJSONStructure),a,o,{...r,...t,interpolationkey:i})};this.resetRegExp();const c=(null==r?void 0:r.missingInterpolationHandler)||this.options.missingInterpolationHandler,u=void 0!==(null==(n=null==r?void 0:r.interpolation)?void 0:n.skipOnVariables)?r.interpolation.skipOnVariables:this.options.interpolation.skipOnVariables;return[{regex:this.regexpUnescape,safeValue:e=>G(e)},{regex:this.regexp,safeValue:e=>this.escapeValue?G(this.escape(e)):G(e)}].forEach(t=>{for(s=0;i=t.regex.exec(e);){const o=i[1].trim();if(a=d(o),void 0===a)if("function"==typeof c){const t=c(e,i,r);a=y(t)?t:""}else if(r&&Object.prototype.hasOwnProperty.call(r,o))a="";else{if(u){a=i[0];continue}this.logger.warn(`missed to pass in variable ${o} for interpolating ${e}`),a=""}else!y(a)&&!this.useRawValueToEscape&&(a=b(a));const n=t.safeValue(a);if(e=e.replace(i[0],n),u?(t.regex.lastIndex+=a.length,t.regex.lastIndex-=i[0].length):t.regex.lastIndex=0,s++,s>=this.maxReplaces)break}}),e}nest(e,t){let o,r,n,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const a=(e,t)=>{const o=this.nestingOptionsSeparator;if(e.indexOf(o)<0)return e;const r=e.split(new RegExp(`${o}[ ]*{`));let i=`{${r[1]}`;e=r[0],i=this.interpolate(i,n);const a=i.match(/'/g),s=i.match(/"/g);(((null==a?void 0:a.length)??0)%2==0&&!s||s.length%2!=0)&&(i=i.replace(/'/g,'"'));try{n=JSON.parse(i),t&&(n={...t,...n})}catch(t){return this.logger.warn(`failed parsing options string in nesting for key ${e}`,t),`${e}${o}${i}`}return n.defaultValue&&n.defaultValue.indexOf(this.prefix)>-1&&delete n.defaultValue,e};for(;o=this.nestingRegexp.exec(e);){let s=[];n={...i},n=n.replace&&!y(n.replace)?n.replace:n,n.applyPostProcessor=!1,delete n.defaultValue;let l=!1;if(-1!==o[0].indexOf(this.formatSeparator)&&!/{.*}/.test(o[1])){const e=o[1].split(this.formatSeparator).map(e=>e.trim());o[1]=e.shift(),s=e,l=!0}if(r=t(a.call(this,o[1].trim(),n),n),r&&o[0]===e&&!y(r))return r;y(r)||(r=b(r)),r||(this.logger.warn(`missed to resolve ${o[1]} for nesting ${e}`),r=""),l&&(r=s.reduce((e,t)=>this.format(e,t,i.lng,{...i,interpolationkey:o[1].trim()}),r.trim())),e=e.replace(o[0],r),this.regexp.lastIndex=0}return e}}const X=e=>{const t={};return(o,r,n)=>{let i=n;n&&n.interpolationkey&&n.formatParams&&n.formatParams[n.interpolationkey]&&n[n.interpolationkey]&&(i={...i,[n.interpolationkey]:void 0});const a=r+JSON.stringify(i);let s=t[a];return s||(s=e(N(r),n),t[a]=s),s(o)}};class Q{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.logger=M.create("formatter"),this.options=e,this.formats={number:X((e,t)=>{const o=new Intl.NumberFormat(e,{...t});return e=>o.format(e)}),currency:X((e,t)=>{const o=new Intl.NumberFormat(e,{...t,style:"currency"});return e=>o.format(e)}),datetime:X((e,t)=>{const o=new Intl.DateTimeFormat(e,{...t});return e=>o.format(e)}),relativetime:X((e,t)=>{const o=new Intl.RelativeTimeFormat(e,{...t});return e=>o.format(e,t.range||"day")}),list:X((e,t)=>{const o=new Intl.ListFormat(e,{...t});return e=>o.format(e)})},this.init(e)}init(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{interpolation:{}};this.formatSeparator=t.interpolation.formatSeparator||","}add(e,t){this.formats[e.toLowerCase().trim()]=t}addCached(e,t){this.formats[e.toLowerCase().trim()]=X(t)}format(e,t,o){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};const n=t.split(this.formatSeparator);if(n.length>1&&n[0].indexOf("(")>1&&n[0].indexOf(")")<0&&n.find(e=>e.indexOf(")")>-1)){const e=n.findIndex(e=>e.indexOf(")")>-1);n[0]=[n[0],...n.splice(1,e)].join(this.formatSeparator)}return n.reduce((e,t)=>{var n;const{formatName:i,formatOptions:a}=(e=>{let t=e.toLowerCase().trim();const o={};if(e.indexOf("(")>-1){const r=e.split("(");t=r[0].toLowerCase().trim();const n=r[1].substring(0,r[1].length-1);"currency"===t&&n.indexOf(":")<0?o.currency||(o.currency=n.trim()):"relativetime"===t&&n.indexOf(":")<0?o.range||(o.range=n.trim()):n.split(";").forEach(e=>{if(e){const[t,...r]=e.split(":"),n=r.join(":").trim().replace(/^'+|'+$/g,""),i=t.trim();o[i]||(o[i]=n),"false"===n&&(o[i]=!1),"true"===n&&(o[i]=!0),isNaN(n)||(o[i]=parseInt(n,10))}})}return{formatName:t,formatOptions:o}})(t);if(this.formats[i]){let t=e;try{const s=(null==(n=null==r?void 0:r.formatParams)?void 0:n[r.interpolationkey])||{},l=s.locale||s.lng||r.locale||r.lng||o;t=this.formats[i](e,l,{...a,...r,...s})}catch(e){this.logger.warn(e)}return t}return this.logger.warn(`there was no format function for ${i}`),e},e)}}class Y extends B{constructor(e,t,o){var r,n;let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};super(),this.backend=e,this.store=t,this.services=o,this.languageUtils=o.languageUtils,this.options=i,this.logger=M.create("backendConnector"),this.waitingReads=[],this.maxParallelReads=i.maxParallelReads||10,this.readingCalls=0,this.maxRetries=i.maxRetries>=0?i.maxRetries:5,this.retryTimeout=i.retryTimeout>=1?i.retryTimeout:350,this.state={},this.queue=[],null==(n=null==(r=this.backend)?void 0:r.init)||n.call(r,o,i.backend,i)}queueLoad(e,t,o,r){const n={},i={},a={},s={};return e.forEach(e=>{let r=!0;t.forEach(t=>{const a=`${e}|${t}`;!o.reload&&this.store.hasResourceBundle(e,t)?this.state[a]=2:this.state[a]<0||(1===this.state[a]?void 0===i[a]&&(i[a]=!0):(this.state[a]=1,r=!1,void 0===i[a]&&(i[a]=!0),void 0===n[a]&&(n[a]=!0),void 0===s[t]&&(s[t]=!0)))}),r||(a[e]=!0)}),(Object.keys(n).length||Object.keys(i).length)&&this.queue.push({pending:i,pendingCount:Object.keys(i).length,loaded:{},errors:[],callback:r}),{toLoad:Object.keys(n),pending:Object.keys(i),toLoadLanguages:Object.keys(a),toLoadNamespaces:Object.keys(s)}}loaded(e,t,o){const r=e.split("|"),n=r[0],i=r[1];t&&this.emit("failedLoading",n,i,t),!t&&o&&this.store.addResourceBundle(n,i,o,void 0,void 0,{skipCopy:!0}),this.state[e]=t?-1:2,t&&o&&(this.state[e]=0);const a={};this.queue.forEach(o=>{((e,t,o)=>{const{obj:r,k:n}=k(e,t,Object);r[n]=r[n]||[],r[n].push(o)})(o.loaded,[n],i),((e,t)=>{void 0!==e.pending[t]&&(delete e.pending[t],e.pendingCount--)})(o,e),t&&o.errors.push(t),0===o.pendingCount&&!o.done&&(Object.keys(o.loaded).forEach(e=>{a[e]||(a[e]={});const t=o.loaded[e];t.length&&t.forEach(t=>{void 0===a[e][t]&&(a[e][t]=!0)})}),o.done=!0,o.errors.length?o.callback(o.errors):o.callback())}),this.emit("loaded",a),this.queue=this.queue.filter(e=>!e.done)}read(e,t,o){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:this.retryTimeout,i=arguments.length>5?arguments[5]:void 0;if(!e.length)return i(null,{});if(this.readingCalls>=this.maxParallelReads)return void this.waitingReads.push({lng:e,ns:t,fcName:o,tried:r,wait:n,callback:i});this.readingCalls++;const a=(a,s)=>{if(this.readingCalls--,this.waitingReads.length>0){const e=this.waitingReads.shift();this.read(e.lng,e.ns,e.fcName,e.tried,e.wait,e.callback)}a&&s&&r<this.maxRetries?setTimeout(()=>{this.read.call(this,e,t,o,r+1,2*n,i)},n):i(a,s)},s=this.backend[o].bind(this.backend);if(2!==s.length)return s(e,t,a);try{const o=s(e,t);o&&"function"==typeof o.then?o.then(e=>a(null,e)).catch(a):a(null,o)}catch(e){a(e)}}prepareLoading(e,t){let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=arguments.length>3?arguments[3]:void 0;if(!this.backend)return this.logger.warn("No backend was added via i18next.use. Will not load resources."),r&&r();y(e)&&(e=this.languageUtils.toResolveHierarchy(e)),y(t)&&(t=[t]);const n=this.queueLoad(e,t,o,r);if(!n.toLoad.length)return n.pending.length||r(),null;n.toLoad.forEach(e=>{this.loadOne(e)})}load(e,t,o){this.prepareLoading(e,t,{},o)}reload(e,t,o){this.prepareLoading(e,t,{reload:!0},o)}loadOne(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";const o=e.split("|"),r=o[0],n=o[1];this.read(r,n,"read",void 0,void 0,(o,i)=>{o&&this.logger.warn(`${t}loading namespace ${n} for language ${r} failed`,o),!o&&i&&this.logger.log(`${t}loaded namespace ${n} for language ${r}`,i),this.loaded(e,o,i)})}saveMissing(e,t,o,r,n){var i,a,s,l,d;let c=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{},u=arguments.length>6&&void 0!==arguments[6]?arguments[6]:()=>{};if(null==(a=null==(i=this.services)?void 0:i.utils)||!a.hasLoadedNamespace||null!=(l=null==(s=this.services)?void 0:s.utils)&&l.hasLoadedNamespace(t)){if(null!=o&&""!==o){if(null!=(d=this.backend)&&d.create){const i={...c,isUpdate:n},a=this.backend.create.bind(this.backend);if(a.length<6)try{let n;n=5===a.length?a(e,t,o,r,i):a(e,t,o,r),n&&"function"==typeof n.then?n.then(e=>u(null,e)).catch(u):u(null,n)}catch(e){u(e)}else a(e,t,o,r,u,i)}!e||!e[0]||this.store.addResource(e[0],t,o,r)}}else this.logger.warn(`did not save key "${o}" as the namespace "${t}" was not yet loaded`,"This means something IS WRONG in your setup. You access the t function before i18next.init / i18next.loadNamespace / i18next.changeLanguage was done. Wait for the callback or Promise to resolve before accessing it!!!")}}const Z=()=>({debug:!1,initAsync:!0,ns:["translation"],defaultNS:["translation"],fallbackLng:["dev"],fallbackNS:!1,supportedLngs:!1,nonExplicitSupportedLngs:!1,load:"all",preload:!1,simplifyPluralSuffix:!0,keySeparator:".",nsSeparator:":",pluralSeparator:"_",contextSeparator:"_",partialBundledLanguages:!1,saveMissing:!1,updateMissing:!1,saveMissingTo:"fallback",saveMissingPlurals:!0,missingKeyHandler:!1,missingInterpolationHandler:!1,postProcess:!1,postProcessPassResolved:!1,returnNull:!1,returnEmptyString:!0,returnObjects:!1,joinArrays:!1,returnedObjectHandler:!1,parseMissingKeyHandler:!1,appendNamespaceToMissingKey:!1,appendNamespaceToCIMode:!1,overloadTranslationOptionHandler:e=>{let t={};if("object"==typeof e[1]&&(t=e[1]),y(e[1])&&(t.defaultValue=e[1]),y(e[2])&&(t.tDescription=e[2]),"object"==typeof e[2]||"object"==typeof e[3]){const o=e[3]||e[2];Object.keys(o).forEach(e=>{t[e]=o[e]})}return t},interpolation:{escapeValue:!0,format:e=>e,prefix:"{{",suffix:"}}",formatSeparator:",",unescapePrefix:"-",nestingPrefix:"$t(",nestingSuffix:")",nestingOptionsSeparator:",",maxReplaces:1e3,skipOnVariables:!0}}),ee=e=>{var t,o;return y(e.ns)&&(e.ns=[e.ns]),y(e.fallbackLng)&&(e.fallbackLng=[e.fallbackLng]),y(e.fallbackNS)&&(e.fallbackNS=[e.fallbackNS]),(null==(o=null==(t=e.supportedLngs)?void 0:t.indexOf)?void 0:o.call(t,"cimode"))<0&&(e.supportedLngs=e.supportedLngs.concat(["cimode"])),"boolean"==typeof e.initImmediate&&(e.initAsync=e.initImmediate),e},te=()=>{};class oe extends B{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;if(super(),this.options=ee(e),this.services={},this.logger=M,this.modules={external:[]},o=this,Object.getOwnPropertyNames(Object.getPrototypeOf(o)).forEach(e=>{"function"==typeof o[e]&&(o[e]=o[e].bind(o))}),t&&!this.isInitialized&&!e.isClone){if(!this.options.initAsync)return this.init(e,t),this;setTimeout(()=>{this.init(e,t)},0)}var o}init(){var e=this;let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},o=arguments.length>1?arguments[1]:void 0;this.isInitializing=!0,"function"==typeof t&&(o=t,t={}),null==t.defaultNS&&t.ns&&(y(t.ns)?t.defaultNS=t.ns:t.ns.indexOf("translation")<0&&(t.defaultNS=t.ns[0]));const r=Z();this.options={...r,...this.options,...ee(t)},this.options.interpolation={...r.interpolation,...this.options.interpolation},void 0!==t.keySeparator&&(this.options.userDefinedKeySeparator=t.keySeparator),void 0!==t.nsSeparator&&(this.options.userDefinedNsSeparator=t.nsSeparator);const n=e=>e?"function"==typeof e?new e:e:null;if(!this.options.isClone){let t;this.modules.logger?M.init(n(this.modules.logger),this.options):M.init(null,this.options),t=this.modules.formatter?this.modules.formatter:Q;const o=new H(this.options);this.store=new D(this.options.resources,this.options);const i=this.services;i.logger=M,i.resourceStore=this.store,i.languageUtils=o,i.pluralResolver=new W(o,{prepend:this.options.pluralSeparator,simplifyPluralSuffix:this.options.simplifyPluralSuffix}),t&&(!this.options.interpolation.format||this.options.interpolation.format===r.interpolation.format)&&(i.formatter=n(t),i.formatter.init(i,this.options),this.options.interpolation.format=i.formatter.format.bind(i.formatter)),i.interpolator=new J(this.options),i.utils={hasLoadedNamespace:this.hasLoadedNamespace.bind(this)},i.backendConnector=new Y(n(this.modules.backend),i.resourceStore,i,this.options),i.backendConnector.on("*",function(t){for(var o=arguments.length,r=new Array(o>1?o-1:0),n=1;n<o;n++)r[n-1]=arguments[n];e.emit(t,...r)}),this.modules.languageDetector&&(i.languageDetector=n(this.modules.languageDetector),i.languageDetector.init&&i.languageDetector.init(i,this.options.detection,this.options)),this.modules.i18nFormat&&(i.i18nFormat=n(this.modules.i18nFormat),i.i18nFormat.init&&i.i18nFormat.init(this)),this.translator=new j(this.services,this.options),this.translator.on("*",function(t){for(var o=arguments.length,r=new Array(o>1?o-1:0),n=1;n<o;n++)r[n-1]=arguments[n];e.emit(t,...r)}),this.modules.external.forEach(e=>{e.init&&e.init(this)})}if(this.format=this.options.interpolation.format,o||(o=te),this.options.fallbackLng&&!this.services.languageDetector&&!this.options.lng){const e=this.services.languageUtils.getFallbackCodes(this.options.fallbackLng);e.length>0&&"dev"!==e[0]&&(this.options.lng=e[0])}!this.services.languageDetector&&!this.options.lng&&this.logger.warn("init: no languageDetector is used and no lng is defined"),["getResource","hasResourceBundle","getResourceBundle","getDataByLanguage"].forEach(t=>{this[t]=function(){return e.store[t](...arguments)}}),["addResource","addResources","addResourceBundle","removeResourceBundle"].forEach(t=>{this[t]=function(){return e.store[t](...arguments),e}});const i=v(),a=()=>{const e=(e,t)=>{this.isInitializing=!1,this.isInitialized&&!this.initializedStoreOnce&&this.logger.warn("init: i18next is already initialized. You should call init just once!"),this.isInitialized=!0,this.options.isClone||this.logger.log("initialized",this.options),this.emit("initialized",this.options),i.resolve(t),o(e,t)};if(this.languages&&!this.isInitialized)return e(null,this.t.bind(this));this.changeLanguage(this.options.lng,e)};return this.options.resources||!this.options.initAsync?a():setTimeout(a,0),i}loadResources(e){var t,o;let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:te;const n=y(e)?e:this.language;if("function"==typeof e&&(r=e),!this.options.resources||this.options.partialBundledLanguages){if("cimode"===(null==n?void 0:n.toLowerCase())&&(!this.options.preload||0===this.options.preload.length))return r();const e=[],i=t=>{t&&"cimode"!==t&&this.services.languageUtils.toResolveHierarchy(t).forEach(t=>{"cimode"!==t&&e.indexOf(t)<0&&e.push(t)})};n?i(n):this.services.languageUtils.getFallbackCodes(this.options.fallbackLng).forEach(e=>i(e)),null==(o=null==(t=this.options.preload)?void 0:t.forEach)||o.call(t,e=>i(e)),this.services.backendConnector.load(e,this.options.ns,e=>{!e&&!this.resolvedLanguage&&this.language&&this.setResolvedLanguage(this.language),r(e)})}else r(null)}reloadResources(e,t,o){const r=v();return"function"==typeof e&&(o=e,e=void 0),"function"==typeof t&&(o=t,t=void 0),e||(e=this.languages),t||(t=this.options.ns),o||(o=te),this.services.backendConnector.reload(e,t,e=>{r.resolve(),o(e)}),r}use(e){if(!e)throw new Error("You are passing an undefined module! Please check the object you are passing to i18next.use()");if(!e.type)throw new Error("You are passing a wrong module! Please check the object you are passing to i18next.use()");return"backend"===e.type&&(this.modules.backend=e),("logger"===e.type||e.log&&e.warn&&e.error)&&(this.modules.logger=e),"languageDetector"===e.type&&(this.modules.languageDetector=e),"i18nFormat"===e.type&&(this.modules.i18nFormat=e),"postProcessor"===e.type&&F.addPostProcessor(e),"formatter"===e.type&&(this.modules.formatter=e),"3rdParty"===e.type&&this.modules.external.push(e),this}setResolvedLanguage(e){if(e&&this.languages&&!(["cimode","dev"].indexOf(e)>-1))for(let e=0;e<this.languages.length;e++){const t=this.languages[e];if(!(["cimode","dev"].indexOf(t)>-1)&&this.store.hasLanguageSomeTranslations(t)){this.resolvedLanguage=t;break}}}changeLanguage(e,t){var o=this;this.isLanguageChangingTo=e;const r=v();this.emit("languageChanging",e);const n=e=>{this.language=e,this.languages=this.services.languageUtils.toResolveHierarchy(e),this.resolvedLanguage=void 0,this.setResolvedLanguage(e)},i=(e,i)=>{i?(n(i),this.translator.changeLanguage(i),this.isLanguageChangingTo=void 0,this.emit("languageChanged",i),this.logger.log("languageChanged",i)):this.isLanguageChangingTo=void 0,r.resolve(function(){return o.t(...arguments)}),t&&t(e,function(){return o.t(...arguments)})},a=t=>{var o,r;!e&&!t&&this.services.languageDetector&&(t=[]);const a=y(t)?t:this.services.languageUtils.getBestMatchFromCodes(t);a&&(this.language||n(a),this.translator.language||this.translator.changeLanguage(a),null==(r=null==(o=this.services.languageDetector)?void 0:o.cacheUserLanguage)||r.call(o,a)),this.loadResources(a,e=>{i(e,a)})};return e||!this.services.languageDetector||this.services.languageDetector.async?!e&&this.services.languageDetector&&this.services.languageDetector.async?0===this.services.languageDetector.detect.length?this.services.languageDetector.detect().then(a):this.services.languageDetector.detect(a):a(e):a(this.services.languageDetector.detect()),r}getFixedT(e,t,o){var r=this;const n=function(e,t){let i;if("object"!=typeof t){for(var a=arguments.length,s=new Array(a>2?a-2:0),l=2;l<a;l++)s[l-2]=arguments[l];i=r.options.overloadTranslationOptionHandler([e,t].concat(s))}else i={...t};i.lng=i.lng||n.lng,i.lngs=i.lngs||n.lngs,i.ns=i.ns||n.ns,""!==i.keyPrefix&&(i.keyPrefix=i.keyPrefix||o||n.keyPrefix);const d=r.options.keySeparator||".";let c;return c=i.keyPrefix&&Array.isArray(e)?e.map(e=>`${i.keyPrefix}${d}${e}`):i.keyPrefix?`${i.keyPrefix}${d}${e}`:e,r.t(c,i)};return y(e)?n.lng=e:n.lngs=e,n.ns=t,n.keyPrefix=o,n}t(){for(var e,t=arguments.length,o=new Array(t),r=0;r<t;r++)o[r]=arguments[r];return null==(e=this.translator)?void 0:e.translate(...o)}exists(){for(var e,t=arguments.length,o=new Array(t),r=0;r<t;r++)o[r]=arguments[r];return null==(e=this.translator)?void 0:e.exists(...o)}setDefaultNamespace(e){this.options.defaultNS=e}hasLoadedNamespace(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!this.isInitialized)return this.logger.warn("hasLoadedNamespace: i18next was not initialized",this.languages),!1;if(!this.languages||!this.languages.length)return this.logger.warn("hasLoadedNamespace: i18n.languages were undefined or empty",this.languages),!1;const o=t.lng||this.resolvedLanguage||this.languages[0],r=!!this.options&&this.options.fallbackLng,n=this.languages[this.languages.length-1];if("cimode"===o.toLowerCase())return!0;const i=(e,t)=>{const o=this.services.backendConnector.state[`${e}|${t}`];return-1===o||0===o||2===o};if(t.precheck){const e=t.precheck(this,i);if(void 0!==e)return e}return!!(this.hasResourceBundle(o,e)||!this.services.backendConnector.backend||this.options.resources&&!this.options.partialBundledLanguages||i(o,e)&&(!r||i(n,e)))}loadNamespaces(e,t){const o=v();return this.options.ns?(y(e)&&(e=[e]),e.forEach(e=>{this.options.ns.indexOf(e)<0&&this.options.ns.push(e)}),this.loadResources(e=>{o.resolve(),t&&t(e)}),o):(t&&t(),Promise.resolve())}loadLanguages(e,t){const o=v();y(e)&&(e=[e]);const r=this.options.preload||[],n=e.filter(e=>r.indexOf(e)<0&&this.services.languageUtils.isSupportedCode(e));return n.length?(this.options.preload=r.concat(n),this.loadResources(e=>{o.resolve(),t&&t(e)}),o):(t&&t(),Promise.resolve())}dir(e){var t,o;if(e||(e=this.resolvedLanguage||((null==(t=this.languages)?void 0:t.length)>0?this.languages[0]:this.language)),!e)return"rtl";const r=(null==(o=this.services)?void 0:o.languageUtils)||new H(Z());return["ar","shu","sqr","ssh","xaa","yhd","yud","aao","abh","abv","acm","acq","acw","acx","acy","adf","ads","aeb","aec","afb","ajp","apc","apd","arb","arq","ars","ary","arz","auz","avl","ayh","ayl","ayn","ayp","bbz","pga","he","iw","ps","pbt","pbu","pst","prp","prd","ug","ur","ydd","yds","yih","ji","yi","hbo","men","xmn","fa","jpr","peo","pes","prs","dv","sam","ckb"].indexOf(r.getLanguagePartFromCode(e))>-1||e.toLowerCase().indexOf("-arab")>1?"rtl":"ltr"}static createInstance(){return new oe(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},arguments.length>1?arguments[1]:void 0)}cloneInstance(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:te;const o=e.forkResourceStore;o&&delete e.forkResourceStore;const r={...this.options,...e,isClone:!0},n=new oe(r);if((void 0!==e.debug||void 0!==e.prefix)&&(n.logger=n.logger.clone(e)),["store","services","language"].forEach(e=>{n[e]=this[e]}),n.services={...this.services},n.services.utils={hasLoadedNamespace:n.hasLoadedNamespace.bind(n)},o){const e=Object.keys(this.store.data).reduce((e,t)=>(e[t]={...this.store.data[t]},Object.keys(e[t]).reduce((o,r)=>(o[r]={...e[t][r]},o),{})),{});n.store=new D(e,r),n.services.resourceStore=n.store}return n.translator=new j(n.services,r),n.translator.on("*",function(e){for(var t=arguments.length,o=new Array(t>1?t-1:0),r=1;r<t;r++)o[r-1]=arguments[r];n.emit(e,...o)}),n.init(r,t),n.translator.options=r,n.translator.backendConnector.services.utils={hasLoadedNamespace:n.hasLoadedNamespace.bind(n)},n}toJSON(){return{options:this.options,store:this.store,language:this.language,languages:this.languages,resolvedLanguage:this.resolvedLanguage}}}const re=oe.createInstance();re.createInstance=oe.createInstance,re.createInstance,re.dir,re.init,re.loadResources,re.reloadResources,re.use,re.changeLanguage,re.getFixedT,re.t,re.exists,re.setDefaultNamespace,re.hasLoadedNamespace,re.loadNamespaces,re.loadLanguages;var ne=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function ie(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function ae(e){if(e.__esModule)return e;var t=e.default;if("function"==typeof t){var o=function e(){return this instanceof e?Reflect.construct(t,arguments,this.constructor):t.apply(this,arguments)};o.prototype=t.prototype}else o={};return Object.defineProperty(o,"__esModule",{value:!0}),Object.keys(e).forEach(function(t){var r=Object.getOwnPropertyDescriptor(e,t);Object.defineProperty(o,t,r.get?r:{enumerable:!0,get:function(){return e[t]}})}),o}const{slice:se,forEach:le}=[];const de=/^[\u0009\u0020-\u007e\u0080-\u00ff]+$/,ce={create(e,t,o,r){let n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{path:"/",sameSite:"strict"};o&&(n.expires=new Date,n.expires.setTime(n.expires.getTime()+60*o*1e3)),r&&(n.domain=r),document.cookie=function(e,t){const o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{path:"/"};let r=`${e}=${encodeURIComponent(t)}`;if(o.maxAge>0){const e=o.maxAge-0;if(Number.isNaN(e))throw new Error("maxAge should be a Number");r+=`; Max-Age=${Math.floor(e)}`}if(o.domain){if(!de.test(o.domain))throw new TypeError("option domain is invalid");r+=`; Domain=${o.domain}`}if(o.path){if(!de.test(o.path))throw new TypeError("option path is invalid");r+=`; Path=${o.path}`}if(o.expires){if("function"!=typeof o.expires.toUTCString)throw new TypeError("option expires is invalid");r+=`; Expires=${o.expires.toUTCString()}`}if(o.httpOnly&&(r+="; HttpOnly"),o.secure&&(r+="; Secure"),o.sameSite)switch("string"==typeof o.sameSite?o.sameSite.toLowerCase():o.sameSite){case!0:r+="; SameSite=Strict";break;case"lax":r+="; SameSite=Lax";break;case"strict":r+="; SameSite=Strict";break;case"none":r+="; SameSite=None";break;default:throw new TypeError("option sameSite is invalid")}return o.partitioned&&(r+="; Partitioned"),r}(e,t,n)},read(e){const t=`${e}=`,o=document.cookie.split(";");for(let e=0;e<o.length;e++){let r=o[e];for(;" "===r.charAt(0);)r=r.substring(1,r.length);if(0===r.indexOf(t))return r.substring(t.length,r.length)}return null},remove(e,t){this.create(e,"",-1,t)}};var ue={name:"cookie",lookup(e){let{lookupCookie:t}=e;if(t&&typeof document<"u")return ce.read(t)||void 0},cacheUserLanguage(e,t){let{lookupCookie:o,cookieMinutes:r,cookieDomain:n,cookieOptions:i}=t;o&&typeof document<"u"&&ce.create(o,e,r,n,i)}},pe={name:"querystring",lookup(e){var t;let o,{lookupQuerystring:r}=e;if(typeof window<"u"){let{search:e}=window.location;!window.location.search&&(null==(t=window.location.hash)?void 0:t.indexOf("?"))>-1&&(e=window.location.hash.substring(window.location.hash.indexOf("?")));const n=e.substring(1).split("&");for(let e=0;e<n.length;e++){const t=n[e].indexOf("=");t>0&&n[e].substring(0,t)===r&&(o=n[e].substring(t+1))}}return o}},fe={name:"hash",lookup(e){var t;let o,{lookupHash:r,lookupFromHashIndex:n}=e;if(typeof window<"u"){const{hash:e}=window.location;if(e&&e.length>2){const i=e.substring(1);if(r){const e=i.split("&");for(let t=0;t<e.length;t++){const n=e[t].indexOf("=");n>0&&e[t].substring(0,n)===r&&(o=e[t].substring(n+1))}}if(o)return o;if(!o&&n>-1){const o=e.match(/\/([a-zA-Z-]*)/g);return Array.isArray(o)?null==(t=o["number"==typeof n?n:0])?void 0:t.replace("/",""):void 0}}}return o}};let me=null;const ge=()=>{if(null!==me)return me;try{if(me=typeof window<"u"&&null!==window.localStorage,!me)return!1;const e="i18next.translate.boo";window.localStorage.setItem(e,"foo"),window.localStorage.removeItem(e)}catch{me=!1}return me};var he={name:"localStorage",lookup(e){let{lookupLocalStorage:t}=e;if(t&&ge())return window.localStorage.getItem(t)||void 0},cacheUserLanguage(e,t){let{lookupLocalStorage:o}=t;o&&ge()&&window.localStorage.setItem(o,e)}};let ye=null;const ve=()=>{if(null!==ye)return ye;try{if(ye=typeof window<"u"&&null!==window.sessionStorage,!ye)return!1;const e="i18next.translate.boo";window.sessionStorage.setItem(e,"foo"),window.sessionStorage.removeItem(e)}catch{ye=!1}return ye};var be={name:"sessionStorage",lookup(e){let{lookupSessionStorage:t}=e;if(t&&ve())return window.sessionStorage.getItem(t)||void 0},cacheUserLanguage(e,t){let{lookupSessionStorage:o}=t;o&&ve()&&window.sessionStorage.setItem(o,e)}},we={name:"navigator",lookup(e){const t=[];if(typeof navigator<"u"){const{languages:e,userLanguage:o,language:r}=navigator;if(e)for(let o=0;o<e.length;o++)t.push(e[o]);o&&t.push(o),r&&t.push(r)}return t.length>0?t:void 0}},_e={name:"htmlTag",lookup(e){let t,{htmlTag:o}=e;const r=o||(typeof document<"u"?document.documentElement:null);return r&&"function"==typeof r.getAttribute&&(t=r.getAttribute("lang")),t}},Re={name:"path",lookup(e){var t;let{lookupFromPathIndex:o}=e;if(typeof window>"u")return;const r=window.location.pathname.match(/\/([a-zA-Z-]*)/g);return Array.isArray(r)?null==(t=r["number"==typeof o?o:0])?void 0:t.replace("/",""):void 0}},ke={name:"subdomain",lookup(e){var t,o;let{lookupFromSubdomainIndex:r}=e;const n="number"==typeof r?r+1:1,i=typeof window<"u"&&(null==(o=null==(t=window.location)?void 0:t.hostname)?void 0:o.match(/^(\w{2,5})\.(([a-z0-9-]{1,63}\.[a-z]{2,6})|localhost)/i));if(i)return i[n]}};let Se=!1;try{document.cookie,Se=!0}catch{}const Ce=["querystring","cookie","localStorage","sessionStorage","navigator","htmlTag"];Se||Ce.splice(1,1);class Le{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.type="languageDetector",this.detectors={},this.init(e,t)}init(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{languageUtils:{}},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};this.services=e,this.options=function(e){return le.call(se.call(arguments,1),t=>{if(t)for(const o in t)void 0===e[o]&&(e[o]=t[o])}),e}(t,this.options||{},{order:Ce,lookupQuerystring:"lng",lookupCookie:"i18next",lookupLocalStorage:"i18nextLng",lookupSessionStorage:"i18nextLng",caches:["localStorage"],excludeCacheFor:["cimode"],convertDetectedLanguage:e=>e}),"string"==typeof this.options.convertDetectedLanguage&&this.options.convertDetectedLanguage.indexOf("15897")>-1&&(this.options.convertDetectedLanguage=e=>e.replace("-","_")),this.options.lookupFromUrlIndex&&(this.options.lookupFromPathIndex=this.options.lookupFromUrlIndex),this.i18nOptions=o,this.addDetector(ue),this.addDetector(pe),this.addDetector(he),this.addDetector(be),this.addDetector(we),this.addDetector(_e),this.addDetector(Re),this.addDetector(ke),this.addDetector(fe)}addDetector(e){return this.detectors[e.name]=e,this}detect(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.options.order,t=[];return e.forEach(e=>{if(this.detectors[e]){let o=this.detectors[e].lookup(this.options);o&&"string"==typeof o&&(o=[o]),o&&(t=t.concat(o))}}),t=t.filter(e=>{return null!=e&&!("string"==typeof(t=e)&&[/<\s*script.*?>/i,/<\s*\/\s*script\s*>/i,/<\s*img.*?on\w+\s*=/i,/<\s*\w+\s*on\w+\s*=.*?>/i,/javascript\s*:/i,/vbscript\s*:/i,/expression\s*\(/i,/eval\s*\(/i,/alert\s*\(/i,/document\.cookie/i,/document\.write\s*\(/i,/window\.location/i,/innerHTML/i].some(e=>e.test(t)));var t}).map(e=>this.options.convertDetectedLanguage(e)),this.services&&this.services.languageUtils&&this.services.languageUtils.getBestMatchFromCodes?t:t.length>0?t[0]:null}cacheUserLanguage(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.options.caches;t&&(this.options.excludeCacheFor&&this.options.excludeCacheFor.indexOf(e)>-1||t.forEach(t=>{this.detectors[t]&&this.detectors[t].cacheUserLanguage(e,this.options)}))}}Le.type="languageDetector";const Te=ie(Le),Ee={LearnMore:"Learn More",Replay:"Replay"},Oe={LearnMore:"",Replay:""},Ae="in_renderer_i18n";re.use(Te).init({fallbackLng:"en",detection:{lookupCookie:Ae,lookupLocalStorage:Ae,lookupSessionStorage:Ae},resources:{en:{translation:Ee},ja:{translation:Oe}}});const Pe=re;var Ve={exports:{}};
/*!
 * @overview es6-promise - a tiny implementation of Promises/A+.
 * @copyright Copyright (c) 2014 Yehuda Katz, Tom Dale, Stefan Penner and contributors (Conversion to ES6 API by Jake Archibald)
 * @license   Licensed under MIT license
 *            See https://raw.githubusercontent.com/stefanpenner/es6-promise/master/LICENSE
 * @version   v4.2.8+1e68dce6
 */const Ne=ie(Ve.exports=function(){function e(e){var t=typeof e;return null!==e&&("object"===t||"function"===t)}function t(e){return"function"==typeof e}var o=Array.isArray?Array.isArray:function(e){return"[object Array]"===Object.prototype.toString.call(e)},r=0,n=void 0,i=void 0,a=function(e,t){b[r]=e,b[r+1]=t,2===(r+=2)&&(i?i(w):R())};function s(e){i=e}function l(e){a=e}var d=typeof window<"u"?window:void 0,c=d||{},u=c.MutationObserver||c.WebKitMutationObserver,p=typeof self>"u"&&typeof process<"u"&&"[object process]"==={}.toString.call(process),f=typeof Uint8ClampedArray<"u"&&typeof importScripts<"u"&&typeof MessageChannel<"u";function m(){return function(){return process.nextTick(w)}}function g(){return typeof n<"u"?function(){n(w)}:v()}function h(){var e=0,t=new u(w),o=document.createTextNode("");return t.observe(o,{characterData:!0}),function(){o.data=e=++e%2}}function y(){var e=new MessageChannel;return e.port1.onmessage=w,function(){return e.port2.postMessage(0)}}function v(){var e=setTimeout;return function(){return e(w,1)}}var b=new Array(1e3);function w(){for(var e=0;e<r;e+=2)(0,b[e])(b[e+1]),b[e]=void 0,b[e+1]=void 0;r=0}function _(){try{var e=Function("return this")().require("vertx");return n=e.runOnLoop||e.runOnContext,g()}catch{return v()}}var R=void 0;function k(e,t){var o=this,r=new this.constructor(L);void 0===r[C]&&W(r);var n=o._state;if(n){var i=arguments[n-1];a(function(){return j(n,r,i,o._result)})}else U(o,r,e,t);return r}function S(e){var t=this;if(e&&"object"==typeof e&&e.constructor===t)return e;var o=new t(L);return M(o,e),o}R=p?m():u?h():f?y():void 0===d?_():v();var C=Math.random().toString(36).substring(2);function L(){}var T=void 0,E=1,O=2;function A(){return new TypeError("You cannot resolve a promise with itself")}function P(){return new TypeError("A promises callback cannot return that same promise.")}function V(e,t,o,r){try{e.call(t,o,r)}catch(e){return e}}function N(e,t,o){a(function(e){var r=!1,n=V(o,t,function(o){r||(r=!0,t!==o?M(e,o):D(e,o))},function(t){r||(r=!0,F(e,t))},"Settle: "+(e._label||" unknown promise"));!r&&n&&(r=!0,F(e,n))},e)}function x(e,t){t._state===E?D(e,t._result):t._state===O?F(e,t._result):U(t,void 0,function(t){return M(e,t)},function(t){return F(e,t)})}function I(e,o,r){o.constructor===e.constructor&&r===k&&o.constructor.resolve===S?x(e,o):void 0===r?D(e,o):t(r)?N(e,o,r):D(e,o)}function M(t,o){if(t===o)F(t,A());else if(e(o)){var r=void 0;try{r=o.then}catch(e){return void F(t,e)}I(t,o,r)}else D(t,o)}function B(e){e._onerror&&e._onerror(e._result),q(e)}function D(e,t){e._state===T&&(e._result=t,e._state=E,0!==e._subscribers.length&&a(q,e))}function F(e,t){e._state===T&&(e._state=O,e._result=t,a(B,e))}function U(e,t,o,r){var n=e._subscribers,i=n.length;e._onerror=null,n[i]=t,n[i+E]=o,n[i+O]=r,0===i&&e._state&&a(q,e)}function q(e){var t=e._subscribers,o=e._state;if(0!==t.length){for(var r=void 0,n=void 0,i=e._result,a=0;a<t.length;a+=3)r=t[a],n=t[a+o],r?j(o,r,n,i):n(i);e._subscribers.length=0}}function j(e,o,r,n){var i=t(r),a=void 0,s=void 0,l=!0;if(i){try{a=r(n)}catch(e){l=!1,s=e}if(o===a)return void F(o,P())}else a=n;o._state!==T||(i&&l?M(o,a):!1===l?F(o,s):e===E?D(o,a):e===O&&F(o,a))}function H(e,t){try{t(function(t){M(e,t)},function(t){F(e,t)})}catch(t){F(e,t)}}var $=0;function z(){return $++}function W(e){e[C]=$++,e._state=void 0,e._result=void 0,e._subscribers=[]}function K(){return new Error("Array Methods must be provided an Array")}var G=function(){function e(e,t){this._instanceConstructor=e,this.promise=new e(L),this.promise[C]||W(this.promise),o(t)?(this.length=t.length,this._remaining=t.length,this._result=new Array(this.length),0===this.length?D(this.promise,this._result):(this.length=this.length||0,this._enumerate(t),0===this._remaining&&D(this.promise,this._result))):F(this.promise,K())}return e.prototype._enumerate=function(e){for(var t=0;this._state===T&&t<e.length;t++)this._eachEntry(e[t],t)},e.prototype._eachEntry=function(e,t){var o=this._instanceConstructor,r=o.resolve;if(r===S){var n=void 0,i=void 0,a=!1;try{n=e.then}catch(e){a=!0,i=e}if(n===k&&e._state!==T)this._settledAt(e._state,t,e._result);else if("function"!=typeof n)this._remaining--,this._result[t]=e;else if(o===ee){var s=new o(L);a?F(s,i):I(s,e,n),this._willSettleAt(s,t)}else this._willSettleAt(new o(function(t){return t(e)}),t)}else this._willSettleAt(r(e),t)},e.prototype._settledAt=function(e,t,o){var r=this.promise;r._state===T&&(this._remaining--,e===O?F(r,o):this._result[t]=o),0===this._remaining&&D(r,this._result)},e.prototype._willSettleAt=function(e,t){var o=this;U(e,void 0,function(e){return o._settledAt(E,t,e)},function(e){return o._settledAt(O,t,e)})},e}();function J(e){return new G(this,e).promise}function X(e){var t=this;return o(e)?new t(function(o,r){for(var n=e.length,i=0;i<n;i++)t.resolve(e[i]).then(o,r)}):new t(function(e,t){return t(new TypeError("You must pass an array to race."))})}function Q(e){var t=new this(L);return F(t,e),t}function Y(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}function Z(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}var ee=function(){function e(t){this[C]=z(),this._result=this._state=void 0,this._subscribers=[],L!==t&&("function"!=typeof t&&Y(),this instanceof e?H(this,t):Z())}return e.prototype.catch=function(e){return this.then(null,e)},e.prototype.finally=function(e){var o=this,r=o.constructor;return t(e)?o.then(function(t){return r.resolve(e()).then(function(){return t})},function(t){return r.resolve(e()).then(function(){throw t})}):o.then(e,e)},e}();function te(){var e=void 0;if(typeof ne<"u")e=ne;else if(typeof self<"u")e=self;else try{e=Function("return this")()}catch{throw new Error("polyfill failed because global object is unavailable in this environment")}var t=e.Promise;if(t){var o=null;try{o=Object.prototype.toString.call(t.resolve())}catch{}if("[object Promise]"===o&&!t.cast)return}e.Promise=ee}return ee.prototype.then=k,ee.all=J,ee.race=X,ee.resolve=S,ee.reject=Q,ee._setScheduler=s,ee._setAsap=l,ee._asap=a,ee.polyfill=te,ee.Promise=ee,ee}());"function"!=typeof Object.assign&&Object.defineProperty(Object,"assign",{value:function(e,t){if(null==e)throw new TypeError("Cannot convert undefined or null to object");const o=Object(e);for(let e=1;e<arguments.length;e++){const t=arguments[e];if(null!=t)for(let e in t)Object.prototype.hasOwnProperty.call(t,e)&&(o[e]=t[e])}return o},writable:!0,configurable:!0}),function(){if("function"==typeof globalThis.CustomEvent)return!1;function e(e,t){t=t||{bubbles:!1,cancelable:!1,detail:void 0};const o=document.createEvent("CustomEvent");return o.initCustomEvent(e,t.bubbles,t.cancelable,t.detail),o}e.prototype=globalThis.Event.prototype,globalThis.CustomEvent=e}(),typeof globalThis.Element<"u"&&typeof globalThis.CharacterData<"u"&&typeof globalThis.DocumentType<"u"&&[Element.prototype,CharacterData.prototype,DocumentType.prototype].forEach(function(e){e.hasOwnProperty("remove")||Object.defineProperty(e,"remove",{configurable:!0,enumerable:!0,writable:!0,value:function(){null!==this.parentNode&&this.parentNode.removeChild(this)}})}),Ne.polyfill(),typeof window<"u"&&!window.dashjs&&(window.dashjs={skipAutoCreate:!0,isDefaultSubject:!0});const xe=[function(e,t){const o={AdStarted:()=>e.onStartVpaidAd,AdStopped:()=>e.onStopVpaidAd,AdSkipped:()=>e.onSkipVpaidAd,AdLoaded:()=>e.onVpaidAdLoaded,AdLinearChange:()=>e.onVpaidAdLinearChange,AdSizeChange:()=>e.onVpaidAdSizeChange,AdExpandedChange:()=>e.onVpaidAdExpandedChange,AdSkippableStateChange:()=>e.onVpaidAdSkippableStateChange,AdDurationChange:()=>e.onVpaidAdDurationChange,AdRemainingTimeChange:()=>e.onVpaidAdRemainingTimeChange,AdVolumeChange:()=>e.onVpaidAdVolumeChange,AdImpression:()=>e.onVpaidAdImpression,AdClickThru:()=>e.onVpaidAdClickThru,AdInteraction:()=>e.onVpaidAdInteraction,AdVideoStart:()=>e.onVpaidAdVideoStart,AdVideoFirstQuartile:()=>e.onVpaidAdVideoFirstQuartile,AdVideoMidpoint:()=>e.onVpaidAdVideoMidpoint,AdVideoThirdQuartile:()=>e.onVpaidAdVideoThirdQuartile,AdVideoComplete:()=>e.onVpaidAdVideoComplete,AdUserAcceptInvitation:()=>e.onVpaidAdUserAcceptInvitation,AdUserMinimize:()=>e.onVpaidAdUserMinimize,AdUserClose:()=>e.onVpaidAdUserClose,AdPaused:()=>e.onVpaidAdPaused,AdPlaying:()=>e.onVpaidAdPlaying,AdError:()=>e.onVpaidAdError,AdLog:()=>e.onVpaidAdLog};e.checkVPAIDInterface=e=>{const t=e;return!!(t.handshakeVersion&&"function"==typeof t.handshakeVersion&&t.initAd&&"function"==typeof t.initAd&&t.startAd&&"function"==typeof t.startAd&&t.stopAd&&"function"==typeof t.stopAd&&t.skipAd&&"function"==typeof t.skipAd&&t.resizeAd&&"function"==typeof t.resizeAd&&t.pauseAd&&"function"==typeof t.pauseAd&&t.resumeAd&&"function"==typeof t.resumeAd&&t.expandAd&&"function"==typeof t.expandAd&&t.collapseAd&&"function"==typeof t.collapseAd&&t.subscribe&&"function"==typeof t.subscribe&&t.unsubscribe&&"function"==typeof t.unsubscribe)},e.onVpaidAdPaused=()=>{e.vpaidTimeoutTimerClear(),e.debugMessage("onAdPaused")},e.onVpaidAdPlaying=()=>{e.vpaidTimeoutTimerClear(),e.debugMessage("onAdPlaying")},e.onVpaidAdError=t=>{e.debugMessage("onAdError: "+t),e.vpaidTimeoutTimerClear(),e.onVpaidEnded()},e.onVpaidAdLog=t=>{e.debugMessage("onAdLog: "+t)},e.onVpaidAdUserAcceptInvitation=()=>{e.debugMessage("onAdUserAcceptInvitation")},e.onVpaidAdUserMinimize=()=>{e.debugMessage("onAdUserMinimize")},e.onVpaidAdUserClose=()=>{e.debugMessage("onAdUserClose")},e.onVpaidAdSkippableStateChange=()=>{e.vpaidAdUnit&&e.debugMessage("Ad Skippable State Changed to: "+e.vpaidAdUnit.getAdSkippableState())},e.onVpaidAdExpandedChange=()=>{e.vpaidAdUnit&&e.debugMessage("Ad Expanded Changed to: "+e.vpaidAdUnit.getAdExpanded())},e.getVpaidAdExpanded=()=>{if(e.debugMessage("getAdExpanded"),e.vpaidAdUnit)return e.vpaidAdUnit.getAdExpanded()},e.getVpaidAdSkippableState=()=>{if(e.debugMessage("getAdSkippableState"),e.vpaidAdUnit)return e.vpaidAdUnit.getAdSkippableState()},e.onVpaidAdSizeChange=()=>{e.vpaidAdUnit&&e.debugMessage("Ad size changed to: w="+e.vpaidAdUnit.getAdWidth()+" h="+e.vpaidAdUnit.getAdHeight())},e.onVpaidAdDurationChange=()=>{e.vpaidAdUnit&&e.debugMessage("Ad Duration Changed to: "+e.vpaidAdUnit.getAdDuration())},e.onVpaidAdRemainingTimeChange=()=>{e.vpaidAdUnit&&e.debugMessage("Ad Remaining Time Changed to: "+e.vpaidAdUnit.getAdRemainingTime())},e.getVpaidAdRemainingTime=()=>{if(e.debugMessage("getAdRemainingTime"),e.vpaidAdUnit)return e.vpaidAdUnit.getAdRemainingTime()},e.onVpaidAdImpression=()=>{e.debugMessage("Ad Impression"),e.trackSingleEvent("impression")},e.onVpaidAdClickThru=(t,o,r)=>{e.debugMessage("Clickthrough portion of the ad was clicked"),r&&window.open(e.vastOptions.clickthroughUrl),e.pauseVpaidAd(),e.callUris(e.vastOptions.clicktracking)},e.onVpaidAdInteraction=t=>{e.debugMessage("A non-clickthrough event has occured")},e.onVpaidAdVideoStart=()=>{e.debugMessage("Video 0% completed"),e.trackSingleEvent("start")},e.onVpaidAdVideoFirstQuartile=()=>{e.debugMessage("Video 25% completed"),e.trackSingleEvent("firstQuartile")},e.onVpaidAdVideoMidpoint=()=>{e.debugMessage("Video 50% completed"),e.trackSingleEvent("midpoint")},e.onVpaidAdVideoThirdQuartile=()=>{e.debugMessage("Video 75% completed"),e.trackSingleEvent("thirdQuartile")},e.onVpaidAdVideoComplete=()=>{e.debugMessage("Video 100% completed"),e.trackSingleEvent("complete")},e.onVpaidAdLinearChange=()=>{const t=e.domRef.wrapper.getElementsByClassName("fluid_vpaidNonLinear_ad")[0],o=e.domRef.wrapper.querySelector(".close_button"),r=t.getAttribute("adlistid");if(e.debugMessage("Ad linear has changed: "+e.vpaidAdUnit.getAdLinear()),!e.vpaidAdUnit.getAdLinear())return;e.backupMainVideoContentTime(r.split("_")[0]),e.isCurrentlyPlayingAd=!0,o&&o.remove(),t.className="fluid_vpaid_slot",e.domRef.player.loop=!1,e.domRef.player.removeAttribute("controls");const n=e.domRef.player.parentNode.getElementsByClassName("fluid_controls_currentprogress");for(let t=0;t<n.length;t++)n[t].style.backgroundColor=e.displayOptions.layoutControls.adProgressColor;e.toggleLoader(!1)},e.getVpaidAdLinear=()=>(e.debugMessage("getAdLinear"),e.vpaidAdUnit.getAdLinear()),e.isAdLinear=t=>{try{return e.getVpaidAdLinear()}catch(o){return e.debugMessage("Error calling getAdLinear(), handshake -> initAd() must be set before calling getAdLinear(). Falling back to VAST metadata: "+o),t.adType&&"linear"===t.adType.toLowerCase()}},e.startVpaidAd=()=>{e.debugMessage("startAd"),e.vpaidTimeoutTimerStart(),e.vpaidAdUnit.startAd()},e.onVpaidAdLoaded=()=>{e.debugMessage("ad has been loaded"),e.vpaidTimeoutTimerClear(),e.startVpaidAd()},e.onStartVpaidAd=()=>{e.debugMessage("Ad has started"),e.vpaidTimeoutTimerClear()},e.stopVpaidAd=()=>{e.vpaidTimeoutTimerStart(),e.vpaidAdUnit.stopAd()},e.hardStopVpaidAd=t=>{e.vpaidAdUnit&&(e.vpaidAdUnit.stopAd(),e.vpaidAdUnit=null);const o=e.domRef.wrapper.getElementsByClassName("fluid_vpaid_iframe"),r=e.domRef.wrapper.getElementsByClassName("fluid_vpaid_slot"),n=e.domRef.wrapper.getElementsByClassName("fluid_vpaidNonLinear_ad");for(let e=0;e<o.length;e++)o[e].getAttribute("adListId")!==t.id&&o[e].remove();for(let e=0;e<r.length;e++)r[e].getAttribute("adListId")!==t.id&&r[e].remove();for(let e=0;e<n.length;e++)n[e].getAttribute("adListId")!==t.id&&n[e].remove()},e.onStopVpaidAd=()=>{e.debugMessage("Ad has stopped"),e.vpaidTimeoutTimerClear(),e.onVpaidEnded()},e.onSkipVpaidAd=()=>{e.debugMessage("Ad was skipped"),e.vpaidTimeoutTimerClear(),e.onVpaidEnded()},e.skipVpaidAd=()=>{e.vpaidTimeoutTimerStart(),e.vpaidAdUnit&&(e.vpaidAdUnit.skipAd(),e.vpaidTimeoutTimerClear(),e.onVpaidEnded())},e.setVpaidAdVolume=t=>{e.vpaidAdUnit&&e.vpaidAdUnit.setAdVolume(t)},e.getVpaidAdVolume=()=>{if(e.vpaidAdUnit)return e.vpaidAdUnit.getAdVolume()},e.onVpaidAdVolumeChange=()=>{e.vpaidAdUnit&&e.debugMessage("Ad Volume has changed to - "+e.vpaidAdUnit.getAdVolume())},e.resizeVpaidAuto=()=>{if(null!==e.vastOptions&&e.vastOptions.vpaid&&e.vastOptions.linear){const t=e.domRef.player.offsetWidth,o=e.domRef.player.offsetHeight,r=e.fullscreenMode?"fullscreen":"normal";e.resizeVpaidAd(t,o,r)}},e.resizeVpaidAd=(t,o,r)=>{e.vpaidAdUnit&&e.vpaidAdUnit.resizeAd(t,o,r)},e.pauseVpaidAd=()=>{e.vpaidTimeoutTimerStart(),e.vpaidAdUnit&&e.vpaidAdUnit.pauseAd()},e.resumeVpaidAd=()=>{e.vpaidTimeoutTimerStart(),e.vpaidAdUnit&&e.vpaidAdUnit.resumeAd()},e.expandVpaidAd=()=>{e.vpaidAdUnit&&e.vpaidAdUnit.expandAd()},e.collapseVpaidAd=()=>{e.vpaidAdUnit&&e.vpaidAdUnit.collapseAd()},e.vpaidTimeoutTimerClear=()=>{e.vpaidTimer&&clearTimeout(e.vpaidTimer)},e.vpaidTimeoutTimerStart=()=>{e.vpaidTimeoutTimerClear(),e.vpaidTimer=setTimeout(function(){e.announceLocalError("901"),e.onVpaidEnded()},e.displayOptions.vastOptions.vpaidTimeout)},e.vpaidCallbackListenersAttach=()=>{for(let t in o)e.vpaidAdUnit.subscribe(o[t](),t,e)},e.vpaidCallbackListenersDetach=()=>{if(e.vpaidAdUnit)for(let t in o)e.vpaidAdUnit.unsubscribe(o[t](),t,e)},e.loadVpaid=(t,o)=>{const r=document.createElement("iframe");r.id="fp_"+t.id+"_fluid_vpaid_iframe",r.className="fluid_vpaid_iframe",r.setAttribute("adListId",t.id),r.setAttribute("frameborder","0"),e.domRef.player.parentNode.insertBefore(r,e.domRef.player.nextSibling);const n=document.createElement("script");n.src=o,r.contentWindow.document.head.append(n),e.tempVpaidCounter=0,e.getVPAIDAdInterval=setInterval(function(){if(r&&r.contentWindow){const o=r.contentWindow.getVPAIDAd;if(o&&"function"==typeof o)e.vpaidAdUnit&&e.hardStopVpaidAd(t),e.vpaidAdUnit=o(),clearInterval(e.getVPAIDAdInterval),e.checkVPAIDInterface(e.vpaidAdUnit)&&(e.isAdLinear(t)?(e.isCurrentlyPlayingAd=!0,e.switchPlayerToVpaidMode(t)):(e.debugMessage("non linear vpaid ad is loaded"),e.loadVpaidNonlinearAssets(t)));else{if(e.tempVpaidCounter++,e.tempVpaidCounter>=20)return clearInterval(e.getVPAIDAdInterval),e.rollsById[t.rollListId].error=!0,e.playMainVideoWhenVpaidFails(403),!1;e.debugMessage(e.tempVpaidCounter)}}},100),e.destructors.push(()=>clearInterval(e.getVPAIDAdInterval))},e.onVpaidEnded=t=>{if(t&&t.stopImmediatePropagation(),!e.vpaidAdUnit)return;const o=e.domRef.wrapper.querySelector(".fluid_vpaid_slot");e.vpaidCallbackListenersDetach(),e.vpaidAdUnit=null,clearInterval(e.getVPAIDAdInterval),o&&o.remove(),e.checkForNextAd()},e.playMainVideoWhenVpaidFails=t=>{const o=e.domRef.wrapper.querySelector(".fluid_vpaid_slot");o&&o.remove(),clearInterval(e.getVPAIDAdInterval),e.playMainVideoWhenVastFails(t)}},function(e,t){function o(e){for(const t of e)if(void 0===t.data.attributes.sequence)return[t];return[]}async function r(t,i){let a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,s=!(arguments.length>4&&void 0!==arguments[4])||arguments[4];var l,d,c,u;const p={...arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},children:[]},{responseXML:f}=await e.sendRequestAsync(t,!0,e.displayOptions.vastOptions.vastTimeout),m=Array.from(f.getElementsByTagName("Ad"));for(const t of m){const f=e.getVastAdTagUriFromWrapper(t),m=void 0!==t.attributes.sequence,g={data:t},h=(t.getElementsByTagName("Linear").length?"linear":t.getElementsByTagName("NonLinearAds").length&&"nonLinear")||"";if(f&&a<=i&&s){const[n]=t.getElementsByTagName("Wrapper"),s=n.attributes.followAdditionalWrappers&&["false","0"].includes(n.attributes.followAdditionalWrappers.value),l=n.attributes.allowMultipleAds&&["true","1"].includes(n.attributes.allowMultipleAds.value),d=n.attributes.fallbackOnNoAd&&["true","1"].includes(n.attributes.fallbackOnNoAd.value);try{const e=await r(f,i,{tagType:"wrapper",...g,fallbackOnNoAd:d},a+1,!s);e.fallbackOnNoAd=d,(!l||m)&&(e.children=o(e.children)),p.children.push(e)}catch(t){p.children.push({tagType:"wrapper",fallbackOnNoAd:d,httpError:!0}),e.debugMessage("Error when loading Wrapper, will trigger fallback if available",t)}}else if(!f)if("nonLinear"===h)p.children.push({tagType:"inLine",...g});else if(Array.from(t.getElementsByTagName("MediaFiles")).length){const e=null==(l=Array.from(t.getElementsByTagName("MediaFiles"))[0])?void 0:l.getElementsByTagName("MediaFile"),o=null==(d=e[0])?void 0:d.textContent.trim();("VPAID"===e[0].getAttribute("apiFramework")||await n(o))&&p.children.push({tagType:"inLine",...g})}else if(Array.from(t.getElementsByTagName("AdParameters")).length){const e=Array.from(t.getElementsByTagName("AdParameters"));for(const t of e)try{const e=JSON.parse(t.textContent.trim()),o=null!=(c=null==e?void 0:e.videos)&&c.length?null==(u=null==e?void 0:e.videos[0])?void 0:u.url:"";await n(o)&&p.children.push({tagType:"inLine",...g})}catch(e){console.error("Error parsing media file URL:",e)}}}return p}async function n(e){if(!e)return!1;try{const t=await fetch(e);if(!t.ok||-1===t.headers.get("content-type").indexOf("video"))return!1;const o=document.createElement("video");return o.src=e,""!==await o.canPlayType(t.headers.get("content-type"))}catch(e){return console.error("Failed to load media file:",e),!1}}function i(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];const o=[...arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],e.data];return Array.isArray(e.children)&&e.children.length&&e.children.forEach(e=>i(e,t,o)),"inLine"===e.tagType&&t.push({...e,wrappers:o.filter(Boolean)}),t}e.setCTAFromVast=(t,o)=>{if(e.displayOptions.vastOptions.adCTATextVast&&t){const r=e.extractNodeDataByTagName(t,"MobileText"),n=e.extractNodeDataByTagName(t,"PCText"),i=e.extractNodeDataByTagName(t,"DisplayUrl")||e.extractNodeDataByTagName(t,"Link"),a=e.extractNodeDataByTagName(t,"Tracking"),s=window.matchMedia("(max-width: 768px)").matches;(n||r)&&a&&(o.titleCTA={text:s?r||n:n||r,link:i||null,tracking:a})}},e.getClickThroughUrlFromLinear=t=>{const o=t.getElementsByTagName("VideoClicks");if(o.length){const t=o[0].getElementsByTagName("ClickThrough");if(t.length)return e.extractNodeData(t[0])}return!1},e.getVastAdTagUriFromWrapper=t=>{const o=t.getElementsByTagName("Wrapper");if(typeof o<"u"&&o.length){const t=o[0].getElementsByTagName("VASTAdTagURI");if(t.length)return e.extractNodeData(t[0])}return!1},e.hasInLine=e=>{const t=e.getElementsByTagName("InLine");return typeof t<"u"&&t.length},e.hasVastAdTagUri=e=>{const t=e.getElementsByTagName("VASTAdTagURI");return typeof t<"u"&&t.length},e.getClickThroughUrlFromNonLinear=t=>{let o="";if(t.getElementsByTagName("NonLinear").length){const r=t.getElementsByTagName("NonLinearClickThrough");r.length&&(o=e.extractNodeData(r[0]))}return o},e.getTrackingFromLinear=e=>{const t=e.getElementsByTagName("TrackingEvents");return t.length?t[0].getElementsByTagName("Tracking"):[]},e.getDurationFromLinear=t=>{const o=t.getElementsByTagName("Duration");if(o.length&&typeof o[0].childNodes[0]<"u"){const t=e.extractNodeData(o[0]);return e.convertTimeStringToSeconds(t)}return!1},e.getDurationFromNonLinear=t=>{let o=0;const r=t.getElementsByTagName("NonLinear");return r.length&&typeof r[0].getAttribute("minSuggestedDuration")<"u"&&(o=e.convertTimeStringToSeconds(r[0].getAttribute("minSuggestedDuration"))),o},e.getDimensionFromNonLinear=e=>{const t={width:null,height:null},o=e.getElementsByTagName("NonLinear");return o.length&&(typeof o[0].getAttribute("width")<"u"&&(t.width=o[0].getAttribute("width")),typeof o[0].getAttribute("height")<"u"&&(t.height=o[0].getAttribute("height"))),t},e.getCreativeTypeFromStaticResources=e=>{let t="";const o=e.getElementsByTagName("NonLinear");return o.length&&typeof o[0].childNodes[0]<"u"&&(t=o[0].getElementsByTagName("StaticResource")[0].getAttribute("creativeType")),t.toLowerCase()},e.getMediaFilesFromLinear=e=>{const t=e.getElementsByTagName("MediaFiles");return t.length?t[0].getElementsByTagName("MediaFile"):[]},e.getStaticResourcesFromNonLinear=e=>{let t=[];const o=e.getElementsByTagName("NonLinear");return o.length&&(t=o[0].getElementsByTagName("StaticResource")),t},e.extractNodeDataByTagName=(t,o)=>{const r=t.getElementsByTagName(o);return r&&r.length?e.extractNodeData(r[0]):null},e.extractNodeData=e=>{let t="";for(let o=0;o<e.childNodes.length;o++){const r=e.childNodes[o];8===r.nodeType||3===r.nodeType&&/^\s*$/.test(r.nodeValue)||(t+=r.nodeValue)}return t.replace(/(^\s+|\s+$)/g,"")},e.getAdParametersFromLinear=t=>{const o=t.getElementsByTagName("AdParameters");let r=null;return o.length&&(r=e.extractNodeData(o[0])),r},e.getMediaFileListFromLinear=t=>{const o=[],r=e.getMediaFilesFromLinear(t);if(!r.length)return o;for(let t=0;t<r.length;t++){let n=r[t].getAttribute("mediaType");n||(n="2D"),o.push({src:e.extractNodeData(r[t]),type:r[t].getAttribute("type"),apiFramework:r[t].getAttribute("apiFramework"),codec:r[t].getAttribute("codec"),id:r[t].getAttribute("codec"),fileSize:r[t].getAttribute("fileSize"),delivery:r[t].getAttribute("delivery"),width:r[t].getAttribute("width"),height:r[t].getAttribute("height"),mediaType:n.toLowerCase()})}return o},e.getIconClickThroughFromLinear=t=>{const o=t.getElementsByTagName("IconClickThrough");return o.length?e.extractNodeData(o[0]):""},e.getStaticResourceFromNonLinear=t=>{let o;const r=e.getStaticResourcesFromNonLinear(t);for(let t=0;t<r.length;t++)if(r[t].getAttribute("type")||(o=e.extractNodeData(r[t])),r[t].getAttribute("type")===e.displayOptions.staticResource)return e.extractNodeData(r[t]);return o},e.registerTrackingEvents=(t,o)=>{const r=e.getTrackingFromLinear(t);let n="",i=0;for(let t=0;t<r.length;t++)switch(n=r[t].getAttribute("event"),n){case"start":case"firstQuartile":case"midpoint":case"thirdQuartile":case"complete":typeof o.tracking[n]>"u"&&(o.tracking[n]=[]),typeof o.stopTracking[n]>"u"&&(o.stopTracking[n]=[]),o.tracking[n].push(r[t].textContent.trim()),o.stopTracking[n]=!1;break;case"progress":typeof o.tracking[n]>"u"&&(o.tracking[n]=[]),i=e.convertTimeStringToSeconds(r[t].getAttribute("offset")),typeof o.tracking[n][i]>"u"&&(o.tracking[n][i]={elements:[],stopTracking:!1}),o.tracking[n][i].elements.push(r[t].textContent.trim())}},e.registerClickTracking=(e,t)=>{if(e&&e.length)for(let o=0;o<e.length;o++)""!==e[o]&&t.clicktracking.push(e[o])},e.registerViewableImpressionEvents=(t,o)=>{if(t.length)for(let r=0;r<t.length;r++){const n=e.extractNodeData(t[r]);o.viewImpression.push(n)}},e.registerImpressionEvents=(t,o)=>{if(t.length)for(let r=0;r<t.length;r++){const n=e.extractNodeData(t[r]);o.impression.push(n)}},e.registerErrorEvents=(e,t)=>{typeof e<"u"&&null!==e&&1===e.length&&1===e[0].childNodes.length&&(t.errorUrl=e[0].childNodes[0].nodeValue)},e.announceError=t=>{if(typeof e.vastOptions.errorUrl>"u"||!e.vastOptions.errorUrl)return;const o=typeof t<"u"?parseInt(t):900,r=e.vastOptions.errorUrl.replace("[ERRORCODE]",o);e.callUris([r])},e.getClickTrackingEvents=t=>{const o=[],r=t.getElementsByTagName("VideoClicks");if(!r.length)return;const n=r[0].getElementsByTagName("ClickTracking");if(n.length){for(let t=0;t<n.length;t++){const r=e.extractNodeData(n[t]);o.push(r)}return o}},e.getNonLinearClickTrackingEvents=t=>{const o=[];if(!t.getElementsByTagName("NonLinear").length)return;const r=t.getElementsByTagName("NonLinearClickTracking");if(r.length){for(let t=0;t<r.length;t++){const n=e.extractNodeData(r[t]);o.push(n)}return o}},e.callUris=e=>{for(let t=0;t<e.length;t++)(new Image).src=e[t]},e.recalculateAdDimensions=()=>{const t=e.domRef.player,o=e.domRef.wrapper.querySelector(".vast_clickthrough_layer");o&&(o.style.width=t.offsetWidth+"px",o.style.height=t.offsetHeight+"px");const r=e.checkFullscreenSupport(),n=e.domRef.wrapper.querySelector(".fluid_control_fullscreen"),i=e.domRef.wrapper.querySelector(".context_option_fullscreen");if(r)null===document[r.isFullscreen]?e.fullscreenOff(n,i):e.fullscreenOn(n,i);else{const t=e.domRef.wrapper;-1!==t.className.search(/\bpseudo_fullscreen\b/g)?(t.className+=" pseudo_fullscreen",e.fullscreenOn(n,i)):(t.className=t.className.replace(/\bpseudo_fullscreen\b/g,""),e.fullscreenOff(n,i))}},e.prepareVast=t=>{let o=e.findRoll(t);for(let t=0;t<o.length;t++){const r=o[t];!0!==e.rollsById[r].vastLoaded&&!0!==e.rollsById[r].error&&e.processVastWithRetries(e.rollsById[r])}},e.playMainVideoWhenVastFails=t=>{e.debugMessage("playMainVideoWhenVastFails called"),e.domRef.player.removeEventListener("loadedmetadata",e.switchPlayerToVastMode),e.domRef.player.pause(),e.toggleLoader(!1),e.displayOptions.vastOptions.vastAdvanced.noVastVideoCallback(),!e.vastOptions||typeof e.vastOptions.errorUrl>"u"?e.announceLocalError(t):e.announceError(t),e.switchToMainVideo()},e.switchPlayerToVastMode=()=>{},e.processVastWithRetries=t=>{let o=t.vastTag;const r=t.id;e.domRef.player.addEventListener("adId_"+r,e[t.roll]);const n=function(i,a){if(i&&Array.isArray(a)&&!e.displayOptions.vastOptions.allowVPAID&&a.some(e=>e.vpaid)&&(a=a.filter(e=>!0!==e.vpaid),e.announceLocalError("103","VPAID not allowed, so skipping this VAST tag.")),i&&Array.isArray(a)&&a.length){e.adPool[r]=[],a.forEach((t,o)=>{if(t.id=r+"_AD"+o,t.rollListId=r,"linear"===t.adType){typeof t.iconClick<"u"&&null!==t.iconClick&&t.iconClick.length&&(t.landingPage=t.iconClick);const o=e.getSupportedMediaFileObject(t.mediaFileList);o&&(t.mediaType=o.mediaType)}if(t.adType=t.adType?t.adType:"unknown",e.adPool[r].push(Object.assign({},t)),e.hasTitle()){e.domRef.wrapper.querySelector(".fp_title").style.display="none"}e.rollsById[r].ads.push(t)}),e.rollsById[r].vastLoaded=!0;const t=document.createEvent("Event");t.initEvent("adId_"+r,!1,!0),e.domRef.player.dispatchEvent(t),e.displayOptions.vastOptions.vastAdvanced.vastLoadedCallback()}else e.announceLocalError("101"),t.hasOwnProperty("fallbackVastTags")&&t.fallbackVastTags.length>0?(o=t.fallbackVastTags.shift(),e.processUrl(o,n,r)):("preRoll"===t.roll&&e.preRollFail(t),e.rollsById[r].error=!0)};e.processUrl(o,n,r)},e.processUrl=(t,o,r)=>{e.resolveVastTag(t,0,{tracking:[],stopTracking:[],impression:[],viewImpression:[],clicktracking:[],vastLoaded:!1},o,r)},e.resolveVastTag=(t,o,n,a,s)=>{if(!t||""===t)return a(!1);r(t,e.displayOptions.vastOptions.maxAllowedVastTagRedirects).then(t=>{try{const o=t.children.some(e=>"wrapper"===e.tagType&&e.fallbackOnNoAd&&(!/"tagType":"ad"/.test(JSON.stringify(e))||e.httpError));o&&e.debugMessage("Error on VAST Wrapper, triggering fallbackOnNoAd. Ad tree:",t),t=i(t).map(t=>function(t){var o,r,n,i,a,s,l,d;const c=t.data;if(!c)return;const u=Array.from(c.getElementsByTagName("Creative"));if(u.length)for(let p=0;p<u.length;p++){const f=u[p];try{if("linear"===t.adType){const u=f.getElementsByTagName("Linear")[0];if(!e.hasVastAdTagUri(c)&&e.hasInLine(c))if(t.adFinished=!1,t.vpaid=!1,t.skipoffset=e.convertTimeStringToSeconds(u.getAttribute("skipoffset")),t.clickthroughUrl=e.getClickThroughUrlFromLinear(u),t.duration=e.getDurationFromLinear(u),t.mediaFileList=e.getMediaFileListFromLinear(u),t.adParameters=e.getAdParametersFromLinear(u),t.iconClick=t.iconClick||e.getIconClickThroughFromLinear(u),null!=(o=null==t?void 0:t.mediaFileList)&&o.length&&"VPAID"===(null==(r=t.mediaFileList[0])?void 0:r.apiFramework))t.vpaid=!0;else if((null==(n=null==t?void 0:t.mediaFileList)||!n.length)&&null!=t&&t.adParameters){try{const e=JSON.parse(null==(i=null==t?void 0:t.adParameters)?void 0:i.trim());e&&(t.mediaFileList=[{src:null!=(a=null==e?void 0:e.videos)&&a.length?null==(s=null==e?void 0:e.videos[0])?void 0:s.url:"",type:null!=(l=null==e?void 0:e.videos)&&l.length?null==(d=null==e?void 0:e.videos[0])?void 0:d.mimetype:""}])}catch(e){console.error("Error parsing media file URL:",e)}t.adParameters=null}}if("nonLinear"===t.adType){const o=f.getElementsByTagName("NonLinearAds")[0];!e.hasVastAdTagUri(c)&&e.hasInLine(c)&&(t.vpaid=!1,t.clickthroughUrl=e.getClickThroughUrlFromNonLinear(o),t.duration=e.getDurationFromNonLinear(o),t.dimension=e.getDimensionFromNonLinear(o),t.staticResource=e.getStaticResourceFromNonLinear(o),t.creativeType=e.getCreativeTypeFromStaticResources(o),t.adParameters=e.getAdParametersFromLinear(o),t.adParameters&&(t.vpaid=!0))}break}catch(e){f.firstElementChild&&!("Linear"===f.firstElementChild.tagName||"NonLinearAds"===f.firstElementChild.tagName)&&console.warn("Skipping "+f.firstElementChild.tagName+", this might not be supported yet."),console.error(e)}}return t}(function(t,o){const r={...t,...JSON.parse(JSON.stringify(o))};return r.adType=(r.data.getElementsByTagName("Linear").length?"linear":r.data.getElementsByTagName("NonLinearAds").length&&"nonLinear")||"unknown",[...r.wrappers||[],r.data].filter(Boolean).forEach(t=>{const o=t.getElementsByTagName("Impression");null!==o&&e.registerImpressionEvents(o,r);const n=t.getElementsByTagName("Viewable");null!==n&&e.registerViewableImpressionEvents(n,r);const i=t.getElementsByTagName("Error");null!==i&&e.registerErrorEvents(i,r);const[a]=t.getElementsByTagName("TitleCTA");a&&e.setCTAFromVast(a,r),e.registerTrackingEvents(t,r);const s="linear"===r.adType?e.getClickTrackingEvents(t):e.getNonLinearClickTrackingEvents(t);e.registerClickTracking(s,r)}),r.sequence=r.data.attributes.sequence?Number(r.data.attributes.sequence.value):null,r.played=!1,r}(t,n)));const r=function(t,o,r,n){const{adPod:i}=t.filter(e=>!!e.sequence).sort((e,t)=>e.sequence-t.sequence).reduce((e,t)=>(e.adPod.length<r&&e.totalDuration+t.duration<=o&&e.adPod.push(t),e),{adPod:[],totalDuration:0}),a=t.filter(e=>!e.sequence&&e.duration<o),s=i.map(e=>e.adType).slice(0,-1).every(e=>"linear"===e);return i.length>0&&!n&&s?(e.debugMessage("Playing valid adPod",i),i):(e.debugMessage("Trying to play single ad, adBuffet:",a),a.length>0?[a[0]]:[])}(t,e.rollsById[s].maxTotalDuration||Number.MAX_SAFE_INTEGER,e.rollsById[s].maxTotalQuantity||Number.MAX_SAFE_INTEGER,o);r&&r.length?a(!0,r):a(!1)}catch{a(!1)}}).catch(()=>a(!1))},e.setVastList=()=>{const t={},o={preRoll:[],postRoll:[],midRoll:[],onPauseRoll:[]},r={id:null,roll:null,vastLoaded:!1,error:!1,adText:null,adTextPosition:null};let n=0;const i=function(e){let t=!1;return"midRoll"===e.roll&&typeof e.timer>"u"&&(t=!0),t},a=function(t){let o=!1;return t.vastTag||(e.announceLocalError(102,'"vastTag" property is missing from adList.'),o=!0),t.roll||(e.announceLocalError(102,'"roll" is missing from adList.'),o=!0),-1===e.availableRolls.indexOf(t.roll)&&(e.announceLocalError(102,"Only "+e.availableRolls.join(",")+" rolls are supported."),o=!0),t.size&&-1===e.supportedNonLinearAd.indexOf(t.size)&&(e.announceLocalError(102,"Only "+e.supportedNonLinearAd.join(",")+" size are supported."),o=!0),o};if(e.displayOptions.vastOptions.hasOwnProperty("adList"))for(let o in e.displayOptions.vastOptions.adList){let s=e.displayOptions.vastOptions.adList[o];if(a(s)){e.announceLocalError(102,"Wrong adList parameters.");continue}const l="ID"+n;t[l]=Object.assign({},r),t[l]=Object.assign(t[l],e.displayOptions.vastOptions.adList[o]),"midRoll"===s.roll&&(t[l].error=i("midRoll")),t[l].id=l,t[l].ads=[],n++}Object.keys(t).map(function(e){switch(t[e].roll.toLowerCase()){case"preRoll".toLowerCase():o.preRoll.push(t[e]);break;case"midRoll".toLowerCase():o.midRoll.push(t[e]);break;case"postRoll".toLowerCase():o.postRoll.push(t[e]);break;case"onPauseRoll".toLowerCase():o.onPauseRoll.push(t[e]);break;default:console.error(`${t[e].roll.toLowerCase()} is not a recognized roll`)}}),e.adGroupedByRolls=o,e.rollsById=t},e.onVastAdEnded=t=>{t&&t.stopImmediatePropagation(),e.vastOptions.adFinished=!0,e.deleteVastAdElements(),e.checkForNextAd()},e.vastLogoBehaviour=t=>{if(!e.displayOptions.layoutControls.logo.showOverAds){const o=e.domRef.wrapper.querySelector(".logo_holder");if(!o)return;o.style.display=t?"none":"inline"}},e.deleteVastAdElements=()=>{e.removeClickthrough(),e.removeSkipButton(),e.removeAdCountdown(),e.removeAdPlayingText(),e.removeCTAButton(),e.vastLogoBehaviour(!1)}},function(e,t){function o(){e.vrViewer.onWindowResize()}e.createCardboardJoystickButton=t=>{const o=e.domRef.wrapper.querySelector(".fluid_vr_joystick_panel"),r=document.createElement("div");return r.className="fluid_vr_button fluid_vr_joystick_"+t,o.appendChild(r),r},e.cardboardRotateLeftRight=t=>{const o=e.vrROTATION_POSITION,r=-e.vrROTATION_POSITION,n={val:t<1?o:r};new TWEEN.Tween(n).to({val:0},e.vrROTATION_SPEED).easing(TWEEN.Easing.Quadratic.InOut).onUpdate(function(){e.vrViewer.OrbitControls.rotateLeft(n.val)}).start()},e.cardboardRotateUpDown=t=>{const o=e.vrROTATION_POSITION,r=-e.vrROTATION_POSITION,n={val:t<1?o:r};new TWEEN.Tween(n).to({val:0},e.vrROTATION_SPEED).easing(TWEEN.Easing.Quadratic.InOut).onUpdate(function(){e.vrViewer.OrbitControls.rotateUp(n.val)}).start()},e.createCardboardJoystick=()=>{const t=e.domRef.wrapper.querySelector(".fluid_vr_container"),o=document.createElement("div");o.className="fluid_vr_joystick_panel",t.appendChild(o);const r=e.createCardboardJoystickButton("up"),n=e.createCardboardJoystickButton("left"),i=e.createCardboardJoystickButton("right"),a=e.createCardboardJoystickButton("down"),s=e.createCardboardJoystickButton("zoomdefault"),l=e.createCardboardJoystickButton("zoomin"),d=e.createCardboardJoystickButton("zoomout");r.addEventListener("click",function(){e.cardboardRotateUpDown(1)}),a.addEventListener("click",function(){e.cardboardRotateUpDown(0)}),i.addEventListener("click",function(){e.cardboardRotateLeftRight(0)}),n.addEventListener("click",function(){e.cardboardRotateLeftRight(1)}),s.addEventListener("click",function(){e.vrViewer.camera.fov=60,e.vrViewer.camera.updateProjectionMatrix()}),d.addEventListener("click",function(){e.vrViewer.camera.fov*=1.1,e.vrViewer.camera.updateProjectionMatrix()}),l.addEventListener("click",function(){e.vrViewer.camera.fov*=.9,e.vrViewer.camera.updateProjectionMatrix()})},e.cardBoardResize=()=>{e.domRef.player.removeEventListener("theatreModeOn",o),e.domRef.player.addEventListener("theatreModeOn",o),e.domRef.player.removeEventListener("theatreModeOff",o),e.domRef.player.addEventListener("theatreModeOff",o)},e.cardBoardSwitchToNormal=()=>{const t=e.domRef.wrapper.querySelector(".fluid_vr_joystick_panel"),o=e.domRef.player;let r=o.parentNode.getElementsByClassName("fluid_controls_container");e.vrViewer.enableEffect(PANOLENS.MODES.NORMAL),e.vrViewer.onWindowResize(),e.vrMode=!1;const n=Array.from(r),i=n.findIndex(e=>e.classList.contains("fluid_vr2_controls_container"));if(-1!==i){const e=r[i],t=n.find((e,t)=>t!==i);o.parentNode.removeChild(e),null==t||t.classList.remove("fluid_vr_controls_container")}e.displayOptions.layoutControls.showCardBoardJoystick&&t&&(t.style.display="block");e.domRef.wrapper.querySelector(".fluid_control_volume_container").style.display="block";const a=e.domRef.wrapper.querySelector(".ad_countdown"),s=e.domRef.wrapper.querySelector(".fluid_ad_cta"),l=e.domRef.wrapper.querySelector(".fluid_ad_playing"),d=e.domRef.wrapper.querySelector(".skip_button");a&&(a.style.display="block"),s&&(s.style.display="block"),l&&(l.style.display="block"),d&&(d.style.display="block")},e.cardBoardHideDefaultControls=()=>{const t=e.domRef.wrapper.querySelector(".fluid_vr_joystick_panel"),o=e.domRef.wrapper.querySelector(".fluid_initial_play"),r=e.domRef.wrapper.querySelector(".fluid_control_volume_container");e.displayOptions.layoutControls.showCardBoardJoystick&&t&&(t.style.display="none"),o&&(e.domRef.wrapper.querySelector(".fluid_initial_play").style.display="none",e.domRef.wrapper.querySelector(".fluid_initial_play_button_container").style.opacity="1"),r.style.display="none"},e.cardBoardCreateVRControls=()=>{const t=e.domRef.wrapper.querySelector(".fluid_controls_container").cloneNode(!0);t.removeAttribute("id"),t.querySelectorAll("*").forEach(function(e){e.removeAttribute("id")}),t.classList.add("fluid_vr2_controls_container"),e.domRef.player.parentNode.insertBefore(t,e.domRef.player.nextSibling),e.copyEvents(t)},e.cardBoardSwitchToVR=()=>{const t=e.domRef.wrapper.querySelector(".fluid_controls_container");e.vrViewer.enableEffect(PANOLENS.MODES.CARDBOARD),e.vrViewer.onWindowResize(),e.vrViewer.disableReticleControl(),e.vrMode=!0,t.classList.add("fluid_vr_controls_container"),e.cardBoardHideDefaultControls(),e.cardBoardCreateVRControls();const o=e.domRef.wrapper.querySelector(".ad_countdown"),r=e.domRef.wrapper.querySelector(".fluid_ad_cta"),n=e.domRef.wrapper.querySelector(".fluid_ad_playing"),i=e.domRef.wrapper.querySelector(".skip_button");o&&(o.style.display="none"),r&&(r.style.display="none"),n&&(n.style.display="none"),i&&(i.style.display="none")},e.cardBoardMoveTimeInfo=()=>{const t=e.domRef.wrapper.querySelector(".fluid_control_duration"),o=e.domRef.wrapper.querySelector(".fluid_controls_container");t.classList.add("cardboard_time"),o.appendChild(t),e.controlDurationUpdate=function(){const t=e.formatTime(e.domRef.player.currentTime),o=e.formatTime(e.currentVideoDuration),r=e.domRef.player.parentNode.getElementsByClassName("fluid_control_duration");let n="";if(e.isCurrentlyPlayingAd){n="<span class='ad_timer_prefix'>AD : </span>"+t+" / "+o;for(let e=0;e<r.length;e++)r[e].classList.add("ad_timer_prefix")}else{n=t+" / "+o;for(let e=0;e<r.length;e++)r[e].classList.remove("ad_timer_prefix")}for(let e=0;e<r.length;e++)r[e].innerHTML=n}},e.cardBoardAlterDefaultControls=()=>{e.cardBoardMoveTimeInfo()},e.createCardboardView=()=>{const t=document.createElement("div");t.className="fluid_vr_container",e.domRef.player.parentNode.insertBefore(t,e.domRef.player.nextSibling),PANOLENS.VideoPanorama.prototype.pauseVideo=function(){},PANOLENS.VideoPanorama.prototype.playVideo=function(){},e.vrPanorama=new PANOLENS.VideoPanorama("",{videoElement:e.domRef.player,autoplay:e.displayOptions.layoutControls.autoPlay,loop:!!e.displayOptions.layoutControls.loop}),e.vrViewer=new PANOLENS.Viewer({container:t,controlBar:!0,controlButtons:[],enableReticle:!1}),e.vrViewer.add(e.vrPanorama),e.vrViewer.enableEffect(PANOLENS.MODES.NORMAL),e.vrViewer.onWindowResize(),("Android"===e.getMobileOs().userOs||"iOS"===e.getMobileOs().userOs)&&e.vrViewer.enableControl(1),e.cardBoardAlterDefaultControls(),e.cardBoardResize(),e.vrViewer.initialCameraPosition=JSON.parse(JSON.stringify(e.vrViewer.camera.position)),e.displayOptions.layoutControls.showCardBoardJoystick&&("Android"===e.getMobileOs().userOs||"iOS"===e.getMobileOs().userOs||e.createCardboardJoystick(),e.vrViewer.OrbitControls.noZoom=!0),e.trackEvent(e.domRef.player.parentNode,"click",".fluid_control_cardboard",function(){e.vrMode?e.cardBoardSwitchToNormal():e.cardBoardSwitchToVR()})},e.createCardboard=()=>{e.displayOptions.layoutControls.showCardBoardView&&(e.domRef.wrapper.querySelector(".fluid_control_cardboard").style.display="inline-block",window.PANOLENS?e.createCardboardView():import("./panolens.module-CQZEyBjm.mjs").then(t=>{window.PANOLENS=t,e.createCardboardView()}))}},function(e,t){function o(t){const o=e.domRef.wrapper.querySelector(".fluid_control_subtitles");let r=!1;for(let e=0;e<o.children.length;e++)"block"===o.children[e].style.display&&(r=!0,o.children[e].style.display="none");r||e.openCloseSubtitlesSwitch()}function r(){e.renderSubtitles()}e.subtitleSizeLevels=[50,75,100,150,200],e.currentSubtitleSizeIndex=e.subtitleSizeLevels.indexOf(100),e.subtitleFetchParse=t=>{e.sendRequest(t.url,!1,e.displayOptions.vastOptions.vastTimeout,function(){const t=this;if(4===t.readyState&&200!==t.status||4!==t.readyState||200!==t.status)return;const o=t.responseText,r=new WebVTT.Parser(window,WebVTT.StringDecoder()),n=[];r.oncue=function(e){n.push(e)},r.onregion=function(e){},r.parse(o),r.flush(),e.subtitlesData=n})},e.createSubtitlesSwitch=()=>{const t="OFF";if(e.subtitlesData=[],!e.displayOptions.layoutControls.subtitlesEnabled)return void(e.domRef.wrapper.querySelector(".fluid_control_subtitles").style.display="none");const n=[];n.push({label:t,url:"na",lang:t});const i=e.domRef.player.querySelectorAll("track");[].forEach.call(i,function(e){"metadata"===e.kind&&e.src&&n.push({label:e.label,url:e.src,lang:e.srclang,default:e.default})}),e.subtitlesTracks=n;const a=e.domRef.wrapper.querySelector(".fluid_control_subtitles");a.style.display="inline-block";let s=!1;const l=document.createElement("div");l.className="fluid_subtitles_list",l.style.display="none",e.addSubtitleSizeControls(l,a);let d=!1;const c=!!e.subtitlesTracks.find(e=>e.default);e.subtitlesTracks.forEach(function(o){let r="";const n=e.displayOptions.layoutControls.subtitlesOnByDefault;(!d&&(n&&o.default||!c&&o.label!==t||1===e.subtitlesTracks.length)||!n&&o.label===t)&&(r="subtitle_selected",e.subtitleFetchParse(o),d=!0);const i=document.createElement("div");i.className="fluid_subtitle_list_item",i.innerHTML='<span class="subtitle_button_icon '+r+'"></span>'+o.label,i.addEventListener("click",function(o){o.stopPropagation();const r=this,n=e.domRef.wrapper.getElementsByClassName("subtitle_button_icon");for(let e=0;e<n.length;e++)n[e].className=n[e].className.replace("subtitle_selected","");r.firstChild.className+=" subtitle_selected",e.subtitlesTracks.forEach(function(o){o.label===r.innerText.replace(/(\r\n\t|\n|\r\t)/gm,"")&&(o.label===t?e.subtitlesData=[]:e.subtitleFetchParse(o))}),e.openCloseSubtitlesSwitch()}),l.appendChild(i),s=!0}),s?(a.appendChild(l),a.removeEventListener("click",o),a.addEventListener("click",o)):e.domRef.wrapper.querySelector(".fluid_control_subtitles").style.display="none",e.domRef.player.removeEventListener("timeupdate",r),e.domRef.player.addEventListener("timeupdate",r)},e.addSubtitleSizeControls=(t,o)=>{const r=e.createSubtitleSizeButton(),n=e.createSubtitleSizeMenu();n.style.display="none",t.appendChild(r),o.appendChild(n)},e.renderSubtitles=()=>{const t=e.domRef.player;let o=Math.floor(t.currentTime),r=!1,n=e.domRef.wrapper.querySelector(".fluid_subtitles_container");if(e.isCurrentlyPlayingAd)n.innerHTML="";else{for(let t=0;t<e.subtitlesData.length;t++)o>=e.subtitlesData[t].startTime&&o<=e.subtitlesData[t].endTime&&(n.innerHTML="",n.appendChild(WebVTT.convertCueToDOMTree(window,e.subtitlesData[t].text)),r=!0);r||(n.innerHTML="")}},e.openCloseSubtitlesSwitch=()=>{const t=e.domRef.wrapper.querySelector(".fluid_subtitles_list");if(e.isCurrentlyPlayingAd)t.style.display="none";else{if("none"===t.style.display){t.style.display="block";const e=function(o){t.removeEventListener("mouseleave",e),t.style.display="none"};t.addEventListener("mouseleave",e)}else t.style.display="none";e.setMenusMaxHeight()}},e.createSubtitles=()=>{const t=document.createElement("div");t.className="fluid_subtitles_container",e.domRef.player.parentNode.insertBefore(t,e.domRef.player.nextSibling),e.displayOptions.layoutControls.subtitlesEnabled&&import("./browser-index-BSAwA-zx.mjs").then(e=>e.b).then(t=>{window.WebVTT=t.WebVTT||t.default.WebVTT,e.createSubtitlesSwitch()})},e.resizeSubtitles=t=>{const o=t/100;e.domRef.wrapper.querySelector(".fluid_subtitles_container").style.fontSize=`${o}em`},e.adjustSubtitleSizeByOperation=t=>{if("+"===t&&e.currentSubtitleSizeIndex<e.subtitleSizeLevels.length-1)e.currentSubtitleSizeIndex++;else{if(!("-"===t&&e.currentSubtitleSizeIndex>0))return;e.currentSubtitleSizeIndex--}const o=e.subtitleSizeLevels[e.currentSubtitleSizeIndex];e.resizeSubtitles(o),e.updateSubtitleSizeMenuSelection()},e.updateSubtitleSizeMenuSelection=()=>{const t=e.domRef.wrapper.querySelector(".fluid_subtitle_size_menu");if(!t)return;const o=t.querySelectorAll(".subtitle_button_icon");for(let e=0;e<o.length;e++)o[e].className=o[e].className.replace("subtitle_size_selected","");const r=Array.from(t.querySelectorAll(".fluid_subtitle_size_button")).filter(e=>!e.classList.contains("fluid_sub_menu_button"));if(r[e.currentSubtitleSizeIndex]){const t=r[e.currentSubtitleSizeIndex].querySelector(".subtitle_button_icon");t&&(t.className+=" subtitle_size_selected")}},e.createSubtitleSizeButton=()=>{const t=document.createElement("div");return t.className="fluid_subtitle_list_item fluid_sub_menu_button arrow-right",t.innerHTML="Font Size",t.addEventListener("click",t=>{t.stopPropagation(),e.toggleSubtitleSizeMenu(),e.openCloseSubtitlesSwitch()}),t},e.createSubtitleSizeMenu=()=>{const t=document.createElement("div");t.className="fluid_subtitle_size_menu";const o=e.createBackButtonForSubtitleSizeMenu();return t.appendChild(o),e.subtitleSizeLevels.forEach((o,r)=>{const n=document.createElement("div");n.className="fluid_subtitle_size_button";const i=100===o;n.innerHTML='<span class="subtitle_button_icon '+(i?"subtitle_size_selected":"")+'"></span>'+o+"%",n.addEventListener("click",t=>{t.stopPropagation(),e.toggleSubtitleSizeMenu(),e.resizeSubtitles(o),e.currentSubtitleSizeIndex=r,e.updateSubtitleSizeMenuSelection()}),t.appendChild(n)}),t},e.createBackButtonForSubtitleSizeMenu=()=>{const t=document.createElement("div");return t.className="fluid_subtitle_size_button fluid_sub_menu_button arrow-left",t.innerHTML="Font Size",t.addEventListener("click",t=>{t.stopPropagation(),e.toggleSubtitleSizeMenu(),e.openCloseSubtitlesSwitch()}),t},e.toggleSubtitleSizeMenu=()=>{const t=e.domRef.wrapper.querySelector(".fluid_subtitle_size_menu"),o=function(e){t.removeEventListener("mouseleave",o),t.style.display="none"};"block"===t.style.display?(t.style.display="none",t.removeEventListener("mouseleave",o)):(t.style.display="block",t.addEventListener("mouseleave",o)),e.setMenusMaxHeight()},e.setMenusMaxHeight=()=>{const t=e.domRef.wrapper.offsetHeight-e.domRef.wrapper.querySelector(".fluid_controls_container").offsetHeight,o=e.domRef.wrapper.querySelector(".fluid_subtitle_size_menu"),r=e.domRef.wrapper.querySelector(".fluid_subtitles_list");o.style.maxHeight=`${t}px`,r.style.maxHeight=`${t}px`},e.repositionSubtitlesContainer=t=>{e.domRef.wrapper.querySelector(".fluid_subtitles_container").style.bottom=t}},function(e,t){e.setupThumbnailPreviewVtt=()=>{e.sendRequest(e.displayOptions.layoutControls.timelinePreview.file,!1,e.displayOptions.vastOptions.vastTimeout,function(){const t=this;if(4===t.readyState&&200!==t.status||4!==t.readyState||200!==t.status)return;const o=t.responseText,r=(new window.WebVTTParser).parse(o);e.timelinePreviewData=function(t){if(!(typeof t.cues<"u"&&t.cues.length))return[];const o=[];let r=null,n=null;for(let i=0;i<t.cues.length;i++){r=t.cues[i].text.split("#");let a,s=0,l=0,d=122.5,c=69;2===r.length&&0===r[1].indexOf("xywh=")&&(n=r[1].substring(5),n=n.split(","),4===n.length&&(e.displayOptions.layoutControls.timelinePreview.spriteImage=!0,s=parseInt(n[0]),l=parseInt(n[1]),d=parseInt(n[2]),c=parseInt(n[3]))),e.displayOptions.layoutControls.timelinePreview.spriteRelativePath&&-1!==e.displayOptions.layoutControls.timelinePreview.file.indexOf("/")&&(typeof e.displayOptions.layoutControls.timelinePreview.sprite>"u"||""===e.displayOptions.layoutControls.timelinePreview.sprite)?(a=e.displayOptions.layoutControls.timelinePreview.file.substring(0,e.displayOptions.layoutControls.timelinePreview.file.lastIndexOf("/")),a+="/"+r[0]):a=e.displayOptions.layoutControls.timelinePreview.sprite?e.displayOptions.layoutControls.timelinePreview.sprite:r[0],o.push({startTime:t.cues[i].startTime,endTime:t.cues[i].endTime,image:a,x:s,y:l,w:d,h:c})}return o}(r)})},e.generateTimelinePreviewTags=()=>{const t=e.domRef.wrapper.querySelector(".fluid_controls_progress_container"),o=document.createElement("div");o.className="fluid_timeline_preview_container",o.style.display="none",o.style.position="absolute",t.appendChild(o);const r=document.createElement("div");r.className="fluid_timeline_preview_container_shadow",r.style.position="absolute",r.style.display="none",r.style.opacity=1,t.appendChild(r)},e.getThumbnailCoordinates=t=>{if(e.timelinePreviewData.length)for(let o=0;o<e.timelinePreviewData.length;o++)if(t>=e.timelinePreviewData[o].startTime&&t<=e.timelinePreviewData[o].endTime)return e.timelinePreviewData[o];return!1},e.drawTimelinePreview=t=>{const o=e.domRef.wrapper.querySelector(".fluid_timeline_preview_container"),r=e.domRef.wrapper.querySelector(".fluid_timeline_preview_container_shadow"),n=e.domRef.wrapper.querySelector(".fluid_controls_progress_container"),i=n.clientWidth;if(e.isCurrentlyPlayingAd)return void("none"!==o.style.display&&(o.style.display="none"));const a=e.getEventOffsetX(t,n);let s=null;if(i){s=e.currentVideoDuration*a/i;const t=e.getThumbnailCoordinates(s);r.style.width=i+"px",r.style.display="block",!1!==t?(o.style.width=t.w+"px",o.style.height=t.h+"px",r.style.height=t.h+"px",o.style.background="url("+t.image+") no-repeat scroll -"+t.x+"px -"+t.y+"px",o.style.left=a-t.w/2+"px",o.style.display="block",e.displayOptions.layoutControls.timelinePreview.spriteImage||(o.style.backgroundSize="contain")):o.style.display="none"}},e.setupThumbnailPreview=()=>{let t=e.displayOptions.layoutControls.timelinePreview;if(!t||!t.type)return;let o="mousemove",r="mouseleave";if(e.mobileInfo.userOs&&(o="touchmove",r="touchend"),e.domRef.wrapper.querySelector(".fluid_controls_progress_container").addEventListener(o,e.drawTimelinePreview.bind(e),!1),e.domRef.wrapper.querySelector(".fluid_controls_progress_container").addEventListener(r,function(t){const o=e.domRef.wrapper.querySelector(".fluid_controls_progress_container");typeof t.clientX<"u"&&o.contains(document.elementFromPoint(t.clientX,t.clientY))||(e.domRef.wrapper.querySelector(".fluid_timeline_preview_container").style.display="none",e.domRef.wrapper.querySelector(".fluid_timeline_preview_container_shadow").style.display="none")},!1),e.generateTimelinePreviewTags(),"VTT"===t.type&&"string"==typeof t.file)import("./webvtt-B40-cwOh.mjs").then(t=>{window.WebVTTParser=t.default,e.setupThumbnailPreviewVtt()});else{if("static"!==t.type||"object"!=typeof t.frames)throw"Invalid thumbnail-preview - type must be VTT or static";t.spriteImage=!0,e.timelinePreviewData=t.frames}e.showTimeOnHover=!1}},function(e,t){const o="2.0";e.renderLinearAd=(t,r)=>{e.toggleLoader(!1),e.hideLiveIndicator(),e.isLiveStream=null,e.vastOptions=t,r&&e.backupMainVideoContentTime(t.rollListId);const n=()=>{if(e.adFinished)return void e.domRef.player.removeEventListener("timeupdate",n);const t=Math.floor(e.domRef.player.currentTime);0!==e.vastOptions.duration&&e.scheduleTrackingEvent(t,e.vastOptions.duration),t>=e.vastOptions.duration-1&&0!==e.vastOptions.duration&&(e.domRef.player.removeEventListener("timeupdate",n),e.adFinished=!0)};(t=>{e.switchPlayerToVpaidMode=t=>{e.debugMessage("starting function switchPlayerToVpaidMode");const r="fp_"+t.id+"_fluid_vpaid_iframe",n={};n.AdParameters=t.adParameters;const i=document.createElement("div");i.className="fluid_vpaid_slot",i.setAttribute("adListId",t.id),e.domRef.player.parentNode.insertBefore(i,r.nextSibling);const a={slot:i,videoSlot:e.domRef.player,videoSlotCanAutoPlay:!0},s=e.vpaidAdUnit.handshakeVersion(o);if(1===e.compareVersion(o,s))return t.error=!0,e.playMainVideoWhenVpaidFails(403),!1;!1!==e.vastOptions.skipoffset&&e.addSkipButton(),e.domRef.player.loop=!1,e.domRef.player.removeAttribute("controls"),e.vpaidCallbackListenersAttach();const l=e.fullscreenMode?"fullscreen":"normal",d=e.domRef.player.offsetWidth,c=e.domRef.player.offsetHeight;e.vpaidAdUnit.initAd(d,c,l,3e3,n,a);const u=e.domRef.player.parentNode.getElementsByClassName("fluid_controls_currentprogress");for(let t=0;t<u.length;t++)u[t].style.backgroundColor=e.displayOptions.layoutControls.adProgressColor;e.toggleLoader(!1),t.played=!0,e.adFinished=!1},e.switchPlayerToVastMode=()=>{if(e.vastOptions.duration||(e.vastOptions.duration="streaming"===r.delivery?1/0:e.domRef.player.duration),e.displayOptions.layoutControls.showCardBoardView)t.landingPage?e.addCTAButton(t.landingPage):e.addCTAButton(t.clickthroughUrl);else{let o=[void 0,!0].includes(e.displayOptions.vastOptions.adClickable);void 0!==e.rollsById[t.rollListId].adClickable&&(o=e.rollsById[t.rollListId].adClickable),o&&e.addClickthroughLayer(),e.addCTAButton(t.landingPage)}!1!==e.vastOptions.skipoffset&&e.addSkipButton(),e.domRef.player.loop=!1,e.addAdCountdown(),e.domRef.player.removeAttribute("controls"),e.vastLogoBehaviour(!0);const o=e.domRef.player.parentNode.getElementsByClassName("fluid_controls_currentprogress");for(let t=0;t<o.length;t++)o[t].style.backgroundColor=e.displayOptions.layoutControls.adProgressColor;if(e.rollsById[t.rollListId].adText||t.adText){const o=t.adText?t.adText:e.rollsById[t.rollListId].adText;e.addAdPlayingText(o)}if(e.positionTextElements(t),e.toggleLoader(!1),t.played=!0,e.adFinished=!1,e.domRef.player.play(),e.trackSingleEvent("impression"),e.domRef.player.removeEventListener("loadedmetadata",e.switchPlayerToVastMode),e.vrMode){const t=e.domRef.wrapper.querySelector(".ad_countdown"),o=e.domRef.wrapper.querySelector(".fluid_ad_cta"),r=e.domRef.wrapper.querySelector(".fluid_ad_playing"),n=e.domRef.wrapper.querySelector(".skip_button");t&&(t.style.display="none"),o&&(o.style.display="none"),r&&(r.style.display="none"),n&&(n.style.display="none")}},e.domRef.player.pause(),e.detachStreamers();const r=e.getSupportedMediaFileObject(e.vastOptions.mediaFileList);if(e.displayOptions.layoutControls.showCardBoardView&&"360"!==t.mediaType)return t.error=!0,e.playMainVideoWhenVastFails(403),!1;const n=e.vastOptions.vpaid;if(!n&&r.isUnsuportedHls)import("./hls-ZjJWTS-Y.mjs").then(t=>{window.Hls=t.default;const o=new Hls({debug:typeof FP_DEBUG<"u"&&!0===FP_DEBUG,startPosition:0,p2pConfig:{logLevel:!1},enableWebVTT:!1,enableCEA708Captions:!1});o.attachMedia(e.domRef.player),o.loadSource(r.src),e.isCurrentlyPlayingAd=!0,o.once(Hls.Events.LEVEL_LOADED,function(t,o){e.isLiveStream=!!o.details.live,o.details.live?e.showLiveIndicator():e.hideLiveIndicator()}),e.hlsPlayer=o,e.domRef.player.addEventListener("loadedmetadata",e.switchPlayerToVastMode),e.domRef.player.addEventListener("ended",()=>{o.detachMedia(),o.destroy(),e.hlsPlayer=!1,e.onVastAdEnded()}),e.domRef.player.play()});else if(n)e.loadVpaid(t,r.src),e.displayOptions.vastOptions.showProgressbarMarkers&&e.hideAdMarkers();else{if(!1===r.src)return t.error=!0,e.playMainVideoWhenVastFails(403),!1;e.domRef.player.addEventListener("loadedmetadata",e.switchPlayerToVastMode),e.domRef.player.src=r.src,e.isCurrentlyPlayingAd=!0,e.displayOptions.vastOptions.showProgressbarMarkers&&e.hideAdMarkers(),e.domRef.player.load(),e.domRef.player.addEventListener("ended",e.onVastAdEnded)}})(t),e.domRef.player.addEventListener("timeupdate",n)},e.playRoll=t=>{const o=[];for(let e=0;e<t.length;e++)o.push(t[e]);if(e.temporaryAdPods=o,null!==e.vastOptions&&"linear"===e.vastOptions.adType.toLowerCase())return;const r=e.getNextAdPod();null!==r&&e.renderLinearAd(r,!0);const n=e.rollsById[r.rollListId].roll;e.currentMediaSourceType=n},e.backupMainVideoContentTime=t=>{switch(e.rollsById[t].roll){case"midRoll":e.domRef.player.mainVideoCurrentTime=e.domRef.player.currentTime-1;break;case"postRoll":e.domRef.player.mainVideoCurrentTime=e.mainVideoDuration,e.autoplayAfterAd=!1,e.domRef.player.currentTime=e.mainVideoDuration;break;case"preRoll":if(e.domRef.player.currentTime>0||e.domRef.player.safariPlayheadPosition){const t=e.domRef.player.safariPlayheadPosition??e.domRef.player.currentTime;e.domRef.player.mainVideoCurrentTime=t-1}}},e.getSupportedMediaFileObject=t=>{let o=null,r=!1;if(t.length)for(let n=0;n<t.length;n++){if("VPAID"===t[n].apiFramework){o=t[n],r=!0;break}{const i=e.getMediaFileTypeSupportLevel(t[n].type);if(("maybe"===i||"probably"===i)&&(o=t[n],r=!0),"probably"===i)break;"no"===i&&"streaming"===t[n].delivery&&("application/vnd.apple.mpegurl"===t[n].type||"application/x-mpegURL"===t[n].type)&&(o=t[n],o.isUnsuportedHls=!0,r=!0)}}return!1!==r&&o},e.getMediaFileTypeSupportLevel=e=>{if(null===e)return null;return document.createElement("video").canPlayType(e)||"no"},e.scheduleTrackingEvent=(t,o)=>{0===t&&(e.trackSingleEvent("start"),e.observe(),e.domRef.player.timeInView=0),e.domRef.player.inView&&(e.domRef.player.timeInView>2?e.trackSingleEvent("viewImpression"):e.domRef.player.timeInView+=t),typeof e.vastOptions.tracking.progress<"u"&&e.vastOptions.tracking.progress.length&&typeof e.vastOptions.tracking.progress[t]<"u"&&e.trackSingleEvent("progress",t),t===Math.floor(o/4)&&e.trackSingleEvent("firstQuartile"),t===Math.floor(o/2)&&e.trackSingleEvent("midpoint"),t===Math.floor(3*o/4)&&e.trackSingleEvent("thirdQuartile"),t>=o-1&&e.trackSingleEvent("complete")},e.trackSingleEvent=(t,o)=>{if(typeof e.vastOptions>"u"||null===e.vastOptions)return;let r=[];switch(r.length=0,t){case"start":case"firstQuartile":case"midpoint":case"thirdQuartile":case"complete":!1===e.vastOptions.stopTracking[t]&&(null!==e.vastOptions.tracking[t]&&(r=e.vastOptions.tracking[t]),e.vastOptions.stopTracking[t]=!0);break;case"progress":e.vastOptions.tracking.progress[o].elements.forEach(function(t,n){!1===e.vastOptions.tracking.progress[o].stopTracking&&e.vastOptions.tracking.progress[o].elements.length&&(r=e.vastOptions.tracking.progress[o].elements),e.vastOptions.tracking.progress[o].stopTracking=!0});break;case"impression":typeof e.vastOptions.impression<"u"&&null!==e.vastOptions.impression&&typeof e.vastOptions.impression.length<"u"&&(r=e.vastOptions.impression);break;case"viewImpression":if(!0===e.vastOptions.stopTracking.viewImpression)break;typeof e.vastOptions.viewImpression<"u"&&null!==e.vastOptions.viewImpression&&typeof e.vastOptions.viewImpression.length<"u"&&(r=e.vastOptions.viewImpression,e.vastOptions.stopTracking.viewImpression=!0)}e.callUris(r)},e.completeNonLinearStatic=t=>{e.closeNonLinear(t.id),!1===e.adFinished&&(e.adFinished=!0,e.trackSingleEvent("complete")),clearInterval(e.nonLinearTracking)},e.createNonLinearStatic=t=>{if(e.vastOptions=t,e.createBoard(t),!0===e.rollsById[t.rollListId].error||!0===t.error)return void e.announceLocalError(101);e.adFinished=!1;let o=!!e.rollsById[t.rollListId].nonLinearDuration&&e.rollsById[t.rollListId].nonLinearDuration;e.vastOptions.vpaid||(e.trackSingleEvent("start"),o=o||e.vastOptions.duration,e.nonLinearTracking=setInterval(function(){if(!0===e.adFinished)return;const t=Math.floor(e.domRef.player.currentTime);e.scheduleTrackingEvent(t,o),t>=o-1&&(e.adFinished=!0)},400),e.destructors.push(()=>clearInterval(e.nonLinearTracking)));const r=parseInt(e.getCurrentTime())+parseInt(o);e.scheduleTask({time:r,closeStaticAd:t,rollListId:t.rollListId})},e.createVpaidNonLinearBoard=t=>{e.loadVpaidNonlinearAssets=function(t){e.vastOptions=t,e.debugMessage("starting function switchPlayerToVpaidMode");const r=t.vAlign?t.vAlign:e.nonLinearVerticalAlign,n=t.vpaidNonLinearCloseButton?t.vpaidNonLinearCloseButton:e.vpaidNonLinearCloseButton,i="fp_"+t.id+"_fluid_vpaid_iframe",a={};a.AdParameters=t.adParameters;const s=document.createElement("div");s.id="fluid_vpaidNonLinear_"+t.id,s.className="fluid_vpaidNonLinear_"+r,s.className+=" fluid_vpaidNonLinear_ad",s.setAttribute("adListId",t.id);let l=Math.min(468,e.domRef.player.offsetWidth),d=Math.min(60,Math.floor(e.domRef.player.offsetHeight/4));if(typeof t.size<"u"){const e=t.size.split("x");l=e[0],d=e[1]}else t.dimension.width&&t.dimension.height&&(l=t.dimension.width,d=t.dimension.height);if(s.style.width="100%",s.style.height=d+"px",n){const o=document.createElement("div");o.className="fluid_vpaidNonLinear_frame",o.style.width=l+"px",o.style.height=d+"px",s.appendChild(o);const r=document.createElement("div");r.className="close_button",r.innerHTML="",r.title=e.displayOptions.layoutControls.closeButtonCaption;const[n]=t.id.split("_");r.onclick=function(t){if(e.hardStopVpaidAd(""),typeof t.stopImmediatePropagation<"u"&&t.stopImmediatePropagation(),e.adFinished=!0,"onPauseRoll"===e.rollsById[n].roll&&e.onPauseRollAdPods[0]){const t=e.onPauseRollAdPods[0];e.createBoard(t),e.currentOnPauseRollAd=e.onPauseRollAdPods[0],delete e.onPauseRollAdPods[0]}return!1},o.appendChild(r)}const c=document.createElement("iframe");c.id=e.videoPlayerId+"non_linear_vapid_slot_iframe",c.className="fluid_vpaid_nonlinear_slot_iframe",c.setAttribute("width",l+"px"),c.setAttribute("height",d+"px"),c.setAttribute("sandbox","allow-forms allow-pointer-lock allow-popups allow-popups-to-escape-sandbox allow-same-origin allow-scripts"),c.setAttribute("frameborder","0"),c.setAttribute("scrolling","no"),c.setAttribute("marginwidth","0"),c.setAttribute("marginheight","0"),s.appendChild(c),e.domRef.player.parentNode.insertBefore(s,i.nextSibling);const u=c.contentWindow.document.createElement("div");c.contentWindow.document.body.appendChild(u),e.vastOptions.slotIframe=c,e.vastOptions.slotFrame=undefined;const p={slot:u,videoSlot:e.domRef.player,videoSlotCanAutoPlay:!0};e.debugMessage(t);const f=e.vpaidAdUnit.handshakeVersion(o);if(1===e.compareVersion(o,f))return t.error=!0,e.playMainVideoWhenVpaidFails(403),!1;e.domRef.player.loop=!1,e.domRef.player.removeAttribute("controls"),e.vpaidCallbackListenersAttach();const m=e.fullscreenMode?"fullscreen":"normal";e.vpaidAdUnit.initAd(l,d,m,3e3,a,p),e.toggleLoader(!1),t.played=!0,e.adFinished=!1},e.loadVpaid(t,t.staticResource),e.debugMessage("create non linear vpaid")},e.createNonLinearBoard=t=>{t.played=!0;const o=document.createElement("div"),r=e.rollsById[t.rollListId].vAlign?e.rollsById[t.rollListId].vAlign:e.nonLinearVerticalAlign,n=new Image;n.src=t.staticResource,n.id="fluid_nonLinear_imgCreative_"+t.id+"_"+e.videoPlayerId,n.onerror=function(){e.rollsById[t.rollListId].error=!0,e.announceError(500)},n.onload=function(){const o=e.domRef.player.clientWidth;let r,i,a,s;if(typeof e.rollsById[t.rollListId].size<"u"?(r=e.rollsById[t.rollListId].size.split("x")[0],i=e.rollsById[t.rollListId].size.split("x")[1]):t.dimension.width&&t.dimension.height?(r=t.dimension.width,i=t.dimension.height):(r=n.width,i=n.height),r>o?(a=o-5,s=i*a/r):(a=r,s=i),"onPauseRoll"!==e.rollsById[t.rollListId].roll){const o=e.domRef.wrapper.querySelector("#fluid_nonLinear_"+t.id);o&&(o.style.display="")}const l=e.domRef.wrapper.querySelector("#"+n.id);l.width=a,l.height=s,e.trackSingleEvent("impression")},o.id="fluid_nonLinear_"+t.id,o.className="fluid_nonLinear_"+r,o.className+=" fluid_nonLinear_ad",o.innerHTML=n.outerHTML,o.style.display="none",o.onclick=function(){typeof t.clickthroughUrl<"u"&&window.open(t.clickthroughUrl),typeof t.clicktracking<"u"&&e.callUris([t.clicktracking])},typeof t.clickthroughUrl<"u"&&(o.style.cursor="pointer");const i=document.createElement("div");i.className="close_button",i.innerHTML="",i.title=e.displayOptions.layoutControls.closeButtonCaption;const a=t.rollListId;i.onclick=function(t){if(this.parentElement.remove(),typeof t.stopImmediatePropagation<"u"&&t.stopImmediatePropagation(),e.adFinished=!0,clearInterval(e.nonLinearTracking),"onPauseRoll"===e.rollsById[a].roll&&e.onPauseRollAdPods[0]){const t=e.onPauseRollAdPods[0];e.createBoard(t),e.currentOnPauseRollAd=e.onPauseRollAdPods[0],delete e.onPauseRollAdPods[0]}return!1},o.appendChild(i),e.domRef.player.parentNode.insertBefore(o,e.domRef.player.nextSibling)},e.createBoard=t=>{if(t.vpaid)e.hardStopVpaidAd(""),e.createVpaidNonLinearBoard(t);else{if(typeof t.staticResource>"u"||-1===e.supportedStaticTypes.indexOf(t.creativeType))return t.error=!0,void(!e.vastOptions||typeof e.vastOptions.errorUrl>"u"?e.announceLocalError(503):e.announceError(503));e.createNonLinearBoard(t)}},e.closeNonLinear=t=>{const o=e.domRef.wrapper.querySelector("#fluid_nonLinear_"+t+", #fluid_vpaidNonLinear_"+t);o&&o.remove()},e.rollGroupContainsLinear=t=>{let o=!1;for(let r=0;r<t.length;r++)if(e.rollsById[t[r].id].adType&&"linear"===e.rollsById[t[r].id].adType){o=!0;break}return o},e.rollGroupContainsNonlinear=t=>{let o=!1;for(let r=0;r<t.length;r++)if("nonlinear"===e.rollsById[t[r].id].adType.toLowerCase()){o=!0;break}return o},e.preRollFail=()=>{const t=e.preRollAdPodsLength;e.preRollVastResolved++,e.preRollVastResolved===t&&e.preRollAdsPlay()},e.preRollSuccess=()=>{const t=e.preRollAdPodsLength;e.preRollVastResolved++,e.preRollVastResolved===t&&e.preRollAdsPlay()},e.preRollAdsPlay=()=>{const t=e.preRollAdPods,o={linear:[],nonLinear:[]};e.firstPlayLaunched=!0;for(let r=0;r<t.length;r++)e.rollsById[t[r]].ads.forEach(t=>{!0!==t.played&&("linear"===t.adType&&o.linear.push(t),"nonLinear"===t.adType&&(o.nonLinear.push(t),e.scheduleTask({time:0,playRoll:"midRoll",rollListId:t.rollListId})))});o.linear.length>0?(e.toggleLoader(!1),e.playRoll(o.linear)):e.playMainVideoWhenVastFails(900)},e.preRoll=t=>{const o=t.vastObj;e.domRef.player.removeEventListener(t.type,e.preRoll);const r=[];r[0]=t.type.replace("adId_",""),!0!==e.rollsById[r[0]].played&&(e.preRollAdPods.push(r[0]),e.preRollSuccess(o))},e.createAdMarker=(t,o)=>{const r=e.domRef.wrapper.querySelector(".fluid_controls_ad_markers_holder"),n=document.createElement("div");n.className="fluid_controls_ad_marker fluid_controls_ad_marker_"+t,n.dataset.adListId=t,n.style.left=o/e.mainVideoDuration*100+"%",e.isCurrentlyPlayingAd&&(n.style.display="none"),r.appendChild(n)},e.hideAdMarker=t=>{const o=e.domRef.wrapper.querySelector("fluid_controls_ad_marker_"+t);o&&(o.style.display="none")},e.showAdMarkers=()=>{const t=e.domRef.wrapper.querySelector(".fluid_controls_ad_markers_holder").getElementsByClassName("fluid_controls_ad_marker");for(let o=0;o<t.length;++o){const r=t[o],n=r.dataset.adListId;!1===e.rollsById[n].played&&(r.style.display="")}},e.hideAdMarkers=()=>{const t=e.domRef.wrapper.querySelector(".fluid_controls_ad_markers_holder").getElementsByClassName("fluid_controls_ad_marker");for(let e=0;e<t.length;++e){t[e].style.display="none"}},e.midRoll=t=>{e.domRef.player.removeEventListener(t.type,e.midRoll);const o=t.type.replace("adId_","");if(!0===e.rollsById[o].played)return;let r=e.rollsById[o].timer;"string"==typeof r&&-1!==r.indexOf("%")&&(r=r.replace("%",""),r=Math.floor(e.mainVideoDuration/100*r)),e.displayOptions.vastOptions.showProgressbarMarkers&&"nonLinear"===e.rollsById[o].adType&&e.createAdMarker(o,r),e.scheduleTask({time:r,playRoll:"midRoll",rollListId:o})},e.postRoll=t=>{e.domRef.player.removeEventListener(t.type,e.postRoll);const o=t.type.replace("adId_","");e.scheduleTask({time:Math.floor(e.mainVideoDuration),playRoll:"postRoll",rollListId:o})},e.onPauseRoll=t=>{e.domRef.player.removeEventListener(t.type,e.onPauseRoll);const o=t.type.replace("adId_","");e.rollsById[o].ads.forEach(t=>{if("nonLinear"===t.adType){if(!0===e.rollsById[t.rollListId].error||!0===t.error)return void e.announceLocalError(101);if(e.domRef.wrapper.getElementsByClassName("fluid_nonLinear_ad")[0])e.onPauseRollAdPods.push(o);else{e.createBoard(t),e.currentOnPauseRollAd=o;let r="";for(const t of e.domRef.wrapper.children)t.id==="fluid_nonLinear_"+o&&(r=t);r&&(r.style.display="none")}}})},e.hasValidOnPauseAd=()=>{const t=e.findRoll("onPauseRoll");return 0!==t.length&&e.rollsById[t[0]]&&!1===e.rollsById[t[0]].error&&e.rollsById[t[0]].ads.length&&!0!==e.rollsById[t[0]].ads[0].error},e.toggleOnPauseAd=()=>{if(e.toggleLoader(!1),e.hasValidOnPauseAd()&&!e.isCurrentlyPlayingAd){const t=e.findRoll("onPauseRoll"),o=e.rollsById[t].ads[0];e.vastOptions=o;let r="";for(const t of e.domRef.wrapper.children)t.id==="fluid_nonLinear_"+o.id&&(r=t);r&&e.domRef.player.paused?setTimeout(function(){r.style.display="flex",o.played=!1,e.trackingOnPauseNonLinearAd(o,"start")},500):r&&!e.domRef.player.paused&&(r.style.display="none",e.adFinished=!0,e.trackingOnPauseNonLinearAd(o,"complete"))}},e.trackingOnPauseNonLinearAd=(t,o)=>{!0!==e.rollsById[t.rollListId].error&&!0!==t.error?(e.vastOptions=t,e.trackSingleEvent(o)):e.announceLocalError(101)},e.getLinearAdsFromKeyTime=t=>{const o=[];for(let r=0;r<t.length;r++)!1===e.rollsById[t[r].adListId].played&&o.push(t[r].adListId);return o},e.adKeytimePlay=t=>{if(!e.timerPool[t]||e.isCurrentlyPlayingAd)return;const o=e.timerPool[t].closeStaticAd.length,r=e.timerPool[t].linear.length,n=e.timerPool[t].nonLinear.length,i=e.timerPool[t].loadVast.length;if([o,r,n,i].every(e=>0===e))delete e.timerPool[t];else{if(o>0){for(let r=0;r<o;r++){const o=e.timerPool[t].closeStaticAd[r];!0===o.played&&e.completeNonLinearStatic(o)}e.timerPool[t].closeStaticAd=[]}if(r>0&&e.timerPool[t].linear.length>0)return e.playRoll(e.timerPool[t].linear),void(e.timerPool[t].linear=[]);if(n>0)for(let o=0;o<n;o++){const r=e.timerPool[t].nonLinear[o],n=r.rollListId;if(e.adPool[n],!1===r.played&&!e.displayOptions.layoutControls.showCardBoardView)return e.createNonLinearStatic(r),e.displayOptions.vastOptions.showProgressbarMarkers&&e.hideAdMarker(n),void e.timerPool[t].nonLinear.splice(o,1)}i>0&&(e.timerPool[t].loadVast.forEach(t=>{"postRoll"===t.roll&&t.voidPostRollTasks||("postRoll"===t.roll&&(t.voidPostRollTasks=!0),e.debugMessage(`Handling on-demand VAST load for roll ${t.id}`),e.processVastWithRetries(t))}),e.timerPool[t].loadVast=[])}},e.adTimer=()=>{e.isTimer||(e.isTimer=!e.isTimer,e.timer=setInterval(function(){const t=Math.floor(e.getCurrentTime());e.adKeytimePlay(t)},800),e.destructors.push(()=>e.timer))},e.scheduleTask=t=>{t.time>e.mainVideoDuration||t.time<0||Number.isNaN(t.time)?console.warn("Scheduled task has invalid time",t.time,". Check your configuration."):(e.debugMessage("Scheduling task",t),e.timerPool.hasOwnProperty(t.time)||(e.timerPool[t.time]={linear:[],nonLinear:[],closeStaticAd:[],loadVast:[]}),t.rollListId&&e.rollsById[t.rollListId].ads.filter(e=>{let{adType:o}=e;return 0!==t.time||"linear"!==o}).forEach(o=>{t.hasOwnProperty("playRoll")&&"linear"===o.adType?e.timerPool[t.time].linear.push(o):t.hasOwnProperty("playRoll")&&"nonLinear"===o.adType?e.timerPool[t.time].nonLinear.push(o):t.hasOwnProperty("closeStaticAd")&&e.timerPool[t.time].closeStaticAd.push(o)}),t.loadVast&&e.timerPool[t.time].loadVast.push(t.roll))},e.scheduleOnDemandRolls=()=>{[...e.findRoll("midRoll")||[],...e.findRoll("postRoll")||[]].map(t=>e.rollsById[t]).filter(e=>!0!==e.vastLoaded&&!0!==e.error).forEach(t=>{if("midRoll"===t.roll){"string"==typeof t.timer&&(t.timer=Math.floor(e.mainVideoDuration/100*t.timer.replace("%","")),e.debugMessage(`Replaced midRoll from percentage to timer value ${t.timer} seconds`));const o=t.timer-e.displayOptions.vastOptions.vastTimeout/1e3;o<=Number(e.getCurrentTime())?(e.debugMessage("Loading Mid Roll VAST immediately as it needs to be played soon"),e.processVastWithRetries(t)):e.scheduleTask({loadVast:!0,time:o,roll:t})}else{const o=parseInt(e.mainVideoDuration),r=e.displayOptions.vastOptions.vastTimeout/1e3;t.voidPostRollTasks=!1;for(let n=1;n<=r;n++)e.scheduleTask({loadVast:!0,time:o-n,roll:t})}})},e.switchToMainVideo=()=>{e.debugMessage("starting main video"),e.hideLiveIndicator(),e.isLiveStream=null,e.domRef.player.src=e.originalSrc,e.currentMediaSourceType="source",e.initialiseStreamers(),e.hlsPlayer&&!e.hlsPlayer.config.autoStartLoad&&e.hlsPlayer.startLoad();const t=typeof e.domRef.player.mainVideoCurrentTime<"u"?Math.floor(e.domRef.player.mainVideoCurrentTime):0;if(e.domRef.player.hasOwnProperty("currentTime")&&(e.domRef.player.currentTime=t),e.displayOptions.layoutControls.loop&&(e.domRef.player.loop=!0),e.setCurrentTimeAndPlay(t,e.autoplayAfterAd),e.isCurrentlyPlayingAd=!1,e.deleteVastAdElements(),e.adFinished=!0,e.displayOptions.vastOptions.vastAdvanced.vastVideoEndedCallback(),e.vastOptions=null,e.setBuffering(),null!==e.domRef.wrapper.querySelector(".fluid_controls_progress_container")){const t=e.displayOptions.layoutControls.primaryColor?e.displayOptions.layoutControls.primaryColor:"white",o=e.domRef.player.parentNode.getElementsByClassName("fluid_controls_currentprogress");for(let e=0;e<o.length;e++)o[e].style.backgroundColor=t}if(e.domRef.player.removeEventListener("ended",e.onVastAdEnded),e.displayOptions.vastOptions.showProgressbarMarkers&&e.showAdMarkers(),e.hasTitle()){e.domRef.wrapper.querySelector(".fp_title").style.display="inline"}},e.getNextAdPod=()=>e.temporaryAdPods.length>0?e.temporaryAdPods.shift():null,e.checkForNextAd=()=>{const t=e.getNextAdPod();null===t?(e.switchToMainVideo(),e.vastOptions=null,e.adFinished=!0):(e.domRef.player.removeEventListener("ended",e.onVastAdEnded),e.isCurrentlyPlayingAd=!1,e.vastOptions=null,e.adFinished=!0,e.renderLinearAd(t,!1))},e.addSkipButton=()=>{const t=document.createElement("div");t.className="skip_button skip_button_disabled",e.vastOptions.skipoffset>0&&(t.innerHTML=e.displayOptions.vastOptions.skipButtonCaption.replace("[seconds]",e.vastOptions.skipoffset)),e.domRef.wrapper.appendChild(t),0===e.vastOptions.skipoffset&&e.decreaseSkipOffset(),e.domRef.player.addEventListener("timeupdate",e.decreaseSkipOffset,!1)},e.addAdCountdown=()=>{if(e.isCurrentlyPlayingAd&&e.hlsPlayer||e.currentVideoDuration===1/0)return;const t=e.domRef.wrapper,o=document.createElement("div"),r=e.pad(parseInt(e.currentVideoDuration/60))+":"+e.pad(parseInt(e.currentVideoDuration%60)),n=parseInt(r);o.className="ad_countdown",o.innerHTML="<span class='ad_timer_prefix'>Ad - </span>"+n,t.appendChild(o),e.domRef.player.addEventListener("timeupdate",e.decreaseAdCountdown,!1),t.addEventListener("mouseover",function(){o.style.display="none"},!1)},e.decreaseAdCountdown=function(){const t=parseInt(e.currentVideoDuration)-parseInt(e.domRef.player.currentTime),o=e.domRef.wrapper.querySelector(".ad_countdown");o&&isNaN(t)?o.parentNode.removeChild(o):o?o.innerHTML="<span class='ad_timer_prefix'>Ad - </span> "+e.pad(parseInt(t/60))+":"+e.pad(parseInt(t%60)):e.domRef.player.removeEventListener("timeupdate",e.decreaseAdCountdown)},e.removeAdCountdown=()=>{const t=e.domRef.wrapper.querySelector(".ad_countdown");t&&t.parentElement.removeChild(t)},e.toggleAdCountdown=t=>{const o=e.domRef.wrapper.querySelector(".ad_countdown");o&&(o.style.display=t?"inline-block":"none")},e.addAdPlayingText=t=>{const o=document.createElement("div");e.displayOptions.layoutControls.primaryColor&&(o.style.backgroundColor=e.displayOptions.layoutControls.primaryColor,o.style.opacity=1),o.className="fluid_ad_playing",o.innerText=t,e.domRef.wrapper.appendChild(o)},e.positionTextElements=t=>{const o=["top left","top right","bottom left","bottom right"],r=e.domRef.wrapper.querySelector(".skip_button"),n=e.domRef.wrapper.querySelector(".fluid_ad_playing"),i=e.domRef.wrapper.querySelector(".fluid_ad_cta");let a=0,s=0;let l=!1,d=0,c=[];const u={top:{left:{h:34,v:34},right:{h:0,v:34}},bottom:{left:{h:34,v:50},right:{h:0,v:50}}};let p,f,m;null!==r&&(d=r.offsetHeight+8,e.domRef.wrapper.classList.contains("mobile")&&(u.top={left:{h:0,v:8},right:{h:0,v:8}},u.bottom={left:{h:0,v:50},right:{h:0,v:50}})),null!==i&&(p=e.rollsById[t.rollListId].adCTATextPosition?e.rollsById[t.rollListId].adCTATextPosition.toLowerCase():e.displayOptions.vastOptions.adCTATextPosition,-1===o.indexOf(p)&&(console.log('[FP Error] Invalid position for CTAText. Reverting to "bottom right"'),p="bottom right"),i.classList.add.apply(i.classList,p.split(" ")),c=p.split(" "),l="bottom"===c[0],i.style[c[0]]=u[c[0]][c[1]].v+"px",i.style[c[1]]=u[c[0]][c[1]].h+"px",l&&"right"===c[1]&&(i.style[c[0]]=u[c[0]][c[1]].v+d+"px"),a=i.offsetHeight+8+"px"),null!==n&&(f=e.rollsById[t.rollListId].adTextPosition?e.rollsById[t.rollListId].adTextPosition.toLowerCase():e.displayOptions.vastOptions.adTextPosition,-1===o.indexOf(f)&&(console.log('[FP Error] Invalid position for adText. Reverting to "top left"'),f="top left"),m=f.split(" "),n.style[m[0]]=u[m[0]][m[1]].v+"px",n.style[m[1]]=u[m[0]][m[1]].h+"px",s=n.offsetHeight+8+"px"),a>0&&s>0&&p===f&&(l?"right"===c[1]?n.style.bottom=u[m[0]][m[1]].v+d+a+"px":n.style.bottom=u[m[0]][m[1]].v+a+"px":i.style.top=u[c[0]][c[1]].v+s+"px")},e.removeAdPlayingText=()=>{const t=e.domRef.wrapper.querySelector(".fluid_ad_playing");t&&t.parentElement.removeChild(t)},e.addCTAButton=t=>{if(e.vastOptions.titleCTA){const{text:t,link:o,tracking:r}=e.vastOptions.titleCTA;return e.createAndAppendCTAButton(t,o,r)}if(t&&"string"==typeof e.displayOptions.vastOptions.adCTAText)return e.createAndAppendCTAButton(e.displayOptions.vastOptions.adCTAText,t,e.vastOptions.clickthroughUrl)},e.createAndAppendCTAButton=(t,o,r)=>{const n=document.createElement("div");n.className="fluid_ad_cta";const i=document.createElement("span");let a=t;o&&(a+='<br/><span class="add_icon_clickthrough">'+o+"</span>"),i.innerHTML=a,n.addEventListener("click",()=>(e.domRef.player.paused||e.domRef.player.pause(),window.open(r,"_blank").focus(),!0),!1),n.appendChild(i),e.domRef.wrapper.appendChild(n)},e.removeCTAButton=()=>{const t=e.domRef.wrapper.querySelector(".fluid_ad_cta");t&&t.parentElement.removeChild(t)},e.decreaseSkipOffset=()=>{if(typeof e.vastOptions>"u"||null===e.vastOptions)return;let t=e.vastOptions.skipoffset-Math.floor(e.domRef.player.currentTime);const o=e.domRef.wrapper.querySelector(".skip_button");if(!o)return void e.domRef.player.removeEventListener("timeupdate",e.decreaseSkipOffset);if(t>=1)return void(o.innerHTML=e.displayOptions.vastOptions.skipButtonCaption.replace("[seconds]",t));const r=document.createElement("a");r.href="#",r.className="js-skipHref",r.innerHTML=e.displayOptions.vastOptions.skipButtonClickCaption,r.onclick=t=>{t.preventDefault(),t.stopPropagation(),e.pressSkipButton()},o.innerHTML="",o.appendChild(r),o.className=o.className.replace(/\bskip_button_disabled\b/,""),e.domRef.player.removeEventListener("timeupdate",e.decreaseSkipOffset)},e.pressSkipButton=()=>{if(e.removeSkipButton(),e.removeAdPlayingText(),e.removeCTAButton(),e.vastOptions.vpaid)return void e.skipVpaidAd();e.displayOptions.vastOptions.vastAdvanced.vastVideoSkippedCallback();const t=document.createEvent("Event");t.initEvent("ended",!1,!0),e.domRef.player.dispatchEvent(t)},e.removeSkipButton=()=>{const t=e.domRef.wrapper.querySelector(".skip_button");t&&t.parentElement.removeChild(t)},e.addClickthroughLayer=()=>{const t=e.domRef.wrapper,o=document.createElement("div");o.className="vast_clickthrough_layer",o.setAttribute("style","position: absolute; cursor: pointer; top: 0; left: 0; width: "+e.domRef.player.offsetWidth+"px; height: "+e.domRef.player.offsetHeight+"px;"),t.appendChild(o);const r=function(){window.open(e.vastOptions.clickthroughUrl),typeof e.vastOptions.clicktracking<"u"&&e.callUris(e.vastOptions.clicktracking)},n=e.domRef.wrapper.querySelector(".vast_clickthrough_layer"),i="iPhone"===e.mobileInfo.device&&!1!==e.mobileInfo.userOsMajor&&e.mobileInfo.userOsMajor<=9;n.onclick=()=>{e.domRef.player.paused?i&&!e.suppressClickthrough?(r(),e.suppressClickthrough=!0):e.domRef.player.play():(r(),e.domRef.player.pause())}},e.removeClickthrough=()=>{const t=e.domRef.wrapper.querySelector(".vast_clickthrough_layer");t&&t.parentNode.removeChild(t)}},function(e,t){e.initialiseStreamers=()=>{switch(e.detachStreamers(),e.displayOptions.layoutControls.mediaType){case"application/dash+xml":e.dashScriptLoaded||window.dashjs&&!window.dashjs.isDefaultSubject?e.initialiseDash():(e.dashScriptLoaded=!0,import("./dash.all.min-BBXX0989.mjs").then(e=>e.d).then(t=>{window.dashjs=t.default,e.initialiseDash()}));break;case"application/x-mpegurl":const{displayOptions:t,domRef:o}=e,{player:r}=o,{hls:n}=t;if(r.canPlayType("application/x-mpegurl")&&!n.overrideNative){e.debugMessage("Native HLS support found, skipping hls.js");break}e.hlsScriptLoaded||window.Hls?e.initialiseHls():(e.hlsScriptLoaded=!0,import("./hls-ZjJWTS-Y.mjs").then(t=>{window.Hls=t.default,e.initialiseHls()}))}},e.initialiseDash=()=>{if("function"==typeof(window.MediaSource||window.WebKitMediaSource)){const t=e.autoplayAfterAd?e.displayOptions.layoutControls.autoPlay:e.autoplayAfterAd,o={debug:{logLevel:typeof FP_DEBUG<"u"&&!0===FP_DEBUG?dashjs.Debug.LOG_LEVEL_DEBUG:dashjs.Debug.LOG_LEVEL_FATAL}},r=dashjs.MediaPlayer().create(),n=e.displayOptions.modules.configureDash(o);r.updateSettings(n),e.displayOptions.modules.onBeforeInitDash(r),r.initialize(e.domRef.player,e.originalSrc,t),r.on("streamInitializing",()=>{e.toggleLoader(!0)}),r.on("canPlay",()=>{e.toggleLoader(!1)}),r.on("playbackPlaying",()=>{e.toggleLoader(!1)}),r.on(dashjs.MediaPlayer.events.STREAM_INITIALIZED,()=>{e.isLiveStream=!!r.isDynamic(),r.isDynamic()&&e.showLiveIndicator()}),e.displayOptions.modules.onAfterInitDash(r),e.dashPlayer=r}else e.nextSource(),console.log("[FP_WARNING] Media type not supported by this browser using DASH.js. (application/dash+xml)")},e.initialiseHls=()=>{if(typeof Hls<"u"&&Hls.isSupported()){e.debugMessage("Initializing hls.js");const t={debug:typeof FP_DEBUG<"u"&&!0===FP_DEBUG,startPosition:0,p2pConfig:{logLevel:!1},enableWebVTT:!1,enableCEA708Captions:!1},o=e.displayOptions.modules.configureHls(t),r=new Hls(o);e.displayOptions.modules.onBeforeInitHls(r),r.attachMedia(e.domRef.player),r.loadSource(e.originalSrc),r.once(Hls.Events.LEVEL_LOADED,function(t,o){e.isLiveStream=!!o.details.live,o.details.live?e.showLiveIndicator():e.hideLiveIndicator()}),e.displayOptions.modules.onAfterInitHls(r),e.hlsPlayer=r,!e.firstPlayLaunched&&e.displayOptions.layoutControls.autoPlay&&e.domRef.player.play(),e.createHLSVideoSourceSwitch()}else e.nextSource(),console.log("[FP_WARNING] Media type not supported by this browser using HLS.js. (application/x-mpegURL)")},e.createHLSVideoSourceSwitch=()=>{e.hlsPlayer.on(Hls.Events.MANIFEST_PARSED,function(){try{const t=function(){const t=e.hlsPlayer.levels.map((e,t)=>({id:t,title:e.height+"p",isHD:"HDR"===e.videoRange,bitrate:e.bitrate})),o={id:-1,title:"auto",isHD:!1,bitrate:0};return[...t,o]}(),o=function(e){return[...e].sort((e,t)=>t.height!==e.height?t.height-e.height:t.bitrate-e.bitrate)}(t);if(e.videoSources=o,o.length<=2)return;const r=e.domRef.wrapper.querySelector(".fluid_control_video_source");!function(e,t){e.length>1?t.style.display="inline-block":t.style.display="none"}(o,r);const n=function(t){const o=document.createElement("div");return o.className="fluid_video_sources_list",o.style.display="none",t.forEach(t=>{const r=function(t){const o=function(t){const o=e.videoSources.filter(t=>t.title===e.fluidStorage.fluidQuality);if(o.length>1){if(o[0].id===t.id)return"source_selected"}else if(1===o.length)return o[0].id===t.id?"source_selected":"";return o.length||"auto"!==t.title?"":"source_selected"}(t),r=t.isHD?`<sup style="color:${e.displayOptions.layoutControls.primaryColor}" class="fp_hd_source"></sup>`:"",n=document.createElement("div");return n.className=`fluid_video_source_list_item js-source_${t.title}`,n.innerHTML=`<span class="source_button_icon ${o}"></span>${t.title}${r}`,n.addEventListener("click",o=>function(t,o){t.stopPropagation();const r=t.currentTarget;(function(){const t=e.domRef.wrapper.getElementsByClassName("source_button_icon");Array.from(t).forEach(e=>e.classList.remove("source_selected"))})(),r.firstChild.classList.add("source_selected"),e.videoSources.forEach(t=>{t.title===r.innerText.replace(/(\r\n\t|\n|\r\t)/gm,"")&&(e.hlsPlayer.currentLevel=o.id,e.fluidStorage.fluidQuality=o.title)}),e.openCloseVideoSourceSwitch()}(o,t)),n}(t);o.appendChild(r)}),o}(o);(function(t,o){t.appendChild(o),t.removeEventListener("click",e.openCloseVideoSourceSwitch),t.addEventListener("click",e.openCloseVideoSourceSwitch)})(r,n),function(t){const o=t.find(t=>t.title===e.fluidStorage.fluidQuality);if(o)e.hlsPlayer.currentLevel=o.id;else{const o=t.find(e=>"auto"===e.title);e.hlsPlayer.currentLevel=o.id}}(o)}catch(e){console.error(e)}})},e.detachStreamers=()=>{e.dashPlayer?(e.dashPlayer.reset(),e.dashPlayer=!1):e.hlsPlayer&&(e.hlsPlayer.detachMedia(),e.hlsPlayer=!1)}},function(e,t){e.isTouchDevice=()=>!(!("ontouchstart"in window)&&!navigator.maxTouchPoints),e.getMobileOs=()=>{const e=navigator.userAgent||"",t={device:!1,userOs:!1,userOsVer:!1,userOsMajor:!1};let o;if(e.match(/Android/i)?(t.userOs="Android",o=e.indexOf("Android ")):e.match(/iPhone/i)?(t.device="iPhone",t.userOs="iOS",o=e.indexOf("OS ")):e.match(/iPad/i)?(t.device="iPad",t.userOs="iOS",o=e.indexOf("OS ")):t.userOs=!1,"iOS"===t.userOs&&o>-1){const r=e.substr(o+3);-1!==r.indexOf(" ")&&(t.userOsVer=r.substring(0,r.indexOf(" ")).replace(/_/g,"."),t.userOsMajor=parseInt(t.userOsVer))}else"Android"===t.userOs&&o>-1?t.userOsVer=e.substr(o+8,3):t.userOsVer=!1;return t},e.getBrowserVersion=()=>{const e=navigator.userAgent||"",t={browserName:!1,fullVersion:!1,majorVersion:!1,userOsMajor:!1};let o,r;try{t.browserName=navigator.appName,-1!==(o=e.indexOf("OPR/"))?(t.browserName="Opera",t.fullVersion=e.substring(o+4)):-1!==(o=e.indexOf("Opera"))?(t.browserName="Opera",t.fullVersion=e.substring(o+6),-1!==(o=e.indexOf("Version"))&&(t.fullVersion=e.substring(o+8))):-1!==(o=e.indexOf("MSIE"))?(t.browserName="Microsoft Internet Explorer",t.fullVersion=e.substring(o+5)):-1!==(o=e.indexOf("Chrome"))?(t.browserName="Google Chrome",t.fullVersion=e.substring(o+7)):-1!==(o=e.indexOf("Safari"))?(t.browserName="Safari",t.fullVersion=e.substring(o+7),-1!==(o=e.indexOf("Version"))&&(t.fullVersion=e.substring(o+8))):-1!==(o=e.indexOf("Firefox"))?(t.browserName="Mozilla Firefox",t.fullVersion=e.substring(o+8)):(r=e.lastIndexOf(" ")+1)<(o=e.lastIndexOf("/"))&&(t.browserName=e.substring(r,o),t.fullVersion=e.substring(o+1),t.browserName.toLowerCase()===t.browserName.toUpperCase()&&(t.browserName=navigator.appName)),-1!==(r=t.fullVersion.indexOf(";"))&&(t.fullVersion=t.fullVersion.substring(0,r)),-1!==(r=t.fullVersion.indexOf(" "))&&(t.fullVersion=t.fullVersion.substring(0,r)),t.majorVersion=parseInt(""+t.fullVersion,10),isNaN(t.majorVersion)&&(t.fullVersion=""+parseFloat(navigator.appVersion),t.majorVersion=parseInt(navigator.appVersion,10))}catch{}return t},e.compareVersion=(e,t)=>{if("string"!=typeof e||"string"!=typeof t)return!1;e=e.split("."),t=t.split(".");const o=Math.min(e.length,t.length);for(let r=0;r<o;++r){if(e[r]=parseInt(e[r],10),t[r]=parseInt(t[r],10),e[r]>t[r])return 1;if(e[r]<t[r])return-1}return e.length===t.length?0:e.length<t.length?-1:1},e.convertTimeStringToSeconds=e=>{if(!e||!e.match(/^(\d){2}(:[0-5][0-9]){2}(.(\d){1,3})?$/))return!1;const t=e.split(":");return 3600*parseInt(t[0],10)+60*parseInt(t[1],10)+parseInt(t[2],10)},e.formatTime=t=>{const o=new Date(1e3*t),r=e.pad(o.getUTCHours()),n=e.pad(o.getUTCMinutes()),i=e.pad(o.getSeconds());return r>=1?r+":"+n+":"+i:n+":"+i},e.pad=e=>e<10?"0"+e:e,e.isElementVisible=e=>{if(!e)return null;const t=e.getBoundingClientRect();return t.top>=0&&t.left>=0&&t.bottom<=(window.innerHeight||document.documentElement.clientHeight)&&t.right<=(window.innerWidth||document.documentElement.clientWidth)},e.observe=()=>{new IntersectionObserver(function(t){t.forEach(function(t){t.intersectionRatio>=.5&&(e.domRef.player.inView=!0),0==t.intersectionRatio&&t.target.glast&&(e.domRef.player.inView=!1)})},{threshold:[0,.5]}).observe(e.domRef.wrapper)},e.throttle=function(e,t){let o=!1;return function(){o||(e.apply(this,arguments),o=!0,setTimeout(function(){o=!1},t))}},e.getImageTwoMostProminentColours=e=>new Promise((t,o)=>{const r=new Image;r.crossOrigin="Anonymous",r.src=e,r.onload=()=>{const e=document.createElement("canvas"),o=e.getContext("2d");e.width=r.width,e.height=r.height,o.drawImage(r,0,0,r.width,r.height);const n=o.getImageData(0,0,r.width,r.height).data,i={};for(let e=0;e<n.length;e+=4){const t=`rgb(${n[e]},${n[e+1]},${n[e+2]})`;i[t]?i[t]++:i[t]=1}const a=Object.keys(i).map(e=>{const[t,o,r]=e.match(/\d+/g).map(Number),[n,i,a]=((e,t,o)=>{e/=255,t/=255,o/=255;const r=Math.max(e,t,o),n=Math.min(e,t,o);let i,a,s=(r+n)/2;if(r===n)i=a=0;else{const l=r-n;switch(a=s>.5?l/(2-r-n):l/(r+n),r){case e:i=(t-o)/l+(t<o?6:0);break;case t:i=(o-e)/l+2;break;case o:i=(e-t)/l+4}i/=6}return[i,a,s]})(t,o,r);return{color:e,h:n,s:i,l:a,score:i+(1-Math.abs(2*a-1))}}).sort((e,t)=>t.score-e.score),s=e=>{const t=e.match(/\d+/g).map(Number);return t[0]<40&&t[1]<40&&t[2]<40};let l=[];for(const e of a){if(2===l.length)break;s(e.color)||l.every(t=>{const o=Math.abs(e.h-t.h),r=Math.abs(e.s-t.s),n=Math.abs(e.l-t.l);return o>=.1&&r>=.1&&n>=.1})&&l.push(e)}l.length<2&&(l=a.slice(0,2)),t(l.map(e=>e.color))},r.onerror=()=>{o(new Error("Failed to load image"))}})},function(e,t){e.suggestedVideosGrid=null,e.generateSuggestedVideoList=()=>{const t=e.displayOptions.suggestedVideos.configUrl;t&&e.sendRequestAsync(t,!1,5e3).then(t=>{let{response:o}=t;const r=JSON.parse(o),n=e.generateSuggestedVideoGrid(r);e.suggestedVideosGrid=n}).catch(e=>{console.error("[FP_ERROR] given suggested videos config url is invalid or not found.",e)})},e.generateSuggestedVideoGrid=t=>{const o=document.createElement("div");o.className="suggested_tile_grid";for(let r=0;r<12;r++){const n=e.createVideoTile(t[r]);o.appendChild(n)}return o},e.displaySuggestedVideos=()=>{e.domRef.wrapper.appendChild(e.suggestedVideosGrid)},e.clickSuggestedVideo=(t,o,r)=>{e.toggleLoader(!0),e.hideSuggestedVideos(),e.resetPlayer(t,o,r),e.generateSuggestedVideoList()},e.resetPlayer=(t,o,r)=>{const n=e.domRef.wrapper.querySelector(`#${e.videoPlayerId}`);n.innerHTML="";let i="";t&&t.forEach(e=>{i+=`<source src='${e.url}' ${e.hd?"data-fluid-hd":""} title="${e.resolution}" type='${e.mimeType}'/>`}),o&&o.forEach(e=>{i+=`<track label="${e.label}" kind="metadata" srclang="${e.lang}" src="${e.url}" ${e.default?"default":""}>`}),n.innerHTML=i,e.removeVideoSourcesListFromDOM();e.domRef.wrapper.getElementsByClassName("fluid_control_video_source")[0].innerHTML="",e.domRef.player.src="",e.domRef.player.removeAttribute("src"),e.setVideoSource(t[0].url),e.createVideoSourceSwitch(!1),e.resetSubtitles(),e.setPersistentSettings(!0),e.loadInNewVideo(),e.resetAds(),r&&(e.displayOptions.suggestedVideos.configUrl=r,e.generateSuggestedVideoList())},e.createVideoTile=t=>{const o=document.createElement("div");o.addEventListener("click",function(){e.clickSuggestedVideo(t.sources,t.subtitles,t.configUrl)},!1),o.className="suggested_tile",o.id="suggested_tile_"+t.id,e.getImageTwoMostProminentColours(t.thumbnailUrl).then(e=>{e&&e.length&&(o.style=`background: ${e[0]};`)});const r=document.createElement("img");r.src=t.thumbnailUrl,r.className="suggested_tile_image";const n=document.createElement("div");n.className="suggested_tile_overlay";const i=document.createElement("p");return i.className="suggested_tile_title",i.innerText=t.title,n.appendChild(i),o.appendChild(r),o.appendChild(n),o},e.resetSubtitles=()=>{e.removeSubtitlesListFromDOM();e.domRef.wrapper.getElementsByClassName("fluid_control_subtitles")[0].innerHTML="",e.domRef.player.load(),e.createSubtitles(!1)},e.loadInNewVideo=()=>{e.displayOptions.layoutControls.mediaType=e.getCurrentSrcType(),e.initialiseStreamers(),e.domRef.player.currentTime=0,e.domRef.player.mainVideoCurrentTime=0,e.setBuffering()},e.resetAds=()=>{e.timerPool={},e.rollsById={},e.adPool={},e.adGroupedByRolls={},e.onPauseRollAdPods=[],e.currentOnPauseRollAd="",e.isTimer=!1,e.timer=null,e.firstPlayLaunched=!1,e.preRollAdsResolved=!1,e.preRollAdPods=[],e.preRollAdPodsLength=0,e.preRollVastResolved=0,e.autoplayAfterAd=!0;const t=setInterval(()=>{!isNaN(e.domRef.player.duration)&&e.domRef.player.duration>0&&(e.toggleLoader(!0),e.mainVideoDuration=e.domRef.player.duration,clearInterval(t),e.setVastList(),e.checkForNextAd(),e.playPauseToggle())},100)},e.removeVideoSourcesListFromDOM=()=>{const t=e.domRef.wrapper.getElementsByClassName("fluid_video_source_list_item");for(let e=0;e<t.length;e++)t[e].remove()},e.removeSubtitlesListFromDOM=()=>{const t=e.domRef.wrapper.getElementsByClassName("fluid_subtitle_list_item");for(let e=0;e<t.length;e++)t[e].remove()},e.hideSuggestedVideos=()=>{const t=e.domRef.wrapper.getElementsByClassName("suggested_tile_grid")[0];t&&t.remove()},e.isShowingSuggestedVideos=()=>!!e.domRef.wrapper.getElementsByClassName("suggested_tile_grid")[0]},function(e){const t="fluid_mini_player_mode",o="mini-player-close-button-wrapper",r="mini-player-close-button",n="fluidplayer-miniplayer-player-placeholder",i="disable-mini-player-mobile";let a=null,s=null,l=null,d=null,c=!1,u=null,p=!1,f=!1;function m(l){let d=arguments.length>1&&void 0!==arguments[1]&&arguments[1];e.debugMessage(`[MiniPlayer] Toggling MiniPlayer, forceToggle: ${l}`);const f=e.displayOptions.layoutControls.miniPlayer;f.enabled?"on"===l&&e.miniPlayerToggledOn||"off"===l&&!e.miniPlayerToggledOn?e.debugMessage("[MiniPlayer] Can't force toggle Mini Player to it's same state"):(d&&b(),window.matchMedia("(max-width: 768px)").matches&&(p=!0),e.resetDisplayMode("miniPlayer"),c||function(){if(!e.domRef.player.parentNode.querySelector(`.${r}`)){const t=document.createElement("div");t.classList.add(o);const n=document.createElement("span");n.classList.add(r),n.addEventListener("click",()=>{m("off",!0),e.domRef.player.paused||e.playPauseToggle()}),t.appendChild(n),e.domRef.player.parentNode.append(t)}p&&function(){const t=document.createElement("div");let o,n=0,a=0;t.classList.add(i);const s=document.createElement("span");s.classList.add(r),t.appendChild(s),t.ontouchstart=e=>{o=!1,e.timeStamp,a=e.changedTouches[0].screenX,e.preventDefault()},t.ontouchmove=t=>{n=Math.min(Math.max(a-t.changedTouches[0].screenX,-50),50),Math.abs(n)>5?(e.domRef.wrapper.style.transform=`translateX(${-1*n}px)`,o=!0):e.domRef.wrapper.style.transform="translateX(0px)"},t.ontouchend=t=>{Math.abs(n)>5?(m("off",!0),e.domRef.player.paused||e.playPauseToggle(),t.preventDefault()):o||(m("off",!0),setTimeout(()=>{e.domRef.wrapper.scrollIntoView({behavior:"smooth",block:"center"})})),n=0,e.domRef.wrapper.style.transform=""},t.onmouseup=()=>m("off",!0),e.domRef.wrapper.insertBefore(t,e.domRef.player.nextSibling)}(),c=!0}(),"off"===l||e.miniPlayerToggledOn?function(){const o=e.domRef.wrapper;e.domRef.wrapper.parentElement.removeChild(u),u=null,o.classList.remove(t),o.style.width=`${a}px`,o.style.height=`${s}px`,a=null,s=null,y(),v(),e.miniPlayerToggledOn=!1,g()}():("on"===l||!e.miniPlayerToggledOn)&&function(o,r,i,l){const d=e.domRef.wrapper,c=o>400?o:400,f=r>225?r:225,b=i>40?i:40;a=h(d,"width","clientWidth"),s=h(d,"height","clientHeight"),d.classList.add(t,`${t}--${l.trim().replace(/\s/,"-")}`),p?(d.style.width=`${b}vw`,d.style.height="auto",d.style.aspectRatio="16 / 9"):(d.style.width=`${c}px`,d.style.height=`${f}px`),function(t,o){u=document.createElement("div"),u.classList.add(n),u.style.height=`${o}px`,u.style.width=`${t}px`,u.innerText=e.displayOptions.layoutControls.miniPlayer.placeholderText||"",u.onclick=()=>m("off",!0),e.domRef.wrapper.parentElement.insertBefore(u,e.domRef.wrapper)}(a,s),y(c,f,b),v(),e.miniPlayerToggledOn=!0,g()}(f.width,f.height,f.widthMobile,f.position)):e.debugMessage("[MiniPlayer] Prevent toggle MiniPlayer, it's currently disabled")}function g(){e.domRef.player.dispatchEvent(new CustomEvent("miniPlayerToggle",{detail:{isToggledOn:e.miniPlayerToggledOn}}))}function h(e,t,o){return t&&e.style[t]&&e.style[t].match("px")?parseInt(e.style[t]):String(e[o]).match("px")?parseInt(e[o]):e[o]}function y(t,o,r){const n=e.domRef.wrapper.querySelector(".fluid_nonLinear_ad img, .fluid_vpaid_nonlinear_slot_iframe"),i=e.domRef.wrapper.querySelector(".fluid_vpaidNonLinear_frame");if(!n)return;p&&(t=window.innerWidth*r/100);const a=h(n,null,"width"),s=h(n,null,"height");if(l&&d)n.width=l,n.height=d,i&&(i.style.width=`${l}px`,i.style.height=`${d}px`),l=d=null;else if(a>t||s>o){const e=(t-(p?4:32))/a;l=a,d=s,n.width=Math.round(a*e),n.height=Math.round(s*e),i&&(i.style.width=`${Math.round(a*e)}px`,i.style.height=`${Math.round(s*e)}px`)}}function v(){const t=e.domRef.wrapper.querySelector(".vast_clickthrough_layer");t&&(t.style.width=`${e.domRef.player.offsetWidth}px`,t.style.height=`${e.domRef.player.offsetHeight}px`)}function b(){const t=e.displayOptions.layoutControls.miniPlayer.autoToggle;!f&&t?(f=!0,document.addEventListener("scroll",w,{passive:!0})):document.removeEventListener("scroll",w)}const w=e.throttle(function(){if(e.domRef.player.paused)return;const t=e.isElementVisible(e.domRef.player),o=e.isElementVisible(e.domRef.wrapper.querySelector(`.${n}`));t||e.miniPlayerToggledOn?o&&e.miniPlayerToggledOn&&m("off"):m("on")},16.666666666666668);e.toggleMiniPlayer=m,e.toggleMiniPlayerScreenDetection=b}],Ie=typeof FP_ENV<"u"&&"development"===FP_ENV,Me=typeof FP_DEBUG<"u"&&!0===FP_DEBUG;let Be=0;const De=function(){const e=this;e.domRef={player:null},e.version=typeof FP_BUILD_VERSION<"u"?FP_BUILD_VERSION:"",e.homepage=typeof FP_HOMEPAGE<"u"?FP_HOMEPAGE+"/?utm_source=player&utm_medium=context_menu&utm_campaign=organic":"",e.destructors=[],e.init=(t,o)=>{const r={development:Ie,debug:Me};for(const t of xe)t(e,r);let n;if(t instanceof HTMLVideoElement)n=t,t.id||(t.id="fluid_player_instance_"+(Be++).toString());else{if(!("string"==typeof t||t instanceof String))throw"Invalid initializer - player target must be HTMLVideoElement or ID";n=document.getElementById(t)}if(!n)throw"Could not find a HTML node to attach to for target "+t+'"';if(n.classList.contains("js-fluid-player"))throw"Invalid initializer - player target already is initialized";n.setAttribute("playsinline",""),n.setAttribute("webkit-playsinline",""),n.classList.add("js-fluid-player"),e.domRef.player=n,e.vrROTATION_POSITION=.1,e.vrROTATION_SPEED=80,e.vrMode=!1,e.vrPanorama=null,e.vrViewer=null,e.vpaidTimer=null,e.vpaidAdUnit=null,e.vastOptions=null,e.videoPlayerId=n.id,e.originalSrc=e.getCurrentSrc(),e.isCurrentlyPlayingAd=!1,e.recentWaiting=!1,e.latestVolume=1,e.currentVideoDuration=0,e.firstPlayLaunched=!1,e.suppressClickthrough=!1,e.timelinePreviewData=[],e.mainVideoCurrentTime=0,e.mainVideoDuration=0,e.isTimer=!1,e.timer=null,e.timerPool={},e.rollsById={},e.adPool={},e.adGroupedByRolls={},e.onPauseRollAdPods=[],e.currentOnPauseRollAd="",e.preRollAdsResolved=!1,e.preRollAdPods=[],e.preRollAdPodsLength=0,e.preRollVastResolved=0,e.temporaryAdPods=[],e.availableRolls=["preRoll","midRoll","postRoll","onPauseRoll"],e.supportedNonLinearAd=["300x250","468x60","728x90"],e.autoplayAfterAd=!0,e.nonLinearDuration=15,e.supportedStaticTypes=["image/gif","image/jpeg","image/png"],e.inactivityTimeout=null,e.isUserActive=null,e.nonLinearVerticalAlign="bottom",e.vpaidNonLinearCloseButton=!0,e.showTimeOnHover=!0,e.initialAnimationSet=!0,e.theatreMode=!1,e.theatreModeAdvanced=!1,e.fullscreenMode=!1,e.originalWidth=n.offsetWidth,e.originalHeight=n.offsetHeight,e.dashPlayer=!1,e.hlsPlayer=!1,e.dashScriptLoaded=!1,e.hlsScriptLoaded=!1,e.isPlayingMedia=!1,e.isSwitchingSource=!1,e.isLoading=!1,e.isInIframe=e.inIframe(),e.mainVideoReadyState=!1,e.xmlCollection=[],e.inLineFound=null,e.fluidStorage={},e.fluidPseudoPause=!1,e.mobileInfo=e.getMobileOs(),e.events={},e.timeSkipOffsetAmount=10,e.currentMediaSourceType="source",e.isLiveStream=null,e.displayOptions={layoutControls:{mediaType:e.getCurrentSrcType(),primaryColor:!1,posterImage:!1,posterImageSize:"contain",adProgressColor:"#f9d300",playButtonShowing:!0,playPauseAnimation:!0,closeButtonCaption:"Close",fillToContainer:!1,autoPlay:!1,preload:"auto",mute:!1,loop:null,keyboardControl:!0,allowDownload:!1,playbackRateEnabled:!1,subtitlesEnabled:!1,subtitlesOnByDefault:!0,showCardBoardView:!1,showCardBoardJoystick:!1,allowTheatre:!0,doubleclickFullscreen:!0,autoRotateFullScreen:!1,theatreSettings:{width:"100%",height:"60%",marginTop:0,horizontalAlign:"center",keepPosition:!1},theatreAdvanced:{theatreElement:null},title:null,logo:{imageUrl:null,position:"top left",clickUrl:null,opacity:1,mouseOverImageUrl:null,imageMargin:"2px",hideWithControls:!1,showOverAds:!1},controlBar:{autoHide:!1,autoHideTimeout:3,animated:!0,playbackRates:["x2","x1.5","x1","x0.5"]},timelinePreview:{spriteImage:!1,spriteRelativePath:!1},htmlOnPauseBlock:{html:null,height:null,width:null},layout:"default",playerInitCallback:function(){},persistentSettings:{volume:!0,quality:!0,speed:!0,theatre:!0},controlForwardBackward:{show:!1,doubleTapMobile:!0},contextMenu:{controls:!0,links:[]},miniPlayer:{enabled:!0,width:400,height:225,widthMobile:50,placeholderText:"Playing in Miniplayer",position:"bottom right",autoToggle:!1},roundedCorners:0},suggestedVideos:{configUrl:null},vastOptions:{adList:{},skipButtonCaption:"Skip ad in [seconds]",skipButtonClickCaption:'Skip Ad <span class="skip_button_icon"></span>',adText:null,adTextPosition:"top left",adCTAText:"Visit now!",adCTATextPosition:"bottom right",adCTATextVast:!1,adClickable:!0,vastTimeout:5e3,showProgressbarMarkers:!1,allowVPAID:!1,showPlayButton:!1,maxAllowedVastTagRedirects:3,vpaidTimeout:3e3,vastAdvanced:{vastLoadedCallback:function(){},noVastVideoCallback:function(){},vastVideoSkippedCallback:function(){},vastVideoEndedCallback:function(){}}},hls:{overrideNative:!1},captions:{play:"Play",pause:"Pause",mute:"Mute",unmute:"Unmute",fullscreen:"Fullscreen",subtitles:"Subtitles",exitFullscreen:"Exit Fullscreen"},debug:Me,modules:{configureHls:e=>e,onBeforeInitHls:e=>{},onAfterInitHls:e=>{},configureDash:e=>e,onBeforeInitDash:e=>{},onAfterInitDash:e=>{}},onBeforeXMLHttpRequestOpen:e=>{},onBeforeXMLHttpRequest:e=>{(Me||Ie)&&console.debug("[FP_DEBUG] Request made",e)}},o.hlsjsConfig&&console.error("[FP_ERROR] player option hlsjsConfig is removed and has no effect. Use module callbacks instead!"),function e(t,o){return Object.keys(o).forEach(r=>{"object"!=typeof o[r]||null===o[r]||Array.isArray(o[r])?typeof o[r]<"u"&&(t[r]=o[r]):e(t[r],o[r])}),t}(e.displayOptions,o),e.domRef.wrapper=e.setupPlayerWrapper(),n.addEventListener("webkitfullscreenchange",e.recalculateAdDimensions),n.addEventListener("fullscreenchange",e.recalculateAdDimensions),n.addEventListener("waiting",e.onRecentWaiting),n.addEventListener("pause",e.onFluidPlayerPause),n.addEventListener("error",e.onErrorDetection),n.addEventListener("ended",e.onMainVideoEnded),n.addEventListener("durationchange",()=>{e.currentVideoDuration=e.getCurrentVideoDuration()}),n.readyState>0?e.mainVideoReady():n.addEventListener("loadedmetadata",e.mainVideoReady),e.displayOptions.layoutControls.showCardBoardView&&n.setAttribute("crossOrigin","anonymous"),e.currentVideoDuration=e.getCurrentVideoDuration(),(isNaN(e.currentVideoDuration)||!isFinite(e.currentVideoDuration))&&(e.currentVideoDuration=0),e.setLayout(),e.latestVolume=n.volume,e.initialAnimationSet=e.displayOptions.layoutControls.playPauseAnimation,e.handleFullscreen(),e.initLogo(),e.initTitle(),e.initMute(),e.initLoop(),e.displayOptions.layoutControls.playerInitCallback(),e.createVideoSourceSwitch(),e.createSubtitles(),e.createCardboard(),e.userActivityChecker(),e.setVastList(),e.setPersistentSettings(),e.generateSuggestedVideoList(),e.initialiseStreamers();const i=n.play;n.play=function(){let t=null;e.displayOptions.layoutControls.showCardBoardView&&typeof DeviceOrientationEvent<"u"&&"function"==typeof DeviceOrientationEvent.requestPermission&&DeviceOrientationEvent.requestPermission().then(function(t){"granted"===t&&e.debugMessage("DeviceOrientationEvent permission granted!")}).catch(console.error);try{return t=i.apply(this,arguments),null!=t&&(t.then(()=>{e.isPlayingMedia=!0,clearTimeout(e.promiseTimeout)}).catch(t=>{console.error("[FP_ERROR] Playback error",t),typeof t.name<"u"&&"AbortError"===t.name||e.announceLocalError(202,"Failed to play video."),clearTimeout(e.promiseTimeout)}),e.promiseTimeout=setTimeout(function(){!1===e.isPlayingMedia&&e.announceLocalError(204,"[FP_ERROR] Timeout error. Failed to play video?")},5e3)),t}catch(t){console.error("[FP_ERROR] Playback error",t),e.announceLocalError(201,"Failed to play video.")}};const a=n.pause;if(n.pause=function(){if(!0===e.isPlayingMedia)return e.isPlayingMedia=!1,a.apply(this,arguments);if(e.isCurrentlyPlayingVideo(e.domRef.player))try{return e.isPlayingMedia=!1,a.apply(this,arguments)}catch{e.announceLocalError(203,"Failed to play video.")}},e.displayOptions.layoutControls.autoPlay&&!e.dashScriptLoaded&&!e.hlsScriptLoaded){if("Safari"===e.getBrowserVersion().browserName)return;n.play()}e.mobileInfo.userOs?(e.hideControlBar(),e.domRef.wrapper.addEventListener("touchstart",e.showControlBar,{passive:!0})):(e.displayOptions.layoutControls.controlBar.autoHide||e.domRef.wrapper.addEventListener("mouseleave",e.handleMouseleave,!1),e.domRef.wrapper.addEventListener("mouseenter",e.showControlBar,!1),e.domRef.wrapper.addEventListener("mouseenter",e.showTitle,!1)),e.displayOptions.layoutControls.keyboardControl&&e.keyboardControl(),e.displayOptions.layoutControls.controlBar.autoHide&&e.linkControlBarUserActivity();try{if(e.domRef.player.textTracks)for(const t of e.domRef.player.textTracks)t.mode="hidden"}catch{}},e.getCurrentVideoDuration=()=>e.domRef.player?e.domRef.player.duration:0,e.toggleLoader=t=>{e.isLoading=!!t;const o=e.domRef.wrapper.querySelector(".vast_video_loading");o&&(o.style.display=t?"table":"none")},e.sendRequest=(t,o,r,n)=>{const i=new XMLHttpRequest;i.onreadystatechange=n,e.displayOptions.onBeforeXMLHttpRequestOpen(i),i.open("GET",t,!0),i.withCredentials=o,i.timeout=r,e.displayOptions.onBeforeXMLHttpRequest(i),i.send()},e.sendRequestAsync=async(t,o,r)=>await new Promise((n,i)=>{const a=new XMLHttpRequest;a.onreadystatechange=e=>{const t=e.target;4===t.readyState&&t.status>=200&&t.status<300?n(t):4===t.readyState&&i(t)},e.displayOptions.onBeforeXMLHttpRequestOpen(a),a.open("GET",t,!0),a.withCredentials=o,a.timeout=r,e.displayOptions.onBeforeXMLHttpRequest(a),a.send()}),e.announceLocalError=(e,t)=>{let o="[Error] ("+(typeof e<"u"?parseInt(e):900)+"): ";o+=t||"Failed to load Vast",console.warn(o)},e.debugMessage=function(){for(var t=arguments.length,o=new Array(t),r=0;r<t;r++)o[r]=arguments[r];e.displayOptions.debug&&console.log("%cFP DEBUG","color: #fff; font-weight: bold; background-color: #1a5e87; padding: 3px 6px; border-radius: 3px;",...o)},e.onMainVideoEnded=t=>{e.debugMessage("onMainVideoEnded is called"),(!e.isCurrentlyPlayingAd||!e.autoplayAfterAd)&&(Math.floor(e.getCurrentTime())>=Math.floor(e.mainVideoDuration)&&(e.adKeytimePlay(Math.floor(e.mainVideoDuration)),clearInterval(e.timer)),e.displayOptions.layoutControls.loop&&(e.switchToMainVideo(),e.playPauseToggle()),setTimeout(()=>{!e.isCurrentlyPlayingAd&&e.displayOptions.suggestedVideos.configUrl&&e.displaySuggestedVideos()},100))},e.getCurrentTime=()=>e.isCurrentlyPlayingAd?e.mainVideoCurrentTime:e.domRef.player.currentTime,e.getCurrentSrc=()=>{const t=e.domRef.player.getElementsByTagName("source");return t.length?t[0].getAttribute("src"):null},e.getCurrentSrcType=()=>{const t=e.domRef.player.getElementsByTagName("source");if(!t.length)return null;for(let o=0;o<t.length;o++)if(t[o].getAttribute("src")===e.originalSrc)return t[o].getAttribute("type").toLowerCase();return null},e.onRecentWaiting=()=>{e.recentWaiting=!0,setTimeout(function(){e.recentWaiting=!1},1e3)},e.onFluidPlayerPause=()=>{setTimeout(function(){if(e.recentWaiting)return;const t=document.createEvent("CustomEvent");t.initEvent("fluidplayerpause",!1,!0),e.domRef.player.dispatchEvent(t)},100)},e.checkShouldDisplayVolumeBar=()=>"iOS"!==e.getMobileOs().userOs,e.generateCustomControlTags=e=>{const t={};t.loader=document.createElement("div"),t.loader.className="vast_video_loading",t.loader.style.display="none",t.root=document.createElement("div"),t.root.className="fluid_controls_container",e.displayVolumeBar||(t.root.className=t.root.className+" no_volume_bar"),e.controlForwardBackward&&(t.root.className=t.root.className+" skip_controls"),t.leftContainer=document.createElement("div"),t.leftContainer.className="fluid_controls_left",t.root.appendChild(t.leftContainer),t.playPause=document.createElement("div"),t.playPause.className="fluid_button fluid_button_play fluid_control_playpause",t.leftContainer.appendChild(t.playPause),e.controlForwardBackward&&(t.skipBack=document.createElement("div"),t.skipBack.className="fluid_button fluid_button_skip_back",t.leftContainer.appendChild(t.skipBack),t.skipForward=document.createElement("div"),t.skipForward.className="fluid_button fluid_button_skip_forward",t.leftContainer.appendChild(t.skipForward)),t.progressContainer=document.createElement("div"),t.progressContainer.className="fluid_controls_progress_container fluid_slider",t.root.appendChild(t.progressContainer),t.progressWrapper=document.createElement("div"),t.progressWrapper.className="fluid_controls_progress",t.progressContainer.appendChild(t.progressWrapper),t.progressCurrent=document.createElement("div"),t.progressCurrent.className="fluid_controls_currentprogress",t.progressCurrent.style.backgroundColor=e.primaryColor,t.progressWrapper.appendChild(t.progressCurrent),t.progress_current_marker=document.createElement("div"),t.progress_current_marker.className="fluid_controls_currentpos",t.progressCurrent.appendChild(t.progress_current_marker),t.bufferedIndicator=document.createElement("div"),t.bufferedIndicator.className="fluid_controls_buffered",t.progressContainer.appendChild(t.bufferedIndicator),t.adMarkers=document.createElement("div"),t.adMarkers.className="fluid_controls_ad_markers_holder",t.progressContainer.appendChild(t.adMarkers),t.rightContainer=document.createElement("div"),t.rightContainer.className="fluid_controls_right",t.root.appendChild(t.rightContainer),t.fullscreen=document.createElement("div"),t.fullscreen.className="fluid_button fluid_control_fullscreen fluid_button_fullscreen",t.fullscreen.title="Full Screen",t.rightContainer.appendChild(t.fullscreen),e.miniPlayer.enabled&&(t.miniPlayer=document.createElement("div"),t.miniPlayer.className="fluid_button fluid_control_mini_player fluid_button_mini_player",t.miniPlayer.title="Mini Player",t.rightContainer.appendChild(t.miniPlayer)),t.theatre=document.createElement("div"),t.theatre.className="fluid_button fluid_control_theatre fluid_button_theatre",t.theatre.title="Theatre Mode",t.rightContainer.appendChild(t.theatre),t.cardboard=document.createElement("div"),t.cardboard.className="fluid_button fluid_control_cardboard fluid_button_cardboard",t.cardboard.title="Cardboard",t.rightContainer.appendChild(t.cardboard),t.subtitles=document.createElement("div"),t.subtitles.className="fluid_button fluid_control_subtitles fluid_button_subtitles",t.subtitles.title="Captions",t.rightContainer.appendChild(t.subtitles),t.videoSource=document.createElement("div"),t.videoSource.className="fluid_button fluid_control_video_source fluid_button_video_source",t.videoSource.title="Source",t.rightContainer.appendChild(t.videoSource),t.playbackRate=document.createElement("div"),t.playbackRate.className="fluid_button fluid_control_playback_rate fluid_button_playback_rate",t.playbackRate.title="Playback Rate",t.rightContainer.appendChild(t.playbackRate),t.download=document.createElement("div"),t.download.className="fluid_button fluid_control_download fluid_button_download",t.download.title="Download",t.rightContainer.appendChild(t.download),t.volumeContainer=document.createElement("div"),t.volumeContainer.className="fluid_control_volume_container fluid_slider",t.rightContainer.appendChild(t.volumeContainer),t.volume=document.createElement("div"),t.volume.className="fluid_control_volume",t.volumeContainer.appendChild(t.volume),t.volumeCurrent=document.createElement("div"),t.volumeCurrent.className="fluid_control_currentvolume",t.volume.appendChild(t.volumeCurrent),t.volumeCurrentPos=document.createElement("div"),t.volumeCurrentPos.className="fluid_control_volume_currentpos",t.volumeCurrent.appendChild(t.volumeCurrentPos),t.mute=document.createElement("div"),t.mute.className="fluid_button fluid_button_volume fluid_control_mute",t.rightContainer.appendChild(t.mute);const o=document.createElement("div");return o.className="fluid_control_duration",t.duration=document.createElement("div"),t.duration.className="fluid_fluid_control_duration",t.duration.innerText="00:00 / 00:00",e.displayVolumeBar||(o.className=o.className+" no_volume_bar"),t.live_indicator=document.createElement("div"),t.live_indicator.className="fluid_control_live_indicator",o.append(t.live_indicator,t.duration),t.rightContainer.appendChild(o),t},e.showLiveIndicator=()=>{if(!e.domRef.player.parentNode.getElementsByClassName("fluid_button_live_indicator").length){const t=e.domRef.player.parentNode.getElementsByClassName("fluid_control_live_indicator"),o=document.createElement("span");o.className="fluid_button_live_indicator",o.innerHTML='LIVE<span class="live_circle"></span>',o.addEventListener("click",()=>{e.domRef.player.currentTime=e.currentVideoDuration});for(let e=0;e<t.length;e++)t[e].appendChild(o)}},e.hideLiveIndicator=()=>{const t=e.domRef.player.parentNode.getElementsByClassName("fluid_button_live_indicator")[0];t&&t.remove()},e.controlPlayPauseToggle=()=>{const t=e.domRef.player.parentNode.getElementsByClassName("fluid_control_playpause"),o=e.domRef.wrapper.querySelector(".context_option_play"),r=e.domRef.player.parentNode.getElementsByClassName("fluid_controls_container"),n=e.domRef.wrapper.querySelector(".logo_holder");if(e.domRef.wrapper.querySelector(".fluid_initial_play")&&(e.domRef.wrapper.querySelector(".fluid_initial_play").style.display="none",e.domRef.wrapper.querySelector(".fluid_initial_play_button_container").style.opacity="1"),!e.domRef.player.paused){for(let e=0;e<t.length;e++)t[e].className=t[e].className.replace(/\bfluid_button_play\b/g,"fluid_button_pause");for(let e=0;e<r.length;e++)r[e].classList.remove("initial_controls_show");return n&&n.classList.remove("initial_controls_show"),void(null!==o&&(o.innerHTML=e.displayOptions.captions.pause))}for(let e=0;e<t.length;e++)t[e].className=t[e].className.replace(/\bfluid_button_pause\b/g,"fluid_button_play");for(let e=0;e<r.length;e++)r[e].classList.add("initial_controls_show");e.isCurrentlyPlayingAd&&e.displayOptions.vastOptions.showPlayButton&&(e.domRef.wrapper.querySelector(".fluid_initial_play").style.display="block",e.domRef.wrapper.querySelector(".fluid_initial_play_button_container").style.opacity="1"),n&&n.classList.add("initial_controls_show"),null!==o&&(o.innerHTML=e.displayOptions.captions.play)},e.playPauseAnimationToggle=t=>{if(e.isCurrentlyPlayingAd||!e.displayOptions.layoutControls.playPauseAnimation||e.isSwitchingSource)return;const o=e.domRef.wrapper.querySelector(".fluid_initial_play_button, .fluid_initial_pause_button");t?(o.classList.remove("fluid_initial_pause_button"),o.classList.add("fluid_initial_play_button")):(o.classList.remove("fluid_initial_play_button"),o.classList.add("fluid_initial_pause_button")),e.domRef.wrapper.querySelector(".fluid_initial_play").classList.add("transform-active"),setTimeout(function(){e.domRef.wrapper.querySelector(".fluid_initial_play").classList.remove("transform-active")},800)},e.contolProgressbarUpdate=()=>{const t=e.domRef.player.parentNode.getElementsByClassName("fluid_controls_currentprogress");for(let o=0;o<t.length;o++)t[o].style.width=e.domRef.player.currentTime/e.currentVideoDuration*100+"%"},e.controlDurationUpdate=()=>{const t=e.formatTime(e.domRef.player.currentTime);let o,r=!1;if(e.hlsPlayer&&(r=e.hlsPlayer.levels&&e.hlsPlayer.levels[e.hlsPlayer.currentLevel]&&e.hlsPlayer.levels[e.hlsPlayer.currentLevel].details.live),isNaN(e.currentVideoDuration)||!isFinite(e.currentVideoDuration)||r)o=t;else{o=t+" / "+e.formatTime(e.currentVideoDuration)}const n=e.domRef.player.parentNode.getElementsByClassName("fluid_control_duration");for(let t=0;t<n.length;t++){if(n[t].innerHTML="",e.isLiveStream){const o=document.createElement("span");o.className="fluid_button_live_indicator",o.innerHTML='LIVE<span class="live_circle"></span>',o.addEventListener("pointerdown",()=>{e.domRef.player.currentTime=e.currentVideoDuration}),n[t].appendChild(o)}const r=document.createElement("span");r.className="fluid_fluid_control_duration",r.innerText=o,n[t].appendChild(r)}},e.contolVolumebarUpdate=()=>{const t=e.domRef.wrapper.querySelector(".fluid_control_currentvolume"),o=e.domRef.wrapper.querySelector(".fluid_control_volume_currentpos"),r=e.domRef.wrapper.querySelector(".fluid_control_volume").clientWidth,n=o.clientWidth,i=e.domRef.player.parentNode.getElementsByClassName("fluid_control_mute"),a=e.domRef.wrapper.querySelector(".context_option_mute");if(0!==e.domRef.player.volume?(e.latestVolume=e.domRef.player.volume,e.fluidStorage.fluidMute=!1):e.fluidStorage.fluidMute=!0,e.domRef.player.volume&&!e.domRef.player.muted){for(let e=0;e<i.length;e++)i[e].className=i[e].className.replace(/\bfluid_button_mute\b/g,"fluid_button_volume");null!==a&&(a.innerHTML=e.displayOptions.captions.mute)}else{for(let e=0;e<i.length;e++)i[e].className=i[e].className.replace(/\bfluid_button_volume\b/g,"fluid_button_mute");null!==a&&(a.innerHTML=e.displayOptions.captions.unmute)}t.style.width=e.domRef.player.volume*r+"px",o.style.left=e.domRef.player.volume*r-n/2+"px"},e.muteToggle=()=>{0===e.domRef.player.volume||e.domRef.player.muted?(e.domRef.player.volume=e.latestVolume,e.domRef.player.muted=!1):(e.domRef.player.volume=0,e.domRef.player.muted=!0),e.fluidStorage.fluidVolume=e.latestVolume,e.fluidStorage.fluidMute=e.domRef.player.muted},e.checkFullscreenSupport=()=>{const t=e.domRef.wrapper;return t.mozRequestFullScreen?{goFullscreen:"mozRequestFullScreen",exitFullscreen:"mozCancelFullScreen",isFullscreen:"mozFullScreenElement"}:t.webkitRequestFullscreen?{goFullscreen:"webkitRequestFullscreen",exitFullscreen:"webkitExitFullscreen",isFullscreen:"webkitFullscreenElement"}:t.msRequestFullscreen?{goFullscreen:"msRequestFullscreen",exitFullscreen:"msExitFullscreen",isFullscreen:"msFullscreenElement"}:t.requestFullscreen?{goFullscreen:"requestFullscreen",exitFullscreen:"exitFullscreen",isFullscreen:"fullscreenElement"}:!!e.domRef.player.webkitSupportsFullscreen&&{goFullscreen:"webkitEnterFullscreen",exitFullscreen:"webkitExitFullscreen",isFullscreen:"webkitDisplayingFullscreen"}},e.fullscreenOff=(t,o)=>{for(let e=0;e<t.length;e++)t[e].className=t[e].className.replace(/\bfluid_button_fullscreen_exit\b/g,"fluid_button_fullscreen");null!==o&&(o.innerHTML="Fullscreen"),e.fullscreenMode=!1},e.fullscreenOn=(t,o)=>{for(let e=0;e<t.length;e++)t[e].className=t[e].className.replace(/\bfluid_button_fullscreen\b/g,"fluid_button_fullscreen_exit");null!==o&&(o.innerHTML=e.displayOptions.captions.exitFullscreen),e.fullscreenMode=!0},e.fullscreenToggle=()=>{e.debugMessage("Toggling Full Screen");const t=e.domRef.player,o=e.domRef.wrapper,r=e.checkFullscreenSupport(),n=t.parentNode.getElementsByClassName("fluid_control_fullscreen"),i=o.querySelector(".context_option_fullscreen");let a;e.resetDisplayMode("fullScreen"),r?"webkitEnterFullscreen"===r.goFullscreen?t[r.isFullscreen]||(a="videoPlayerTag."+r.goFullscreen+"();",e.fullscreenOn(n,i),new Function("videoPlayerTag",a)(t)):(null===document[r.isFullscreen]?(a="videoPlayerTag."+r.goFullscreen+"();",e.fullscreenOn(n,i)):(a="document."+r.exitFullscreen+"();",e.fullscreenOff(n,i)),new Function("videoPlayerTag",a)(o)):-1!==o.className.search(/\bpseudo_fullscreen\b/g)?(o.className=o.className.replace(/\bpseudo_fullscreen\b/g,""),e.fullscreenOff(n,i)):(o.className+=" pseudo_fullscreen",e.fullscreenOn(n,i)),e.resizeVpaidAuto(),e.domRef.player.addEventListener("webkitendfullscreen",()=>{e.fullscreenOff(n,i)})},e.findClosestParent=(e,t)=>{let o,r=null;if(["matches","webkitMatchesSelector","mozMatchesSelector","msMatchesSelector","oMatchesSelector"].some(function(e){return"function"==typeof document.body[e]&&(r=e,!0)}),e[r](t))return e;for(;e;){if(o=e.parentElement,o&&o[r](t))return o;e=o}return null},e.getTranslateX=e=>{let t=null;try{const o=e.style.transform.match(/translate3d\((-?\d+px,\s?){2}-?\d+px\)/);o&&o.length&&(t=o[0].replace("translate3d(","").replace(")","").replace(/\s/g,"").replace(/px/g,"").split(","))}catch{t=null}return t&&3===t.length?parseInt(t[0]):0},e.getEventOffsetX=(t,o)=>{let r,n=0,i=0;for(;o&&!isNaN(o.offsetLeft);)i=e.getTranslateX(o),"BODY"===o.tagName?n+=o.offsetLeft+o.clientLeft+i-(o.scrollLeft||document.documentElement.scrollLeft):n+=o.offsetLeft+o.clientLeft+i-o.scrollLeft,o=o.offsetParent;return r=typeof t.touches<"u"&&typeof t.touches[0]<"u"?t.touches[0].clientX:t.clientX,r-n},e.getEventOffsetY=(t,o)=>{let r=1;const n=e.checkFullscreenSupport();n&&document[n.isFullscreen]&&(r=0);let i=0;for(;o&&!isNaN(o.offsetTop);)"BODY"===o.tagName?i+=o.offsetTop-(o.scrollTop||document.documentElement.scrollTop)*r:i+=o.offsetTop-o.scrollTop*r,o=o.offsetParent;return t.clientY-i},e.onProgressbarMouseDown=t=>{let o;if(e.displayOptions.layoutControls.playPauseAnimation=!1,o=e.displayOptions.layoutControls.showCardBoardView?e.getEventOffsetX(t,t.target.parentNode):e.getEventOffsetX(t,e.domRef.wrapper.querySelector(".fluid_controls_progress_container")),e.isCurrentlyPlayingAd)return;e.fluidPseudoPause=!0;const r=e.domRef.player.paused;r||e.domRef.player.pause();const n=t=>{const o=e.domRef.wrapper.querySelector(".fluid_controls_progress_container").clientWidth;if(!o)return void e.hideSuggestedVideos();const r=Math.abs(e.currentVideoDuration*t/o);e.domRef.player.currentTime=r,"safari"===e.getBrowserVersion().browserName.toLowerCase()&&(e.domRef.player.safariPlayheadPosition=r),e.hideSuggestedVideos()},i=t=>{const r=e.getEventOffsetX(t,t.target.parentNode);o=NaN,n(r),e.contolProgressbarUpdate(),e.controlDurationUpdate()},a=t=>{document.removeEventListener("mousemove",i),document.removeEventListener("touchmove",i),document.removeEventListener("mouseup",a),document.removeEventListener("touchend",a);let s=e.getEventOffsetX(t,t.target.parentNode);isNaN(s)&&!isNaN(o)&&(s=o),isNaN(s)||n(s),r||e.play(),e.initialAnimationSet&&setTimeout(()=>{e.displayOptions.layoutControls.playPauseAnimation=e.initialAnimationSet},200),e.fluidPseudoPause=!1};document.addEventListener("mouseup",a),document.addEventListener("touchend",a,{passive:!0}),document.addEventListener("mousemove",i),document.addEventListener("touchmove",i,{passive:!0})},e.onVolumeBarMouseDown=()=>{const t=t=>{const o=e.domRef.controls.volumeContainer.clientWidth;if(o){let r=t/o;r<.05?(r=0,e.domRef.player.muted=!0):r>.95&&(r=1),e.domRef.player.muted&&r>0&&(e.domRef.player.muted=!1),e.setVolume(r)}},o=o=>{const r=e.getEventOffsetX(o,e.domRef.controls.volumeContainer);t(r)},r=n=>{document.removeEventListener("mousemove",o),document.removeEventListener("touchmove",o),document.removeEventListener("mouseup",r),document.removeEventListener("touchend",r);const i=e.getEventOffsetX(n,e.domRef.controls.volumeContainer);isNaN(i)||t(i)};document.addEventListener("mouseup",r),document.addEventListener("touchend",r,{passive:!0}),document.addEventListener("mousemove",o),document.addEventListener("touchmove",o,{passive:!0})},e.findRoll=t=>{const o=[];if(o.length=0,t&&e.hasOwnProperty("rollsById")){for(let r in e.rollsById)e.rollsById.hasOwnProperty(r)&&e.rollsById[r].roll===t&&o.push(r);return o}},e.onKeyboardVolumeChange=t=>{let o=e.domRef.player.volume;"asc"===t?o+=.05:"desc"===t&&(o-=.05),o<.05?o=0:o>.95&&(o=1),e.setVolume(o)},e.onKeyboardSeekPosition=t=>{e.isCurrentlyPlayingAd||(e.domRef.player.currentTime=e.getNewCurrentTimeValueByKeyCode(t,e.domRef.player.currentTime,e.domRef.player.duration))},e.getNewCurrentTimeValueByKeyCode=(e,t,o)=>{let r=t;switch(e){case 35:r=o;break;case 36:r=0;break;case 48:case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:if(e<58&&e>47){r=o*(10*(e-48))/100}}return r},e.handleMouseleave=t=>{typeof t.clientX<"u"&&e.domRef.wrapper.contains(document.elementFromPoint(t.clientX,t.clientY))||(e.hideControlBar(),e.hideTitle())},e.handleMouseenterForKeyboard=()=>{e.captureKey||(e.captureKey=t=>{t.stopPropagation();const o=t.keyCode;switch(o){case 70:e.fullscreenToggle(),t.preventDefault();break;case 13:case 32:e.playPauseToggle(),t.preventDefault();break;case 77:e.muteToggle(),t.preventDefault();break;case 38:e.onKeyboardVolumeChange("asc"),t.preventDefault();break;case 40:e.onKeyboardVolumeChange("desc"),t.preventDefault();break;case 37:e.skipRelative(-e.timeSkipOffsetAmount);break;case 39:e.skipRelative(e.timeSkipOffsetAmount);break;case 35:case 36:case 48:case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:e.onKeyboardSeekPosition(o),t.preventDefault();break;case 73:e.toggleMiniPlayer(void 0,!0);break;case 187:case 61:case 43:case 107:case 171:e.displayOptions.layoutControls.subtitlesEnabled&&e.adjustSubtitleSizeByOperation("+");break;case 189:case 173:case 45:case 109:e.displayOptions.layoutControls.subtitlesEnabled&&e.adjustSubtitleSizeByOperation("-")}return!1},document.addEventListener("keydown",e.captureKey,!0))},e.keyboardControl=()=>{e.domRef.wrapper.addEventListener("click",e.handleMouseenterForKeyboard,!1);const t=e.handleWindowClick.bind(e);e.destructors.push(()=>{window.removeEventListener("click",t)}),window.addEventListener("click",t)},e.handleWindowClick=t=>{e.domRef.wrapper?e.domRef.wrapper.contains(t.target)||t.target.classList.contains(".js-skipHref")||(document.removeEventListener("keydown",e.captureKey,!0),delete e.captureKey,e.theatreMode&&!e.theatreModeAdvanced&&e.theatreToggle()):console.warn("Dangling click event listener should be collected for unknown wrapper.Did you forget to call destroy on player instance?")},e.initialPlay=()=>{if(e.domRef.player.addEventListener("playing",()=>{e.toggleLoader(!1)}),e.domRef.player.addEventListener("timeupdate",()=>{e.toggleLoader(!1)}),e.domRef.player.addEventListener("waiting",()=>{e.toggleLoader(!0)}),!e.displayOptions.layoutControls.playButtonShowing){e.domRef.wrapper.querySelector(".fluid_controls_container").classList.remove("initial_controls_show");const t=e.domRef.wrapper.querySelector(".logo_holder");t&&t.classList.remove("initial_controls_show")}e.firstPlayLaunched||(e.playPauseToggle(),e.domRef.player.removeEventListener("play",e.initialPlay))},e.playPauseToggle=()=>{e.hideSuggestedVideos();const t=!e.firstPlayLaunched,o=e.findRoll("preRoll");if(t&&0!==o.length){e.isCurrentlyPlayingAd=!0;const t=e.getBrowserVersion(),r=!1!==e.mobileInfo.userOs&&"Android"===e.mobileInfo.userOs&&"Google Chrome"===t.browserName;("Safari"===t.browserName||r)&&(e.domRef.player.src="https://cdn.fluidplayer.com/static/blank.mp4",e.domRef.player.play(),e.playPauseAnimationToggle(!0)),e.firstPlayLaunched=!0,e.prepareVast("preRoll"),e.preRollAdPodsLength=o.length}else t&&0===o.length&&(e.firstPlayLaunched=!0,e.displayOptions.vastOptions.vastAdvanced.noVastVideoCallback()),e.domRef.player.paused?(e.isCurrentlyPlayingAd&&null!==e.vastOptions&&e.vastOptions.vpaid?e.resumeVpaidAd():(0!==Math.floor(e.domRef.player.currentTime)&&Math.floor(e.currentVideoDuration)===Math.floor(e.domRef.player.currentTime)&&(e.initialiseStreamers(),e.domRef.player.currentTime=0),e.hlsPlayer&&!e.hlsPlayer.config.autoStartLoad&&e.hlsPlayer.startLoad(),e.dashPlayer?e.dashPlayer.play():e.domRef.player.play()),e.playPauseAnimationToggle(!0)):t||(e.isCurrentlyPlayingAd&&null!==e.vastOptions&&e.vastOptions.vpaid?e.pauseVpaidAd():e.domRef.player.pause(),e.playPauseAnimationToggle(!1)),e.toggleOnPauseAd();const r=()=>{e.prepareVast("onPauseRoll"),e.scheduleOnDemandRolls()};if(t){const t=e.domRef.wrapper.querySelector(".fluid_pseudo_poster");t&&t.parentNode.removeChild(t),e.mainVideoDuration>0?r():e.domRef.player.addEventListener("mainVideoDurationSet",r)}e.adTimer();const n=e.domRef.wrapper.querySelector(".fluid_html_on_pause_container");n&&!e.isCurrentlyPlayingAd&&(e.domRef.player.paused?n.style.display="flex":n.style.display="none")},e.setCustomControls=()=>{e.trackEvent(e.domRef.player.parentNode,"click",".fluid_control_playpause",()=>{e.firstPlayLaunched||e.domRef.player.removeEventListener("play",e.initialPlay),e.playPauseToggle()},!1),e.domRef.player.addEventListener("play",()=>{e.controlPlayPauseToggle(),e.contolVolumebarUpdate()},!1),e.domRef.player.addEventListener("fluidplayerpause",()=>{e.controlPlayPauseToggle()},!1),e.domRef.player.addEventListener("timeupdate",()=>{e.contolProgressbarUpdate(),e.controlDurationUpdate()});const t=e.getMobileOs().userOs?"touchstart":"mousedown";e.displayOptions.layoutControls.showCardBoardView?e.trackEvent(e.domRef.player.parentNode,t,".fluid_controls_progress_container",t=>e.onProgressbarMouseDown(t),!1):e.domRef.wrapper.querySelector(".fluid_controls_progress_container").addEventListener(t,t=>e.onProgressbarMouseDown(t),{passive:!0}),e.domRef.wrapper.querySelector(".fluid_control_volume_container").addEventListener(t,t=>e.onVolumeBarMouseDown(),{passive:!0}),e.domRef.player.addEventListener("volumechange",()=>e.contolVolumebarUpdate()),e.trackEvent(e.domRef.player.parentNode,"click",".fluid_control_mute",()=>e.muteToggle()),e.setBuffering(),e.trackEvent(e.domRef.player.parentNode,"click",".fluid_control_fullscreen",()=>e.fullscreenToggle()),e.displayOptions.layoutControls.allowTheatre&&!e.isInIframe?(e.domRef.wrapper.querySelector(".fluid_control_theatre").style.display="inline-block",e.trackEvent(e.domRef.player.parentNode,"click",".fluid_control_theatre",()=>e.theatreToggle())):e.domRef.wrapper.querySelector(".fluid_control_theatre").style.display="none",e.displayOptions.layoutControls.miniPlayer.enabled&&!e.isInIframe&&e.trackEvent(e.domRef.player.parentNode,"click",".fluid_control_mini_player",()=>e.toggleMiniPlayer(void 0,!0)),e.domRef.player.addEventListener("ratechange",()=>{e.isCurrentlyPlayingAd&&(e.playbackRate=1)})},e.createTimePositionPreview=()=>{if(!e.showTimeOnHover)return;const t=e.domRef.wrapper.querySelector(".fluid_controls_progress_container"),o=document.createElement("div");o.className="fluid_timeline_preview",o.style.display="none",o.style.position="absolute",t.appendChild(o),e.domRef.wrapper.querySelector(".fluid_controls_progress_container").addEventListener("mousemove",t=>{const o=e.domRef.wrapper.querySelector(".fluid_controls_progress_container"),r=o.clientWidth,n=e.domRef.wrapper.querySelector(".fluid_timeline_preview"),i=e.getEventOffsetX(t,o),a=e.currentVideoDuration*i/r;n.innerText=e.formatTime(a),n.style.display="block",n.style.left=a/e.domRef.player.duration*100+"%"},!1),e.domRef.wrapper.querySelector(".fluid_controls_progress_container").addEventListener("mouseout",()=>{e.domRef.wrapper.querySelector(".fluid_timeline_preview").style.display="none"},!1)},e.setCustomContextMenu=()=>{const t=e.domRef.wrapper,o=e.displayOptions.layoutControls.contextMenu.controls,r=e.displayOptions.layoutControls.contextMenu.links,n=document.createElement("div");n.className="fluid_context_menu",n.style.display="none",n.style.position="absolute";const i=document.createElement("ul");if(n.appendChild(i),Array.isArray(r)&&r.forEach(function(e,t){const o=document.createElement("li");o.innerHTML=e.label,o.addEventListener("click",()=>window.open(e.href,"_blank"),!1),i.appendChild(o)}),o){const t=document.createElement("li");t.className="context_option_play",t.innerHTML=e.displayOptions.captions.play,t.addEventListener("click",()=>e.playPauseToggle(),!1),i.appendChild(t);const o=document.createElement("li");o.className="context_option_mute",o.innerHTML=e.displayOptions.captions.mute,o.addEventListener("click",()=>e.muteToggle(),!1),i.appendChild(o);const r=document.createElement("li");r.className="context_option_fullscreen",r.innerHTML=e.displayOptions.captions.fullscreen,r.addEventListener("click",()=>e.fullscreenToggle(),!1),i.appendChild(r)}const a=document.createElement("li");a.innerHTML="Fluid Player "+e.version,a.addEventListener("click",()=>window.open(e.homepage,"_blank"),!1),i.appendChild(a),e.domRef.player.parentNode.insertBefore(n,e.domRef.player.nextSibling),t.addEventListener("contextmenu",t=>{t.preventDefault(),n.style.left=e.getEventOffsetX(t,e.domRef.player)+"px",n.style.top=e.getEventOffsetY(t,e.domRef.player)+"px",n.style.display="block"},!1),document.addEventListener("click",t=>{(t.target!==e.domRef.player||2!==t.button)&&(n.style.display="none")},!1)},e.setDefaultLayout=()=>{e.domRef.wrapper.className+=" fluid_player_layout_"+e.displayOptions.layoutControls.layout,e.setCustomContextMenu();const t=e.generateCustomControlTags({displayVolumeBar:e.checkShouldDisplayVolumeBar(),primaryColor:e.displayOptions.layoutControls.primaryColor?e.displayOptions.layoutControls.primaryColor:"red",controlForwardBackward:!!e.displayOptions.layoutControls.controlForwardBackward.show,miniPlayer:e.displayOptions.layoutControls.miniPlayer});e.domRef.player.removeAttribute("controls"),e.domRef.player.parentNode.insertBefore(t.root,e.domRef.player.nextSibling),e.domRef.player.parentNode.insertBefore(t.loader,e.domRef.player.nextSibling),e.domRef.controls=t;let o=100,r=setInterval(function(){o?e.checkIfVolumebarIsRendered()?(clearInterval(r),e.contolVolumebarUpdate()):o--:clearInterval(r)},100);if(e.destructors.push(()=>clearInterval(r)),e.displayOptions.layoutControls.doubleclickFullscreen&&!(e.isTouchDevice()||!e.displayOptions.layoutControls.controlForwardBackward.doubleTapMobile)&&e.domRef.player.addEventListener("dblclick",e.fullscreenToggle),"iOS"===e.getMobileOs().userOs){let t=!1;new IntersectionObserver(o=>{o.forEach(o=>{o.isIntersecting?(e.domRef.player.inView=!0,e.displayOptions.layoutControls.autoRotateFullScreen&&e.isTouchDevice()&&!t&&(window.matchMedia("(orientation: landscape)").addEventListener("change",e.handleOrientationChange),t=!0)):e.domRef.player.inView=!1})}).observe(e.domRef.player)}e.initHtmlOnPauseBlock(),e.setCustomControls(),e.setupThumbnailPreview(),e.createTimePositionPreview(),e.posterImage(),e.initPlayButton(),e.setVideoPreload(),e.createPlaybackList(),e.createDownload(),e.toggleMiniPlayerScreenDetection(),e.displayOptions.layoutControls.controlForwardBackward.show&&e.initSkipControls(),e.displayOptions.layoutControls.controlForwardBackward.doubleTapMobile&&e.initDoubleTapSkip(),e.initSkipAnimationElements()},e.initSkipControls=()=>{e.domRef.controls.skipBack.addEventListener("click",e.skipRelative.bind(this,-e.timeSkipOffsetAmount)),e.domRef.controls.skipForward.addEventListener("click",e.skipRelative.bind(this,e.timeSkipOffsetAmount))},e.handleOrientationChange=()=>{const t=window.matchMedia("(orientation: landscape)").matches,o=e.domRef.player,r=e.domRef.wrapper,n=e.checkFullscreenSupport(),i=o.parentNode.getElementsByClassName("fluid_control_fullscreen"),a=r.querySelector(".context_option_fullscreen");let s;t&&e.domRef.player.inView?n?"webkitEnterFullscreen"===n.goFullscreen?(s="videoPlayerTag."+n.goFullscreen+"();",e.fullscreenOn(i,a),new Function("videoPlayerTag",s)(o)):(null===document[n.isFullscreen]&&(s="videoPlayerTag."+n.goFullscreen+"();",e.fullscreenOn(i,a)),new Function("videoPlayerTag",s)(r)):(r.className+=" pseudo_fullscreen",e.fullscreenOn(i,a)):(r.className=r.className.replace(/\bpseudo_fullscreen\b/g,""),n?(s="document."+n.exitFullscreen+"();",e.fullscreenOff(i,a),new Function("videoPlayerTag",s)(r)):-1!==r.className.search(/\bpseudo_fullscreen\b/g)&&(r.className=r.className.replace(/\bpseudo_fullscreen\b/g,""),e.fullscreenOff(i,a))),e.resizeVpaidAuto()},e.initSkipAnimationElements=function(){const t=document.createElement("div");t.classList.add("fluid_player_skip_offset");const o=document.createElement("div");o.classList.add("fluid_player_skip_offset__backward"),t.appendChild(o);const r=document.createElement("div");r.classList.add("fluid_player_skip_offset__backward-icon"),r.ontransitionend=()=>r.classList.remove("animate"),o.appendChild(r);const n=document.createElement("div");n.classList.add("fluid_player_skip_offset__forward"),t.appendChild(n);const i=document.createElement("div");i.classList.add("fluid_player_skip_offset__forward-icon"),i.ontransitionend=()=>i.classList.remove("animate"),n.appendChild(i),e.domRef.player.parentNode.insertBefore(t,e.domRef.player.nextSibling)},e.initDoubleTapSkip=()=>{let t=!1,o=[];e.domRef.player.addEventListener("pointerdown",r=>{if(!e.isTouchDevice())return;const n=e.isControlBarVisible(),{offsetX:i}=r,{clientWidth:a}=e.domRef.player;if(o.push(setTimeout(()=>{t=!1,n&&e.playPauseToggle()},300)),t)return o.forEach(e=>clearTimeout(e)),o=[],t=!1,e.skipRelative(i<a/2?-e.timeSkipOffsetAmount:e.timeSkipOffsetAmount);t=!0})},e.skipRelative=function(t){if(e.debugMessage("skipping video time by ",t),e.isCurrentlyPlayingAd)return;let o=e.domRef.player.currentTime+t;o<0&&(o=0),e.domRef.player.currentTime=o,t>=0?e.domRef.wrapper.querySelector(".fluid_player_skip_offset__forward-icon").classList.add("animate"):e.domRef.wrapper.querySelector(".fluid_player_skip_offset__backward-icon").classList.add("animate")},e.checkIfVolumebarIsRendered=()=>{const t=e.domRef.wrapper.querySelector(".fluid_control_volume_currentpos"),o=e.domRef.wrapper.querySelector(".fluid_control_volume").clientWidth;return t.clientWidth!==o},e.setLayout=()=>{e.isTouchDevice()||e.domRef.player.addEventListener("click",()=>e.playPauseToggle(),!1),e.domRef.player.addEventListener("play",e.initialPlay,!1),e.setDefaultLayout()},e.handleFullscreen=()=>{typeof document.vastFullsreenChangeEventListenersAdded<"u"||(["fullscreenchange","webkitfullscreenchange","mozfullscreenchange","msfullscreenchange"].forEach(t=>{"object"==typeof document["on"+t]&&document.addEventListener(t,function(t){e.recalculateAdDimensions()},!1)}),document.vastFullsreenChangeEventListenersAdded=!0)},e.setupPlayerWrapper=()=>{const t=document.createElement("div");t.id="fluid_video_wrapper_"+e.videoPlayerId,t.className=e.isTouchDevice()?"fluid_video_wrapper mobile":"fluid_video_wrapper",e.displayOptions.layoutControls.fillToContainer?(t.style.width="100%",t.style.height="100%"):(t.style.height=e.domRef.player.clientHeight+"px",t.style.width=e.domRef.player.clientWidth+"px");return t.style.borderRadius=e.domRef.player.style.borderRadius=(()=>{const t=e.displayOptions.layoutControls.roundedCorners,o=Number(t);return isNaN(o)||0===o?t:`${o}px`})(),t.style.overflow="hidden",e.domRef.player.style.height="100%",e.domRef.player.style.width="100%",e.domRef.player.parentNode.insertBefore(t,e.domRef.player),t.appendChild(e.domRef.player),t},e.onErrorDetection=()=>{e.domRef.player.networkState===e.domRef.player.NETWORK_NO_SOURCE&&e.isCurrentlyPlayingAd&&e.playMainVideoWhenVastFails(401)},e.createVideoSourceSwitch=function(){let t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];const o=[],r=e.domRef.player.querySelectorAll("source");[].forEach.call(r,e=>{e.title&&e.src&&o.push({title:e.title,url:e.src,isHD:null!=e.getAttribute("data-fluid-hd")})});const n=e.domRef.wrapper.querySelector(".fluid_control_video_source");if(e.videoSources=o,e.videoSources.length>1?n.style.display="inline-block":n.style.display="none",e.videoSources.length<=1)return;let i=!1;const a=document.createElement("div");a.className="fluid_video_sources_list",a.style.display="none";let s=!0;for(const o of e.videoSources){const r=o.url.split(".").pop();if("iOS"===e.mobileInfo.userOs&&"mkv"===r)continue;s&&!t&&(e.domRef.player.src=o.url);const n=s?"source_selected":"",l=o.isHD?'<sup style="color:'+e.displayOptions.layoutControls.primaryColor+'" class="fp_hd_source"></sup>':"";s=!1;const d=document.createElement("div");d.className="fluid_video_source_list_item js-source_"+o.title,d.innerHTML='<span class="source_button_icon '+n+'"></span>'+o.title+l,d.addEventListener("click",function(t){t.stopPropagation(),e.domRef.player.style.width=e.domRef.player.clientWidth+"px",e.domRef.player.style.height=e.domRef.player.clientHeight+"px";const o=this,r=e.domRef.wrapper.getElementsByClassName("source_button_icon");for(let e=0;e<r.length;e++)r[e].className=r[e].className.replace("source_selected","");o.firstChild.className+=" source_selected",e.videoSources.forEach(t=>{t.title===o.innerText.replace(/(\r\n\t|\n|\r\t)/gm,"")&&(e.setBuffering(),e.setVideoSource(t.url),e.fluidStorage.fluidQuality=t.title)}),e.openCloseVideoSourceSwitch()}),a.appendChild(d),i=!0}i?(n.appendChild(a),n.removeEventListener("click",e.openCloseVideoSourceSwitch),n.addEventListener("click",e.openCloseVideoSourceSwitch)):e.domRef.wrapper.querySelector(".fluid_control_video_source").style.display="none"},e.openCloseVideoSourceSwitch=()=>{const t=e.domRef.wrapper.querySelector(".fluid_video_sources_list");if(e.isCurrentlyPlayingAd||e.isShowingSuggestedVideos())return void(t.style.display="none");if("none"!==t.style.display)return void(t.style.display="none");t.style.display="block";const o=()=>{t.removeEventListener("mouseleave",o),t.style.display="none"};t.addEventListener("mouseleave",o)},e.setVideoSource=t=>{if("iOS"===e.mobileInfo.userOs&&t.indexOf(".mkv")>0)return console.log("[FP_ERROR] .mkv files not supported by iOS devices."),!1;if(e.isCurrentlyPlayingAd)return void(e.originalSrc=t);e.isSwitchingSource=!0;let o=!1;e.domRef.player.paused||(e.domRef.player.pause(),o=!0);const r=e.domRef.player.currentTime;e.setCurrentTimeAndPlay(r,o),e.domRef.player.src=t,e.originalSrc=t,e.displayOptions.layoutControls.mediaType=e.getCurrentSrcType(),e.initialiseStreamers()},e.setCurrentTimeAndPlay=(t,o)=>{const r=()=>{e.domRef.player.currentTime=t,e.domRef.player.removeEventListener("loadedmetadata",r),("iOS"===e.mobileInfo.userOs||"safari"===e.getBrowserVersion().browserName.toLowerCase())&&e.domRef.player.addEventListener("playing",n),o?e.domRef.player.play():(e.domRef.player.pause(),e.controlPlayPauseToggle()),e.isSwitchingSource=!1,e.domRef.player.style.width="100%",e.domRef.player.style.height="100%"};let n=()=>{e.currentTime=t,e.domRef.player.removeEventListener("playing",n)};e.domRef.player.addEventListener("loadedmetadata",r,!1),e.domRef.player.load()},e.initTitle=()=>{if(!e.displayOptions.layoutControls.title)return;const t=document.createElement("div");e.domRef.player.parentNode.insertBefore(t,null),t.innerHTML+=e.displayOptions.layoutControls.title,t.classList.add("fp_title")},e.hasTitle=()=>{const t=e.domRef.wrapper.querySelector(".fp_title"),o=e.displayOptions.layoutControls.title;return t&&null!=o},e.hideTitle=()=>{const t=e.domRef.wrapper.querySelector(".fp_title");e.hasTitle()&&t.classList.add("fade_out")},e.showTitle=()=>{const t=e.domRef.wrapper.querySelector(".fp_title");e.hasTitle()&&t.classList.remove("fade_out")},e.initLogo=()=>{if(!e.displayOptions.layoutControls.logo.imageUrl)return;const t=document.createElement("div");t.className="logo_holder",e.displayOptions.layoutControls.logo.hideWithControls?t.classList.add("initial_controls_show","fp_logo"):t.classList.add("logo_maintain_display");const o=document.createElement("img");e.displayOptions.layoutControls.logo.imageUrl&&(o.src=e.displayOptions.layoutControls.logo.imageUrl),o.style.position="absolute",o.style.margin=e.displayOptions.layoutControls.logo.imageMargin;const r=e.displayOptions.layoutControls.logo.position.toLowerCase();-1!==r.indexOf("bottom")?o.style.bottom=0:o.style.top=0,-1!==r.indexOf("right")?o.style.right=0:o.style.left=0,e.displayOptions.layoutControls.logo.opacity&&(o.style.opacity=e.displayOptions.layoutControls.logo.opacity),null!==e.displayOptions.layoutControls.logo.clickUrl&&(o.style.cursor="pointer",o.addEventListener("click",function(){window.open(e.displayOptions.layoutControls.logo.clickUrl,"_blank").focus()})),e.displayOptions.layoutControls.logo.mouseOverImageUrl&&(o.addEventListener("mouseover",function(){o.src=e.displayOptions.layoutControls.logo.mouseOverImageUrl},!1),o.addEventListener("mouseout",function(){o.src=e.displayOptions.layoutControls.logo.imageUrl},!1)),e.domRef.player.parentNode.insertBefore(t,null),t.appendChild(o,null)},e.initHtmlOnPauseBlock=()=>{if(e.hasValidOnPauseAd()||!e.displayOptions.layoutControls.htmlOnPauseBlock.html)return;const t=document.createElement("div");t.className="fluid_html_on_pause_container",t.style.display="none",t.innerHTML=e.displayOptions.layoutControls.htmlOnPauseBlock.html,t.onclick=function(t){e.playPauseToggle()},e.displayOptions.layoutControls.htmlOnPauseBlock.width&&(t.style.width=e.displayOptions.layoutControls.htmlOnPauseBlock.width+"px"),e.displayOptions.layoutControls.htmlOnPauseBlock.height&&(t.style.height=e.displayOptions.layoutControls.htmlOnPauseBlock.height+"px"),e.domRef.player.parentNode.insertBefore(t,null)},e.initPlayButton=()=>{const t=document.createElement("div");t.className="fluid_html_on_pause fluid_initial_play_button_container";const o=e.displayOptions.layoutControls.primaryColor?e.displayOptions.layoutControls.primaryColor:"#333333";t.innerHTML='<div class="fluid_initial_play" style="background-color:'+o+'"><div class="fluid_initial_play_button"></div></div>';const r=["click","touchend"],n=function(){e.playPauseToggle(),r.forEach(e=>t.removeEventListener(e,n))};r.forEach(e=>t.addEventListener(e,n)),e.displayOptions.layoutControls.playButtonShowing||(e.domRef.wrapper.querySelector(".fluid_controls_container").classList.add("initial_controls_show"),t.style.opacity="0"),e.domRef.player.parentNode.insertBefore(t,null)},e.mainVideoReady=()=>{if(0!==e.mainVideoDuration||e.isCurrentlyPlayingAd||!1!==e.mainVideoReadyState)return;const t=new CustomEvent("mainVideoDurationSet");e.mainVideoDuration=e.domRef.player.duration,e.mainVideoReadyState=!0,e.domRef.player.dispatchEvent(t),e.domRef.player.removeEventListener("loadedmetadata",e.mainVideoReady)},e.userActivityChecker=()=>{const t=e.domRef.wrapper;e.newActivity=null;let o=!1;const r=t=>{("touchstart"===t.type||"mousedown"===t.type)&&(o=!0),("touchend"===t.type||"mouseup"===t.type)&&(o=!1),e.newActivity=!0},n=setInterval(()=>{if(!0===e.newActivity){if(!o&&!e.isLoading&&(e.newActivity=!1),!1===e.isUserActive||!e.isControlBarVisible()){let t=new CustomEvent("userActive");e.domRef.player.dispatchEvent(t),e.isUserActive=!0}clearTimeout(e.inactivityTimeout),e.inactivityTimeout=setTimeout(()=>{if(!0===e.newActivity)return void clearTimeout(e.inactivityTimeout);e.isUserActive=!1;let t=new CustomEvent("userInactive");e.domRef.player.dispatchEvent(t)},1e3*e.displayOptions.layoutControls.controlBar.autoHideTimeout)}},300);e.destructors.push(()=>clearInterval(n));const i=e.isTouchDevice()?["touchstart","touchmove","touchend"]:["mousemove","mousedown","mouseup"];for(let e=0;e<i.length;e++)t.addEventListener(i[e],r,{passive:!0})},e.hasControlBar=()=>!!e.domRef.wrapper.querySelector(".fluid_controls_container"),e.isControlBarVisible=()=>{if(!1===e.hasControlBar())return!1;const t=e.domRef.wrapper.querySelector(".fluid_controls_container"),o=window.getComputedStyle(t,null);return!(0===o.opacity||"hidden"===o.visibility)},e.setVideoPreload=()=>{e.domRef.player.setAttribute("preload",e.displayOptions.layoutControls.preload)},e.hideControlBar=()=>{if(e.isCurrentlyPlayingAd&&!e.domRef.player.paused&&e.toggleAdCountdown(!0),e.domRef.player.style.cursor="none",!e.hasControlBar())return;const t=e.domRef.player.parentNode.getElementsByClassName("fluid_controls_container"),o=e.domRef.player.parentNode.getElementsByClassName("fp_logo");for(let o=0;o<t.length;o++)e.displayOptions.layoutControls.controlBar.animated?(t[o].classList.remove("fade_in"),t[o].classList.add("fade_out")):t[o].style.display="none";if(e.displayOptions.layoutControls.logo.hideWithControls)for(let t=0;t<o.length;t++)e.displayOptions.layoutControls.controlBar.animated?o[t]&&(o[t].classList.remove("fade_in"),o[t].classList.add("fade_out")):o[t]&&(o[t].style.display="none");e.repositionSubtitlesContainer("12px")},e.showControlBar=t=>{if(e.isCurrentlyPlayingAd&&!e.domRef.player.paused&&e.toggleAdCountdown(!1),("mouseenter"===t.type||"userActive"===t.type)&&(e.domRef.player.style.cursor="default"),!e.hasControlBar())return;const o=e.domRef.player.parentNode.getElementsByClassName("fluid_controls_container"),r=e.domRef.player.parentNode.getElementsByClassName("fp_logo");for(let t=0;t<o.length;t++)e.displayOptions.layoutControls.controlBar.animated?(o[t].classList.remove("fade_out"),o[t].classList.add("fade_in")):o[t].style.display="block";if(e.displayOptions.layoutControls.logo.hideWithControls)for(let t=0;t<r.length;t++)e.displayOptions.layoutControls.controlBar.animated?r[t]&&(r[t].classList.remove("fade_out"),r[t].classList.add("fade_in")):r[t]&&(r[t].style.display="block");e.repositionSubtitlesContainer("46px")},e.linkControlBarUserActivity=()=>{e.domRef.player.addEventListener("userInactive",e.hideControlBar),e.domRef.player.addEventListener("userInactive",e.hideTitle),e.domRef.player.addEventListener("userActive",e.showControlBar),e.domRef.player.addEventListener("userActive",e.showTitle)},e.initMute=()=>{!0===e.displayOptions.layoutControls.mute&&(e.domRef.player.volume=0)},e.initLoop=()=>{e.domRef.player.loop=!!e.displayOptions.layoutControls.loop},e.setBuffering=()=>{let t;const o=e.domRef.player.parentNode.getElementsByClassName("fluid_controls_buffered");for(let e=0;e<o.length;e++)o[e].style.width=0;t=setInterval(()=>{const r=e.domRef.player.duration;if(!(r<=0))for(let n=0;n<e.domRef.player.buffered.length;n++){if(e.domRef.player.buffered.start(e.domRef.player.buffered.length-1-n)>=e.domRef.player.currentTime)continue;const i=e.domRef.player.buffered.end(e.domRef.player.buffered.length-1-n)/r*100+"%";for(let e=0;e<o.length;e++)o[e].style.width=i;t&&e.domRef.player.buffered.end(e.domRef.player.buffered.length-1-n)/r===1&&clearInterval(t);break}},500),e.destructors.push(()=>clearInterval(t))},e.createPlaybackList=()=>{if(!e.displayOptions.layoutControls.playbackRateEnabled)return;const t=e.domRef.wrapper.querySelector(".fluid_control_playback_rate");t.style.display="inline-block";const o=document.createElement("div");o.className="fluid_video_playback_rates",o.style.display="none",(!Array.isArray(e.displayOptions.layoutControls.controlBar.playbackRates)||e.displayOptions.layoutControls.controlBar.playbackRates.some(e=>"string"!=typeof e||Number.isNaN(Number(e.replace("x","")))))&&(e.displayOptions.layoutControls.controlBar.playbackRates=["x2","x1.5","x1","x0.5"]),e.displayOptions.layoutControls.controlBar.playbackRates.forEach(function(t){const r=document.createElement("div");r.className="fluid_video_playback_rates_item",r.innerText=t,r.addEventListener("click",function(t){t.stopPropagation();let o=this.innerText.replace("x","");e.setPlaybackSpeed(o),e.openCloseVideoPlaybackRate()}),o.appendChild(r)}),t.appendChild(o),t.addEventListener("click",function(){e.openCloseVideoPlaybackRate()})},e.openCloseVideoPlaybackRate=()=>{const t=e.domRef.wrapper.querySelector(".fluid_video_playback_rates");if(e.isCurrentlyPlayingAd||"none"!==t.style.display)return void(t.style.display="none");t.style.display="block";const o=function(){t.removeEventListener("mouseleave",o),t.style.display="none"};t.addEventListener("mouseleave",o)},e.createDownload=()=>{const t=e.domRef.wrapper.querySelector(".fluid_control_download");if(!e.displayOptions.layoutControls.allowDownload)return;t.style.display="inline-block";let o=document.createElement("a");o.className="fp_download_click",o.onclick=function(e){const t=this;typeof e.stopImmediatePropagation<"u"&&e.stopImmediatePropagation(),setTimeout(function(){t.download="",t.href=""},100)},t.appendChild(o),t.addEventListener("click",function(){const t=e.domRef.wrapper.querySelector(".fp_download_click");t.download=e.originalSrc,t.href=e.originalSrc,o.click()})},e.theatreToggle=()=>{if(e.debugMessage("Toggling Theater Mode"),e.isInIframe)return;if(this.resetDisplayMode("theaterMode"),e.displayOptions.layoutControls.theatreAdvanced){const t=e.domRef.wrapper.querySelector(`#${e.displayOptions.layoutControls.theatreAdvanced.theatreElement}`),o=e.displayOptions.layoutControls.theatreAdvanced.classToApply;null!=t&&null!=o?(e.theatreMode?t.classList.remove(o):t.classList.add(o),e.theatreModeAdvanced=!e.theatreModeAdvanced):(console.log("[FP_ERROR] Theatre mode elements could not be found, defaulting behaviour."),e.defaultTheatre())}else e.defaultTheatre();e.theatreMode=!e.theatreMode,e.fluidStorage.fluidTheatre=e.theatreMode;const t=e.theatreMode?"theatreModeOn":"theatreModeOff",o=document.createEvent("CustomEvent");o.initEvent(t,!1,!0),e.domRef.player.dispatchEvent(o),e.resizeVpaidAuto()},e.defaultTheatre=()=>{const t=e.domRef.wrapper;if(e.theatreMode)return t.classList.remove("fluid_theatre_mode"),t.style.maxHeight="",t.style.marginTop="",t.style.left="",t.style.right="",t.style.position="",void(e.displayOptions.layoutControls.fillToContainer?(t.style.width="100%",t.style.height="100%"):(t.style.width=e.originalWidth+"px",t.style.height=e.originalHeight+"px"));t.classList.add("fluid_theatre_mode");const o=e.displayOptions.layoutControls.theatreSettings.width;let r="10px";switch(t.style.width=o,t.style.height=e.displayOptions.layoutControls.theatreSettings.height,t.style.maxHeight=screen.height+"px",t.style.marginTop=e.displayOptions.layoutControls.theatreSettings.marginTop+"px",e.displayOptions.layoutControls.theatreSettings.horizontalAlign){case"center":"string"==typeof o&&"%"===o.substr(o.length-1)?r=(100-parseInt(o.substring(0,o.length-1)))/2+"%":"string"==typeof o&&"px"===o.substr(o.length-2)?r=(screen.width-parseInt(o.substring(0,o.length-2)))/screen.width*100/2+"%":console.log("[FP_ERROR] Theatre width specified invalid."),t.style.left=r;break;case"right":t.style.right=r;break;default:t.style.left=r}},e.posterImage=()=>{if(!e.displayOptions.layoutControls.posterImage)return;const t=document.createElement("div");t.className="fluid_pseudo_poster",-1!==["auto","contain","cover"].indexOf(e.displayOptions.layoutControls.posterImageSize)?(t.style.background="url('"+e.displayOptions.layoutControls.posterImage+"') center center / "+e.displayOptions.layoutControls.posterImageSize+" no-repeat black",e.domRef.player.parentNode.insertBefore(t,null)):console.log("[FP_ERROR] Not allowed value in posterImageSize")},e.nextSource=()=>{const t=e.domRef.player.getElementsByTagName("source");if(!t.length)return null;for(let o=0;o<t.length-1;o++)if(t[o].getAttribute("src")===e.originalSrc&&t[o+1].getAttribute("src"))return void e.setVideoSource(t[o+1].getAttribute("src"))},e.inIframe=()=>{try{return window.self!==window.top}catch{return!0}},e.setPersistentSettings=function(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];try{if(!(typeof Storage<"u"&&typeof localStorage<"u"))return}catch{return}const o="_fp_storage_enabled",r=localStorage;try{r.setItem(o,"1"),r.removeItem(o)}catch{return!1}if(e.fluidStorage=localStorage,typeof e.fluidStorage.fluidVolume<"u"&&e.displayOptions.layoutControls.persistentSettings.volume&&!t&&(e.setVolume(e.fluidStorage.fluidVolume),typeof e.fluidStorage.fluidMute<"u"&&"true"===e.fluidStorage.fluidMute&&e.muteToggle()),typeof e.fluidStorage.fluidQuality<"u"&&e.displayOptions.layoutControls.persistentSettings.quality){const t=e.domRef.wrapper.querySelector(".js-source_"+e.fluidStorage.fluidQuality),o=e.domRef.wrapper.querySelector(".fluid_control_video_source");t&&(t.click(),o.click())}typeof e.fluidStorage.fluidSpeed<"u"&&e.displayOptions.layoutControls.persistentSettings.speed&&e.setPlaybackSpeed(e.fluidStorage.fluidSpeed),typeof e.fluidStorage.fluidTheatre<"u"&&"true"===e.fluidStorage.fluidTheatre&&e.displayOptions.layoutControls.persistentSettings.theatre&&e.theatreToggle()},e.play=()=>{if(e.domRef.player.paused)return e.playPauseToggle(),!0},e.pause=()=>(e.domRef.player.paused||e.playPauseToggle(),!0),e.skipTo=t=>{e.domRef.player.currentTime=t},e.setPlaybackSpeed=t=>{e.isCurrentlyPlayingAd||(e.domRef.player.playbackRate=t,e.fluidStorage.fluidSpeed=t)},e.setVolume=t=>{e.domRef.player.volume=t;const o=0===t?1:t;e.latestVolume=o,e.fluidStorage.fluidVolume=o},e.isCurrentlyPlayingVideo=e=>e&&e.currentTime>0&&!e.paused&&!e.ended&&e.readyState>2,e.setHtmlOnPauseBlock=t=>{if("object"!=typeof t||typeof t.html>"u")return!1;const o=e.domRef.wrapper.querySelector(".fluid_html_on_pause_container");if(!o){const o=document.createElement("div");return o.className="fluid_html_on_pause",o.style.display="none",o.innerHTML=t.html,o.onclick=function(){e.playPauseToggle()},t.width&&(o.style.width=t.width+"px"),t.height&&(o.style.height=t.height+"px"),void e.domRef.player.parentNode.insertBefore(o,null)}o.innerHTML=t.html,t.width&&(o.style.width=t.width+"px"),t.height&&(o.style.height=t.height+"px")},e.toggleControlBar=t=>{const o=e.domRef.wrapper.querySelector(".fluid_controls_container");t?o.className+=" initial_controls_show":o.className=o.className.replace(" initial_controls_show","")},e.on=(t,o)=>{const r=function(t){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n={mediaSourceType:e.currentMediaSourceType,...r};return o(t,n)},n={play:()=>e.domRef.player.addEventListener("play",r),seeked:()=>e.domRef.player.addEventListener("seeked",r),ended:()=>e.domRef.player.addEventListener("ended",r),pause:()=>e.domRef.player.addEventListener("pause",t=>{e.fluidPseudoPause||r(t)}),playing:()=>e.domRef.player.addEventListener("playing",r),waiting:()=>e.domRef.player.addEventListener("waiting",r),theatreModeOn:()=>e.domRef.player.addEventListener("theatreModeOn",r),theatreModeOff:()=>e.domRef.player.addEventListener("theatreModeOff",r),timeupdate:()=>e.domRef.player.addEventListener("timeupdate",t=>{r(t,{currentTime:e.domRef.player.currentTime})}),miniPlayerToggle:()=>e.domRef.player.addEventListener("miniPlayerToggle",r)};n[t]?n[t]():console.error(`[FP_ERROR] Event "${t}" is not recognized`)},e.toggleLogo=t=>{if("object"!=typeof t||!t.imageUrl)return!1;const o=e.domRef.wrapper.querySelector(".fp_logo");e.displayOptions.layoutControls.logo.imageUrl=t.imageUrl?t.imageUrl:null,e.displayOptions.layoutControls.logo.position=t.position?t.position:"top left",e.displayOptions.layoutControls.logo.clickUrl=t.clickUrl?t.clickUrl:null,e.displayOptions.layoutControls.logo.opacity=t.opacity?t.opacity:1,e.displayOptions.layoutControls.logo.mouseOverImageUrl=t.mouseOverImageUrl?t.mouseOverImageUrl:null,e.displayOptions.layoutControls.logo.imageMargin=t.imageMargin?t.imageMargin:"2px",e.displayOptions.layoutControls.logo.hideWithControls=!!t.hideWithControls&&t.hideWithControls,e.displayOptions.layoutControls.logo.showOverAds=!!t.showOverAds&&t.showOverAds,o&&o.remove(),e.initLogo()},e.trackEvent=(t,o,r,n)=>{typeof e.events[r]>"u"&&(e.events[r]={}),typeof e.events[r][o]>"u"&&(e.events[r][o]=[]),e.events[r][o].push(n),e.registerListener(t,o,r,n)},e.registerListener=(e,t,o,r)=>{const n=e.querySelectorAll(o);for(let e=0;e<n.length;e++)n[e].addEventListener(t,r)},e.copyEvents=t=>{for(let o in e.events)if(e.events.hasOwnProperty(o))for(let r in e.events[o])if(e.events[o].hasOwnProperty(r))for(let n=0;n<e.events[o][r].length;n++)e.registerListener(t,r,o,e.events[o][r][n])},e.resetDisplayMode=t=>{e.fullscreenMode&&"fullScreen"!==t&&e.fullscreenToggle(),e.theatreMode&&"theaterMode"!==t&&e.theatreToggle(),e.miniPlayerToggledOn&&"miniPlayer"!==t&&e.toggleMiniPlayer("off")},e.destroy=()=>{if(e.domRef.player.classList.remove("js-fluid-player"),0===e.destructors.length)return;e.destructors.forEach(t=>t.call(e));const t=e.domRef.wrapper;t?"function"!=typeof t.remove?t.parentNode?t.parentNode.removeChild(t):console.error("Unable to remove wrapper element for Fluid Player instance - no parent"):t.remove():console.warn("Unable to remove wrapper element for Fluid Player instance - element not found")}},Fe=function(e){this.play=()=>e.play(),this.pause=()=>e.pause(),this.skipTo=t=>e.skipTo(t),this.setPlaybackSpeed=t=>e.setPlaybackSpeed(t),this.setVolume=t=>e.setVolume(t),this.setHtmlOnPauseBlock=t=>e.setHtmlOnPauseBlock(t),this.toggleControlBar=t=>e.toggleControlBar(t),this.toggleFullScreen=t=>e.fullscreenToggle(t),this.toggleMiniPlayer=t=>(void 0===t&&(t=!e.miniPlayerToggledOn),e.toggleMiniPlayer(t?"on":"off",!0)),this.destroy=()=>e.destroy(),this.dashInstance=()=>e.dashPlayer?e.dashPlayer:null,this.hlsInstance=()=>e.hlsPlayer?e.hlsPlayer:null,this.on=(t,o)=>e.on(t,o),this.setDebug=t=>{e.displayOptions.debug=t}};if(Ie&&console.log("Fluid Player - Development Build"+(Me?" (in debug mode)":"")),typeof FP_HOMEPAGE>"u"&&(globalThis.FP_HOMEPAGE="https://fluidplayer.com"),typeof FP_BUILD_VERSION>"u"&&(globalThis.FP_BUILD_VERSION="v3"),typeof FP_ENV>"u"){const e=globalThis&&globalThis.location&&("localhost"===globalThis.location.hostname||"127.0.0.1"===globalThis.location.hostname||""===globalThis.location.hostname);typeof process<"u"&&process&&process.env&&process.env.NODE_ENV?globalThis.FP_ENV=process.env.NODE_ENV:globalThis&&!e?globalThis.FP_ENV="production":globalThis.FP_ENV="development"}typeof FP_DEBUG>"u"&&(globalThis.FP_DEBUG=!1);const Ue=function(e,t){const o=new De;t||(t={}),o.init(e,t);const r=new Fe(o);if(window&&Ie){const n={id:e,options:t,instance:r,internals:o};typeof window.fluidPlayerDebug>"u"&&(window.fluidPlayerDebug=[]),window.fluidPlayerDebug.push(n),console.log("Created instance of Fluid Player. Debug API available at window.fluidPlayerDebug["+(window.fluidPlayerDebug.length-1)+"].",n)}return r},qe="function"==typeof Buffer;"function"==typeof TextDecoder&&new TextDecoder;const je="function"==typeof TextEncoder?new TextEncoder:void 0,He=Array.prototype.slice.call("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=");(()=>{let e={};He.forEach((t,o)=>e[t]=o)})();const $e=String.fromCharCode.bind(String);"function"==typeof Uint8Array.from&&Uint8Array.from.bind(Uint8Array);const ze="function"==typeof btoa?e=>btoa(e):qe?e=>Buffer.from(e,"binary").toString("base64"):e=>{let t,o,r,n,i="";const a=e.length%3;for(let a=0;a<e.length;){if((o=e.charCodeAt(a++))>255||(r=e.charCodeAt(a++))>255||(n=e.charCodeAt(a++))>255)throw new TypeError("invalid character found");t=o<<16|r<<8|n,i+=He[t>>18&63]+He[t>>12&63]+He[t>>6&63]+He[63&t]}return a?i.slice(0,a-3)+"===".substring(a):i},We=qe?e=>Buffer.from(e).toString("base64"):e=>{let t=[];for(let o=0,r=e.length;o<r;o+=4096)t.push($e.apply(null,e.subarray(o,o+4096)));return ze(t.join(""))},Ke=e=>{if(e.length<2)return(t=e.charCodeAt(0))<128?e:t<2048?$e(192|t>>>6)+$e(128|63&t):$e(224|t>>>12&15)+$e(128|t>>>6&63)+$e(128|63&t);var t=65536+1024*(e.charCodeAt(0)-55296)+(e.charCodeAt(1)-56320);return $e(240|t>>>18&7)+$e(128|t>>>12&63)+$e(128|t>>>6&63)+$e(128|63&t)},Ge=/[\uD800-\uDBFF][\uDC00-\uDFFFF]|[^\x00-\x7F]/g,Je=qe?e=>Buffer.from(e,"utf8").toString("base64"):je?e=>We(je.encode(e)):e=>ze((e=>e.replace(Ge,Ke))(e));class Xe{constructor(e,o){t(this,"target"),t(this,"options");const r=document.createElement("video");r.defaultMuted=!0,r.muted=!0,e.appendChild(r),this.target=r,this.options=o}async create(e,t){var o,r;const n=Ue(this.target,{layoutControls:{roundedCorners:8,fillToContainer:!0,autoPlay:!1,mute:!0,doubleclickFullscreen:!1,keyboardControl:!1,loop:!1,allowTheatre:!1,miniPlayer:{enabled:!1},preload:"auto",persistentSettings:{volume:!1,quality:!1,speed:!1,theatre:!1},layout:"in-renderer-js",logo:{imageUrl:null==(o=this.options.logo)?void 0:o.imageUrl,clickUrl:null==(r=this.options.logo)?void 0:r.clickUrl,position:"bottom left"}},vastOptions:{allowVPAID:!0,showPlayButton:!0,adList:[{adText:Pe.t("LearnMore"),adClickable:!0,roll:"preRoll",vastTag:await this.getVastTag(this.options.vastUrl,this.options.vastXml)}],vastAdvanced:{vastVideoEndedCallback:()=>{this.attachEndCard(n,e),t&&t()}}}});return n}attachEndCard(e,t){const o=this.getFluidContainer();this.target.style.filter="blur(8px)",this.removeVolumeButtons(o);const{endCard:r,replayButton:n}=this.createReplayButtonElement();n.addEventListener("click",()=>{e.destroy(),t()}),this.target.parentElement.appendChild(r)}removeVolumeButtons(e){const t=e.querySelector(".fluid_button_volume"),o=e.querySelector(".fluid_button_mute");null==t||t.remove(),null==o||o.remove()}createReplayButtonElement(){const e=document.createElement("div");e.classList.add("ad_end_card");const t=document.createElement("div");t.classList.add("ad_replay");const o=document.createElement("div");o.classList.add("ad_replay_icon"),t.appendChild(o);const r=document.createElement("span");return r.textContent=Pe.t("Replay"),t.appendChild(r),e.appendChild(t),{endCard:e,replayButton:t}}getFluidContainer(){return this.target.parentElement}async getVastTag(e,t){if(t)return e&&navigator.sendBeacon(e),this.getVastDataUrl(t);if(e){const t=await this.getVastByVastUrl(e);return this.getVastDataUrl(t)}throw new p}async getVastByVastUrl(e){return await(await fetch(e)).text()}getVastDataUrl(e){return this.getVastDataUrlFromVastXml(e)}getVastDataUrlFromVastXml(e){return"data:text/xml;charset=utf-8;base64,"+function(e){return arguments.length>1&&void 0!==arguments[1]&&arguments[1]?(e=>e.replace(/=/g,"").replace(/[+\/]/g,e=>"+"==e?"-":"_"))(Je(e)):Je(e)}(e.replace(/\\"/g,'"'))}}class Qe{trackViewable(e,t){new IntersectionObserver(e=>{e.forEach(e=>{e.isIntersecting&&t()})}).observe(e)}trackViewableLost(e,t){new IntersectionObserver(e=>{e.forEach(e=>{e.isIntersecting||t()})}).observe(e)}trackViewableMrc50(e,t){this.createObserver(t,.5,1e3).observe(e)}trackViewableMrc100(e,t){this.createObserver(t,1,1e3).observe(e)}trackViewableVideo50(e,t){this.createObserver(t,.5,2e3).observe(e)}createObserver(e,t,o){let r=null;const n=new IntersectionObserver(i=>{i.forEach(i=>{i.isIntersecting&&i.intersectionRatio>=t?null===r&&(r=window.setTimeout(()=>{e(),n.disconnect(),r=null},o)):null!==r&&(window.clearTimeout(r),r=null)})},{threshold:t,root:null});return n}}class Ye{async render(e,t){const o=e.querySelectorAll(".in-renderer-native-video");await Promise.all(Array.from(o).map(e=>{this.validateContainer(e);const o=Number(e.dataset.assetId),r=Number(e.dataset.playerWidth),n=Number(e.dataset.playerHeight),i=t.find(e=>e.id===o);i&&"video"in i&&this.renderVideo({targetElement:e,playerHeight:n,playerWidth:r,asset:i})}))}validateContainer(e){if(!e.dataset.playerWidth||!e.dataset.playerHeight||!e.dataset.assetId)throw new g}async renderVideo(e){let{targetElement:t,asset:o,playerWidth:r,playerHeight:n}=e;const i=await new Xe(t,{vastXml:o.video.vasttag}).create(()=>this.renderVideo({targetElement:t,asset:o,playerHeight:n,playerWidth:r}));new h(new Qe).render(t,{vastXml:o.video.vasttag,playerWidth:r,playerHeight:n,mediaType:"video"},i)}}class Ze{constructor(e,o){t(this,"domainLogger"),t(this,"viewableTracker"),this.domainLogger=e,this.viewableTracker=o}async render(e,t,o){try{this.validateBid(t);const r=t.native.adTemplate;let n=(new a).replace(r,t.native.ortb.assets);n=(new u).replace(n,t.native.ortb.link,t.native.ortb.privacy),e.innerHTML=n,await(new Ye).render(e,t.native.ortb.assets),(new c).handle(e,t.native.ortb.link,t.native.ortb.assets),new d(this.viewableTracker).track(e,t.native.ortb.eventtrackers||[]),this.viewableTracker.trackViewableMrc50(e,()=>{o.onImpressionViewable&&o.onImpressionViewable()})}catch(e){if(e instanceof g)this.domainLogger.invalidNativeVideoContainer();else if(e instanceof f)this.domainLogger.unsupportedNativeAsset();else{if(!(e instanceof m))throw e;this.domainLogger.missingAdTemplate()}}}validateBid(e){var t,o;if(null==e||!e.native||null==(t=e.native)||!t.ortb)throw new f;if(null==(o=e.native)||!o.adTemplate)throw new m}}class et{async render(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const a=new r(new n),s=document.getElementById(e);if(!s)throw new o;const l=new Qe;if("native"!==t.mediaType)throw new p("Unsupported formats.");new Ze(a,l).render(s,t,i)}}export{et as I,ie as a,ne as c,ae as g};
